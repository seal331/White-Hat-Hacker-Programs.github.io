!function(e){function t(t){for(var r,o,s=t[0],c=t[1],u=t[2],l=0,_=[];l<s.length;l++)o=s[l],i[o]&&_.push(i[o][0]),i[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(d&&d(t);_.length;)_.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(r=!1)}r&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},i={"web/groups":0},a=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/js/cmodules/";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var d=c;a.push([139,"bundles/audioplayer","bundles/common","bundles/vendors"]),n()}({"/eGY":function(e,t,n){"use strict";n.r(t),n.d(t,"VKPAY_APP_ID",function(){return u}),n.d(t,"BUTTON_TYPE_TEXT",function(){return d}),n.d(t,"BUTTON_TYPE_VKPAY",function(){return l}),n.d(t,"BUTTON_TYPE_LOCATION",function(){return _}),n.d(t,"BUTTON_TYPE_OPEN_APP",function(){return h}),n.d(t,"BUTTON_TYPE_OPEN_LINK",function(){return g}),n.d(t,"BUTTON_COLOR_DEFAULT",function(){return f}),n.d(t,"BUTTON_COLOR_SECONDARY",function(){return m}),n.d(t,"BUTTON_COLOR_PRIMARY",function(){return p}),n.d(t,"BUTTON_COLOR_NEGATIVE",function(){return b}),n.d(t,"BUTTON_COLOR_POSITIVE",function(){return v}),n.d(t,"handleButtonClick",function(){return O}),n.d(t,"getButtonAppearance",function(){return w}),n.d(t,"getButtonLabel",function(){return k}),n.d(t,"getActionObjectFromElement",function(){return E}),n.d(t,"getAttributesFromActionObject",function(){return I});n("a1Th"),n("rE2o"),n("ioFf"),n("tUrg"),n("rGqo"),n("Btvt"),n("/8Fb"),n("pIFo");var r=n("t7n3"),i=n("nAFc"),a=n("/PiP"),o=n("EasH"),s=n("N4ZS");function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var u=6217559,d="text",l="vkpay",_="location",h="open_app",g="open_link",f="default",m="secondary",p="primary",b="negative",v="positive",y=["app-id","owner-id","type","payload","hash","label"];function O(e,t,n,r){var i=e.app_id,s=e.owner_id,c=e.type,f=e.payload,m=e.hash;switch(c){case g:break;case l:case h:var p="app"+(c===l?u:i)+(s?"_"+s:"");Object(a.showWiki)({w:p+encodeURIComponent("#"+m),from_keyboard:1,app_hash:n});break;case _:cur.sendLocation=function(e,n){n(),t({keyboardAuthorId:r,action:{label:"",attaches:[e],payload:f}})},Object(o.showBox)("al_places.php",{act:"a_choose_place_box",from_keyboard:1},{stat:["places.css","map.css","maps.js","ui_controls.css","ui_controls.js","boxes.css"],width:640,bodyStyle:"padding: 0px;",dark:1});break;case d:t({action:e,appHash:n,keyboardAuthorId:r});break;default:e.payload=JSON.stringify({command:"not_supported_button",button_type:c,payload:e.payload}),t({action:e,appHash:n,keyboardAuthorId:r})}}function w(e){return j(e)?p:e.color.toLowerCase().replace(f,m)}function k(e){var t=e.action,n=t.label;return t.type===_?getLang("mail_keyboard_label_location"):j(e)?getLang("mail_keyboard_label_vkpay").replace(/ VK Pay$/,""):function(e){var t=e;return t=Object(i.decodeHTMLEntities)(t||""),t=Object(r.clean)(t).replace(/\n(\r)?/gi," "),t=Emoji.emojiToHTML(t,!0)}(n)}function j(e){var t=e.action,n=t.app_id,r=t.type;return r===l||r===h&&n===u}function E(e){return y.reduce((t,n)=>(t[n.replace("-","_")]=e.getAttribute("data-"+n)||void 0,t),{})}function I(e){var t=Object.entries(e).reduce((e,t)=>{var n=c(t,2),i=n[0],a=n[1];return e+` data-${i.replace("_","-")}="${Object(r.clean)(""+a)}"`},"");e.type===g&&(t+=` href="${Object(s.wrapAwayIfExternal)(encodeURI(e.link),!0)}" target="_blank" rel="nofollow noopener"`);return t}},"12ku":function(e,t,n){"use strict";n.r(t),n.d(t,"ON_BOARDING_BG_ID",function(){return s}),n.d(t,"ON_BOARDING_BG_HEADER_ID",function(){return c}),n.d(t,"ON_BOARDING_BG_RECT_ID",function(){return u}),n.d(t,"ON_BOARDING_BG_CLIP_ID",function(){return d}),n.d(t,"default",function(){return g});n("a1Th"),n("Btvt"),n("rE2o"),n("ioFf"),n("rGqo");var r=n("zxIV"),i=n("lXE5"),a=n("k3PD");function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s="onboarding_bg",c="onboarding_bg_header",u="onboarding_bg_rect",d="onboarding_bg_clip",l="page_header_cont",_="onboarding",h=42;class g{constructor(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.el=e,this.text=t,this.hideDarkness=!0,this.oldColor=!1;var r={autoShow:!1,noAutoHideOnWindowClick:!0,content:`${t}`,cls:"feature_intro_tt feature_intro_blue_tt tutorial_tip_tt",appendToParent:!0,onHide:this.ttOnHide.bind(this)};n.side&&(r.forceSide=n.side),n.offset&&(r.offset=n.offset),n.width&&(r.width=n.width),n.shift&&(r.centerShift=n.shift),n.border?this.border=n.border:this.border=[10,10,10,10],n.withCloseButton&&(r.withCloseButton=n.withCloseButton,r.onCloseButtonClick=n.onCloseButtonClick),this.ttParams=r,this.opts=n,this.initOnboardingBG()}initOnboardingBG(){if(!window.onboardingBG){var e=se('\n<div id="onboarding_layout">\n  <svg id="onboarding_bg_header" width="100%" height="42px">\n    <rect id="onboarding_bg_rect" x="0" y="0" width="100%" height="100%" fill-opacity="0.8" fill="#000"></rect>\n  </svg>\n  <svg id="onboarding_bg" width="100%" height="100%">\n  <defs>\n    <mask id="mask" x="0" y="0" width="100%" height="100%">\n      <rect x="0" y="0" width="100%" height="100%" fill="#fff"></rect>\n      <rect id="onboarding_bg_clip" x="0" y="0" width="0" height="0" fill="#000" rx="8" ry="8"></rect>\n    </mask>\n  </defs>\n  <rect id="onboarding_bg_rect" x="0" y="42" width="100%" height="100%" mask="url(#mask)" fill-opacity="0.8"></rect>\n  </svg>\n</div>\n      ');Object(r.domInsertBefore)(e,window.layerBG),window.onboardingBGHeader=ge(c),window.onboardingBG=ge(s),window.onboardingBGRect=ge(u),window.onboardingBGClip=ge(d),window.cur.destroy.push(()=>{hide(window.onboardingBG),hide(window.onboardingBGHeader),removeClass(ge(l),_),this.hideDarkness=!0,this.hideTT(),delete window.onboardingBG,delete window.onboardingBGHeader,delete window.onboardingBGRect,delete window.onboardingBGClip,this.opts.onBGClick&&removeEvent(window.onboardingBG,"click",this.opts.onBGClick)}),this.opts.onBGClick&&addEvent(window.onboardingBG,"click",this.opts.onBGClick)}}showTT(){var e=o(Object(r.getXY)(this.el),2)[1];this.tt=new window.ElementTooltip(this.el,this.ttParams),this.opts.highlight&&(this.addDarkness(),this.addHighlight()),this.tt.show();var t=this.tt.getContent();Object(a.isElementInViewport)(this.el)&&Object(a.isElementInViewport)(t)||Object(i.scrollToY)(e-h)}hideTT(){this.tt&&(this.tt.destroy(),this.removeDarkens(),this.hideDarkness&&(removeEvent(window,"scroll"),removeEvent(window,"resize")))}addHighlight(){window.onboardingBGClip&&(this.highlightElement(),addEvent(window,"scroll",this.onScrollTT.bind(this)),addEvent(window,"resize",this.onResizeTT.bind(this)))}highlightElement(){var e=this.el.offsetWidth,t=this.el.offsetHeight,n=Object(r.getXY)(this.el);attr(window.onboardingBGClip,"width",e+this.border[1]+this.border[3]),attr(window.onboardingBGClip,"height",t+this.border[0]+this.border[2]),attr(window.onboardingBGClip,"x",n[0]-this.border[1]),attr(window.onboardingBGClip,"y",n[1]-this.border[0])}onResizeTT(){this.setDartToFullWidth(),this.highlightElement()}onScrollTT(){var e=this.getPageHeight();window.onboardingBG.height!=e&&this.setDartToFullHeight()}setDartToFullHeight(){attr(window.onboardingBG,"height",this.getPageHeight())}setDartToFullWidth(){attr(window.onboardingBG,"width",this.getPageWidth()),attr(window.onboardingBGHeader,"width",this.getPageWidth())}addDarkness(){Object(r.isVisible)(window.onboardingBG)||(this.setDartToFullHeight(),this.setDartToFullWidth(),show(window.onboardingBG),Object(r.isVisible)(window.onboardingBGHeader)||(show(window.onboardingBGHeader),addClass(ge(l),_)))}removeDarkens(){this.hideDarkness&&(hide(window.onboardingBG),hide(window.onboardingBGHeader),removeClass(ge(l),_))}ttOnHide(){this.hideTT()}show(){setTimeout(this.showTT.bind(this),1e3)}getPageWidth(){var e=document.documentElement,t=document.body;return Math.max(t.scrollWidth,e.scrollWidth,t.offsetWidth,e.offsetWidth,t.clientWidth,e.clientWidth)}getPageHeight(){var e=document.documentElement,t=document.body;return Math.max(t.scrollHeight,e.scrollHeight,t.offsetHeight,e.offsetHeight,t.clientHeight,e.clientHeight)}}},139:function(e,t,n){e.exports=n("wJJB")},"16Al":function(e,t,n){"use strict";var r=n("WbBG");function i(){}function a(){}a.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,a,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:i};return n.PropTypes=n,n}},"17x9":function(e,t,n){e.exports=n("16Al")()},"1y80":function(e,t,n){"use strict";function r(e,t,n,r,i){return window.statlogsValueEvent(e,t,n,r,i)}function i(e){return Math.random()<e}function a(e,t,n,a,o,s){i(e)&&r(t,n,a,o,s)}n.r(t),n.d(t,"statlogsValueEvent",function(){return r}),n.d(t,"randEnabled",function(){return i}),n.d(t,"statlogsProbValueEvent",function(){return a})},"4cFO":function(e,t,n){"use strict";n.r(t);n("VRzm"),n("Btvt");var r=n("ERyv");function i(e,t){if(!t)return ls.get(e);ls.set(e,t)}function a(e){try{var t={};return Error.captureStackTrace(t,e),t.stack}catch(e){return""}}t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=debounce(i,300),o=extend({},e),s=[],c=[];return t.store&&(o=ls.get(t.key)||o),{get:()=>o,set(e){var i=Object(r.isWeirdLogging)()?a(this.set):null;return e(o).then(e=>(o=e,t.store&&n(t.key,e),this.emit(),this)).catch(e=>Object(r.imWeirdCatch)("store_set_catch",e,{stack:i}))},setState(e){return this.set(t=>(t=extend(t,e),this.emit(),Promise.resolve(t)))},stash(){s.push(o),o=extend({},e),this.emit()},reset(){o=extend({},e),this.emit()},unmount(){o={},e=!1,c=[]},pop(){s.length>0&&(o=s.pop(),this.emit())},emit(){c.length>0&&c.forEach(e=>e(this))},subscribe(e){-1===c.indexOf(e)&&c.push(e)},unsubscribe(e){c=c.filter(t=>t!==e)},mutate(e){e(o),t.store&&n(t.key,o),this.emit()}}}},"6raB":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return u});n("91GP"),n("ioFf"),n("rGqo"),n("Btvt");var r=n("q1tI"),i=(n("17x9"),n("pemR")),a=n("KFTi"),o=n("Hx9h");function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}class u extends r.Component{constructor(e){super(e),this.needRecalcSize=!1,this.state={}}render(){var e=this.props,t=e.className,n=e.loading,u=e.children,d=c(e,["className","loading","children"]),l=Object(i.classNames)("ButtonWithProgress",{"ButtonWithProgress--loading":n},t);return r.createElement(o.default,s({},d,{className:l}),r.createElement("span",{className:"ButtonWithProgress__content"},u),n&&r.createElement(a.default,{inverted:"primary"===e.appearance,className:"ButtonWithProgress__progress"}))}}u.defaultProps={appearance:"primary",size:"m",wide:!1,loading:!1}},"86+7":function(e,t,n){"use strict";n.r(t),n.d(t,"oCacheExists",function(){return i}),n.d(t,"oCacheGet",function(){return a}),n.d(t,"oCacheAdd",function(){return o});n("KKXr");var r=n("aong");function i(e,t){return t in Object(r.unpackStore)(e).oCache}function a(e,t){var n=Object(r.unpackStore)(e).oCache[t];return n&&!n._n&&(!function(e){if(!e.first_name){var t=e.name.split(" ",2);e.first_name=t[0],e.short_name=t[1]?t[0]+" "+t[1].substr(0,1)+".":t[0]}e.inv_name||(e.inv_name=e.name),e.kick_name||(e.kick_name=e.inv_name)}(n),n._n=1),n}function o(e,t){var n=Object(r.unpackStore)(e);n.oCache||(n.oCache={}),t.id&&(n.oCache[t.id]=t)}},BxOC:function(e,t,n){"use strict";n.r(t),n.d(t,"post",function(){return o}),n.d(t,"plainget",function(){return s}),n.d(t,"plaingetCancelable",function(){return c});n("VRzm"),n("Btvt");var r=n("cGUQ"),i=window.ajax,a=3;function o(e,t,n){return t&&(t.im_v=a),new Promise((r,a)=>{i.post(e,t,{timeout:n,onDone(){r.apply(null,[[...arguments]])},onFail(){return a.apply(null,arguments),!0}})})}function s(e,t){return c(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).request}function c(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n=window.XDomainRequest?new XDomainRequest:i._getreq(),{request:new Promise((i,o)=>{var s,c=Date.now(),u=a.timeout||60,d=Object(r.toQueryString)(t);if(window.XDomainRequest)n.open("get",`${e}?${d}`),n.ontimeout=function(e){o([e,{}])},n.onerror=function(e){o([e,{}])},n.onload=function(){i([n.responseText,{}])},setTimeout(function(){n.send()},0);else{n.onreadystatechange=function(){4==n.readyState&&(clearInterval(s),n.status>=200&&n.status<300?i([n.responseText,n]):o([n.responseText,n]))};try{n.open("GET",`${e}?${d}`,!0)}catch(e){return o([e,n])}n.send()}s=setInterval(function(){Date.now()-c>1e3*u&&(window.browser.safari&&n.abort(),o(["",{}]),clearInterval(s))},1e3)}),cancel:function(){n.abort()}}}},CQka:function(e,t,n){"use strict";n.r(t),n.d(t,"initGroupLinksTracking",function(){return a}),n.d(t,"trackGroupLink",function(){return o});n("rGqo"),n("Btvt");var r=n("Egk5"),i=n("zxIV");function a(){setTimeout(function(){var e=Object(i.domQuery)("a[data-group-track-type='link']",ge("page_body"));Object.keys(e).forEach(t=>{var n=e[t];Object(r.addEvent)(n,"click",o),cur.destroy.push(r.removeEvent.pbind(n,"click"))})},3e3)}function o(e){var t=e.target;if(!t)return!0;if(linkLocked(t))return!0;var n=Object(i.domData)(t,"group-track-code"),r=Object(i.domData)(t,"group-track-type");if(!n||!r)return!0;var a={act:"track",group_id:-cur.oid,track_code:n,type:r};return ajax.post("al_groups.php",a,{onDone:function(){unlockLink(t)}}),!0}},D1OX:function(e,t,n){"use strict";n.r(t);var r;n("91GP");r=window.hasOwnProperty("__SHARED_STATE_KEY")?window.__SHARED_STATE_KEY:Object.create(null),Object.defineProperty(window,"__SHARED_STATE_KEY",{configurable:!0,value:r});var i=()=>window.__SHARED_STATE_KEY,a=e=>i()[e],o={persistIfInitialized:!0};n.d(t,"uiGetGallery",function(){return d}),n.d(t,"UIGallery",function(){return l});var s=window.isNumeric,c=1e3,u=((e,t,n)=>{var r=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Object.assign({},e,...n.reverse(),e)}({},n,o),s=e in i(),c=a(e),u=s&&r.persistIfInitialized?c:t(c);((e,t)=>{i()[e]=t})(e,u);return()=>a(e)})("ui-gallery",()=>({galleries:{},incIndex:0}));function d(e){var t=domData(ge(e),"gallery-id");return t&&u().galleries[t]}class l{constructor(e,t){if(!e)throw new Error("No element was provided for UIGallery");if(e=ge(e),!hasClass(e,"ui_gallery"))throw new Error("Provided incorrect element for UIGallery");var n=d(e);if(n)return n;this._opts=extend({markOutside:!1,scrollY:!0,scrollX:!0,noArrows:!1},t),this._id=u().incIndex,u().incIndex+=1,this._el=e,this._width=getSize(this._el)[0],this._items=geByClass("ui_gallery_item",this._el),this._itemWidth=getSize(this._items[0])[0],this._itemOffset=intval(getStyle(this._items[0],vk.rtl?"marginLeft":"marginRight")),this._scrollOffset=intval(getStyle(this._items[0],"marginLeft")),this._itemFullWidth=this._itemWidth+this._itemOffset,this._innerCont=geByClass1("ui_gallery__inner_cont",this._el),this._inner=geByClass1("ui_gallery__inner",this._el),this._scroll=function(){var e={rtl:!1,backward:!1,delta:1,negative:!1,rtlSame:!1};if(!vk.rtl)return e;if(!cur._scrollInfo){var t=se('<div style="position: fixed; left: -1000; width: 0; overflow: scroll">x</div>');ge("content").appendChild(t);var n=t.scrollLeft;e.rtl=vk.rtl,e.backward=n>0,t.scrollLeft=1e3,e.delta=t.scrollLeft===n?-1:1,e.negative=!e.backward&&e.delta<0,e.rtlSame=e.rtl&&!e.backward&&!e.negative,re(t),cur._scrollInfo=e}return cur._scrollInfo}(),this._loadingMore=!1,this._finised=!1,this._visible={left:-1,right:-1,items:[]},this._outside={left:-1,right:-1,timer:null},this._initScroll(),this._initArrows(),domData(this._el,"gallery-id",this._id),u().galleries[this._id]=this,this._checkItemsAfterScroll(this._innerCont.scrollLeft,!0)}_initScroll(){(this._opts.scrollX||this._opts.scrollY)&&addEvent(this._innerCont,"DOMMouseScroll wheel",this._onWheelScroll.bind(this))}_initArrows(){this._opts.noArrows?addClass(this._el,"ui_gallery_no_arrows"):(this._leftArrow=geByClass1("ui_gallery__arrow_left",this._el),this._rightArrow=geByClass1("ui_gallery__arrow_right",this._el),this._arrowWidth=getSize(this._leftArrow)[0],addEvent(this._leftArrow,"click",this._onArrowScroll.bind(this,-1)),addEvent(this._leftArrow,"mouseover",this._onArrowMouseOver.bind(this,"left")),addEvent(this._leftArrow,"mouseout",this._onArrowMouseOut.bind(this)),addEvent(this._rightArrow,"click",this._onArrowScroll.bind(this,1)),addEvent(this._rightArrow,"mouseover",this._onArrowMouseOver.bind(this,"right")),addEvent(this._rightArrow,"mouseout",this._onArrowMouseOut.bind(this)))}_onWheelScroll(e){if(this._opts.scrollX||this._opts.scrollY){var t;if("wheel"==e.type)if(Math.abs(e.deltaY)>Math.abs(e.deltaX)){if(!this._opts.scrollY)return;t=-e.deltaY}else{if(!this._opts.scrollX)return;t=-e.deltaX}else if(void 0!==e.wheelDeltaY){if(!this._opts.scrollY)return;t=e.wheelDeltaY}else if(void 0!==e.wheelDelta)t=e.wheelDelta;else{if(!e.detail||1!==e.axis)return;t=-e.detail}t=this._scroll.rtlSame?-t:t,Math.abs(t)>=120&&(t=74*Math.max(-1,Math.min(1,t))),this._innerCont.scrollLeft-=t,this._checkItemsAfterScroll(this._innerCont.scrollLeft),cancelEvent(e)}}_onArrowScroll(e,t){if(!this._opts.noArrows){var n=this._innerCont.scrollLeft+(this._scroll.rtlSame?-e:e)*(this._width-2*this._arrowWidth),r=this._innerCont.scrollWidth-this._width;this._scroll.negative?(n=Math.min(n,0),n=Math.abs(n)):n=Math.max(0,n),n=Math.min(r,n);var i=this._scroll.negative||this._scroll.rtlSame?-e:e;if(i>0&&n<r)n=Math.floor(n/this._itemFullWidth)*this._itemFullWidth;else if(i<0&&n>0){n=Math.floor(n/this._itemFullWidth)*this._itemFullWidth}if(0===n||n===r){var a=this._innerCont.scrollWidth;addClass(this._inner,"ui_gallery__inner_shift_instant"),this._onArrowMouseOut(),n&&(n+=e*(this._innerCont.scrollWidth-a))}this._scroll.negative&&(n=-n),animate(this._innerCont,{scrollLeft:n},{duration:Math.abs(this._innerCont.scrollLeft-n)+50,transition:Fx.Transitions.easeOutCubic}),this._checkItemsAfterScroll(n),setTimeout(()=>removeClass(this._inner,"ui_gallery__inner_shift_instant"),0),cancelEvent(t)}}_checkItemsAfterScroll(e,t){if(this._scroll.negative&&(e=Math.abs(e)),this._opts.markOutside||this._opts.onViewItem){var n,r=this._itemWidth/3,i=(this._scroll.backward?this._inner.scrollWidth-this._width-e:e)-this._scrollOffset,a=e&&Math.floor(i/this._itemFullWidth),o=a*this._itemFullWidth+2*r;n=this._scroll.backward?e+this._width<this._inner.scrollWidth-o:e>o;var s,u=Math.min(this._items.length-1,Math.floor((i+this._width)/this._itemFullWidth)),d=u*this._itemFullWidth+2*r;if(s=this._scroll.backward?e>this._inner.scrollWidth-d:e+this._width<d,this._opts.onViewItem){var l=n?Math.min(this._items.length-1,a+1):a,_=s?Math.max(0,u-1):u;if(t||l!==this._visible.left||_!==this._visible.right){for(var h=l;h<=_;h++)(this._visible.left<0||t&&!inArray(this._items[h],this._visible.items)||h<this._visible.left||h>this._visible.right)&&this._opts.onViewItem(this._items[h],h);this._visible.left=l,this._visible.right=_,this._visible.items=this._items.slice(l,_+1)}}this._opts.markOutside&&(t?(geByClass("ui_gallery_item_outside",this._inner).forEach(e=>{removeClass(e,"ui_gallery_item_outside")}),this._outside.left=-1,this._outside.right=-1):((a!==this._outside.left||!n)&&this._outside.left>=0&&(removeClass(this._items[this._outside.left],"ui_gallery_item_outside"),this._outside.left=-1),(u!==this._outside.right||!s)&&this._outside.right>=0&&(removeClass(this._items[this._outside.right],"ui_gallery_item_outside"),this._outside.right=-1)),n&&a!==this._outside.left&&(addClass(this._items[a],"ui_gallery_item_outside"),this._outside.left=a),s&&u!==this._outside.right&&(addClass(this._items[u],"ui_gallery_item_outside"),this._outside.right=u))}if(!this._opts.noArrows){var g=e>0,f=e+this._width<this._inner.scrollWidth;toggleClass(this._leftArrow,"ui_gallery__arrow_visible",this._scroll.rtl&&!this._scroll.backward?f:g),toggleClass(this._rightArrow,"ui_gallery__arrow_visible",this._scroll.rtl&&!this._scroll.backward?g:f)}(!this._scroll.backward&&this._inner.scrollWidth-e-this._width<c||this._scroll.backward&&e<c)&&this._onLoadMore()}_onArrowMouseOver(e){this._opts.noArrows||addClass(this._inner,"ui_gallery__inner_shift_"+e)}_onArrowMouseOut(){this._opts.noArrows||(removeClass(this._inner,"ui_gallery__inner_shift_left"),removeClass(this._inner,"ui_gallery__inner_shift_right"))}_onLoadMore(){!this._opts.onLoadMore||this._loadingMore||this._finised||(this._loadingMore=!0,this._opts.onLoadMore(this._items.length))}addMore(e,t){e=e||[],this.addItems(e),this._finised=!!t||!e.length,this._loadingMore=!1}addItems(e,t){if((e=e||[]).length){var n=t>=0&&t<this._items.length?this._items[t]:null;e.forEach(e=>{n?domInsertBefore(e,n):this._inner.appendChild(e)}),this.refresh()}}destroy(){removeEvent(this._innerCont),removeEvent(this._leftArrow),removeEvent(this._rightArrow),domData(this._el,"gallery-id",null),delete u().galleries[this._id],this._opts.onDestroy&&this._opts.onDestroy(),re(this._el)}removeItem(e){return s(e)&&(e=this._items[e]),!(!e||!inArray(e,this._items))&&(re(e),this.refresh(),this._items.length||this.destroy(),!0)}refresh(){this._width=getSize(this._el)[0],this._items=geByClass("ui_gallery_item",this._el),this._checkItemsAfterScroll(this._innerCont.scrollLeft,!0)}getItems(){return this._items}getVisibleItems(){return this._visible.items.map((e,t)=>[e,this._visible.left+t])}}},DM26:function(e,t,n){"use strict";n.r(t),n.d(t,"pause",function(){return r}),n.d(t,"retryFn",function(){return i}),n.d(t,"debouncedPromise",function(){return a}),n.d(t,"abortablePause",function(){return o}),n.d(t,"promisify",function(){return s});n("VRzm"),n("Btvt");function r(e,t){return new Promise(n=>{setTimeout(n.bind(null,t),1e3*e)})}function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=0;return function a(){for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return Promise.resolve().then(()=>e(...s)).catch(e=>{if(++i<=t){var o="function"==typeof n?n(i):0;return 0===o?a(...s):r(o).then(()=>a(...s))}throw e})}}function a(e,t,n){var r,i;return function(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return new Promise((e,a)=>{var s=n&&!r;clearTimeout(r),i&&i.reject("debounce"),r=setTimeout(function(){r=null,i=null,n||e(o)},t),s?e(o):n&&a("debounce"),i={resolve:e,reject:a}}).then(t=>e(...t))}}function o(e,t){var n,r=new Promise(r=>{n=r,setTimeout(r.bind(null,t),1e3*e)});return{pause:()=>r,abort(){n(t)}}}function s(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return new Promise(t=>e(...n,t))}}},ERyv:function(e,t,n){"use strict";n.r(t),n.d(t,"isWeirdLogging",function(){return u}),n.d(t,"imWeirdLog",function(){return d}),n.d(t,"imWeirdCatch",function(){return l}),n.d(t,"startLoggingAllUnhandled",function(){return _}),n.d(t,"stopLoggingAllUnhandled",function(){return h});n("VRzm"),n("Btvt");var r,i=n("BxOC"),a=n("DM26"),o=1;function s(e,t,n,i,a){if("Script error."!==e){var o=a?a.stack||a.message:null;d("unhandled_error",o?{err:e,stack:o}:{err:e})}r&&r.apply(this,arguments)}function c(e){e.preventDefault()}function u(){return!!window.imwl}function d(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];u()&&(n&&window.console&&(console.error(e,t),console.trace&&console.trace()),Object(a.retryFn)(i.post,3,()=>2)("al_im.php",{act:"a_weird_log",kind:e,data:JSON.stringify(extend({errIdx:o++,ua:navigator.userAgent},t))}))}function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return d(e,extend({err:t&&t.message||t},n)),Promise.reject(t)}function _(){r=window.onerror,window.onerror=s,window.addEventListener("unhandledrejection",c)}function h(){window.onerror=r,r=void 0,window.removeEventListener("unhandledrejection",c)}},Hx9h:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});n("91GP"),n("ioFf"),n("rGqo"),n("Btvt");var r=n("q1tI"),i=(n("17x9"),n("pemR"));function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}class s extends r.Component{render(){var e=this.props,t=e.className,n=e.appearance,s=e.wide,c=e.overflow,u=e.size,d=o(e,["className","appearance","wide","overflow","size"]),l=Object(i.classNames)("Button",...Array.isArray(n)?n.map(e=>`Button--${e}`):[`Button--${n}`],`Button--size-${u}`,{"Button--wide":!!s,"Button--overflow":!!c,"Button--disabled":!!e.disabled},t);return r.createElement("button",a({},d,{className:l}),e.children)}}s.defaultProps={appearance:"primary",size:"m",wide:!1,disabled:!1}},KFTi:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});n("91GP"),n("ioFf"),n("rGqo"),n("Btvt");var r=n("q1tI"),i=(n("17x9"),n("pemR"));function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function s(e){var t=e.inverted,n=e.size,s=e.className,c=o(e,["inverted","size","className"]),u=Object(i.classNames)("Progress",{"Progress--inverted":t},`Progress--size-${n}`,s);return r.createElement("div",a({className:u},c),r.createElement("div",{className:"Progress__item"}),r.createElement("div",{className:"Progress__item"}),r.createElement("div",{className:"Progress__item"}))}s.defaultProps={inverted:!1,size:"s"}},"MV/q":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});n("91GP"),n("ioFf"),n("rGqo"),n("Btvt");var r=n("q1tI"),i=(n("17x9"),n("pemR"));function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}class s extends r.Component{constructor(e){super(e),this.getRef=e=>{this.element=e},this.resize=()=>{var e=this.element;if(e){var t=e.offsetHeight,n=e.scrollHeight,r=0;n+r<=t&&(r=0),e.value&&this.setState({height:n-r}),this.setState({height:0},()=>{var t=e.scrollHeight-r;this.setState({height:t}),this.props.onResize(e)})}},this.onChange=e=>{this.props.grow&&this.resize(),this.isControlledOutside||this.setState({value:e.target.value}),this.props.onChange&&this.props.onChange(e)},this.state={value:void 0===e.value?e.initialValue||"":void 0},void 0!==e.value&&(this.isControlledOutside=!0)}componentDidMount(){this.props.grow&&this.resize()}render(){var e=this.props,t=e.className,n=(e.initialValue,e.grow,e.style),s=(e.onResize,e.value),c=o(e,["className","initialValue","grow","style","onResize","value"]),u=this.isControlledOutside?s:this.state.value,d=this.state.height||n.height||66;return r.createElement("textarea",a({},c,{value:u,onChange:this.onChange,onInput:this.onChange,onPaste:this.onChange,ref:this.getRef,style:a({},n,{height:d}),className:Object(i.classNames)("Textarea",t)}))}}s.defaultProps={initialValue:"",grow:!0,onResize:()=>{},style:{}}},MhhX:function(e,t,n){"use strict";n.r(t),n.d(t,"isUnread",function(){return a}),n.d(t,"isServiceMsg",function(){return o}),n.d(t,"isCallMessage",function(){return s}),n.d(t,"isOut",function(){return c}),n.d(t,"hasReply",function(){return u}),n.d(t,"isGraffiti",function(){return l}),n.d(t,"isAudioMsg",function(){return _}),n.d(t,"isSticker",function(){return h}),n.d(t,"isGift",function(){return g}),n.d(t,"isMoney",function(){return f}),n.d(t,"isMoneyRequest",function(){return m}),n.d(t,"isVKPay",function(){return p}),n.d(t,"isImportant",function(){return b}),n.d(t,"getUserId",function(){return v}),n.d(t,"getAuthorId",function(){return y}),n.d(t,"wasEdited",function(){return O}),n.d(t,"isMessageSelected",function(){return w});n("OEbY");var r=n("f01n"),i=n("aong");function a(e,t){return"number"!=typeof t.messageId||(c(t)?t.messageId>e.out_up_to:t.messageId>e.in_up_to)}function o(e){return e.kludges&&void 0!==e.kludges.source_act}function s(e){return"call"==e.kludges.attach1_type}function c(e){return e.flags&r.FLAG_OUTBOUND}function u(e){var t=e.attaches.filter(e=>"mail"===e.type).length>0;return e.attaches.filter(e=>"reply"===e.type).length>0||e.flags&r.FLAG_HAS_REPLY&&t}function d(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=e.attaches[0];return r&&(r.type===t||r.type===n)}function l(e){return d(e,"doc")&&"graffiti"===e.attaches[0].kind}function _(e){return Boolean(e.attaches.find(e=>"doc"===e.type&&"audiomsg"===e.kind))}function h(e){return Boolean(e.attaches.find(e=>"sticker"===e.type))}function g(e){return d(e,"gift")}function f(e){return d(e,"money_transfer","money_request")}function m(e){return d(e,"money_request")}function p(e){return d(e,"link","vkpay")&&6217559==e.kludges.attach1_app_id}function b(e){return e.flags&r.FLAG_IMPORTANT}function v(e){return c(e)?vk.id:e.userId}function y(e,t){var n=Object(i.unpackStore)(e);return c(t)?n.id:t.userId}function O(e){return e.update_time>0}function w(e,t){return(e.get().selectedMessages||[]).indexOf(t)>=0}},N4ZS:function(e,t,n){"use strict";function r(e){return"https://vk.com/web/away.php?to="+e}function i(e,t){var n=decodeURIComponent(e);return/^\/[^/]/.test(n)||/^(https?:\/\/)?([a-z0-9_\-.]+\.)?vk.com(\/.*)?/.test(n)?e:"/away.php?to="+encodeURIComponent(n)+(t?"&utf=1":"")}n.r(t),n.d(t,"wrapAway",function(){return r}),n.d(t,"wrapAwayIfExternal",function(){return i})},O8ze:function(e,t,n){"use strict";n.r(t),n.d(t,"statlogsForwardEvent",function(){return o}),n.d(t,"statlogsForwardFromCommunityEvent",function(){return s}),n.d(t,"statlogsCommunityTemplatesClickEvent",function(){return c}),n.d(t,"statlogsForwardFromChannel",function(){return u}),n.d(t,"statlogsSendingTime",function(){return l}),n.d(t,"statlogsSendingTimeStart",function(){return _}),n.d(t,"statlogsSendingTimeEnd",function(){return h}),n.d(t,"statlogsSendingError",function(){return g}),n.d(t,"statlogsSendingQueueLength",function(){return m}),n.d(t,"statlogsSendingRetry",function(){return p}),n.d(t,"statlogsBrowserNotificationsUser",function(){return b}),n.d(t,"statlogsBrowserNotificationsOn",function(){return v}),n.d(t,"statlogsBrowserNotificationsOff",function(){return y});n("pIFo");var r=n("1y80"),i=n("aong"),a={};function o(e){Object(r.statlogsProbValueEvent)(.1,"im_forward_stat",d(e),!!e.get().gid)}function s(e,t){Object(r.statlogsProbValueEvent)(.1,"im_forward_from_community_stat",d(e),!!e.get().gid,+t)}function c(){Object(r.statlogsProbValueEvent)(1,"im_apply_community_template_stat",1)}function u(){Object(r.statlogsProbValueEvent)(1,"messages_channel_forward_click",1)}function d(e){var t=e.get().pendingForward;return+(t&&t.msgIds&&t.msgIds.length)}function l(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!Object(r.randEnabled)(1))return()=>{};var a=+new Date,o=f(e);return function(){var e=+new Date-a;Object(r.statlogsValueEvent)("messages_send_time_web",e,t,n,o,i)}}function _(e,t,n,r){if(t.messageId&&-1!==String(t.messageId).indexOf("rid")){var i=[t.messageId.replace("rid",""),n,r].join("_"),o=t.attaches.length>0;a[i]=l(e,n,r,o)}}function h(e,t,n,r){var i=[t.randomId,n,r].join("_"),o=a[i];o&&(o(),delete a[i])}function g(e,t,n,i){var a=f(e),o=""===t?"network":"unknown";Object(r.randEnabled)(1)&&Object(r.statlogsValueEvent)("messages_send_errors_web",o,n,i,a)}function f(e){var t=Object(i.unpackStore)(e);return Boolean(t.longpoll&&t.longpoll.isEnabled&&t.longpoll.isEnabled())}function m(e){var t=Object(i.unpackStore)(e),n=t.imQueue(t.peer).length;Object(r.randEnabled)(1)&&Object(r.statlogsValueEvent)("messages_send_queue_size",n)}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown";Object(r.randEnabled)(1)&&Object(r.statlogsValueEvent)("messages_send_retry",1,t,e)}function b(){var e="im_browser_notifications_users";ls.get(e)||ls.get("im_ui_notify_off")||(ls.set(e,1),Object(r.statlogsValueEvent)(e,1))}function v(){Object(r.statlogsProbValueEvent)(1,"im_browser_notifications_on",1)}function y(){Object(r.statlogsProbValueEvent)(1,"im_browser_notifications_off",1)}},P13b:function(e,t,n){"use strict";n.r(t);n("rE2o"),n("ioFf"),n("91GP"),n("Vd3H"),n("rGqo"),n("a1Th"),n("tUrg"),n("pIFo"),n("KKXr"),n("VRzm"),n("Btvt");var r=n("f01n"),i=n("h++7"),a=n("bIHZ"),o=n("rHUl"),s=n("MhhX"),c=n("S2bU"),u=n("rudk"),d=n("/eGY"),l=n("vT4u"),_=n("ofcU");function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var g="_im_join_chat",f="_im_accept_mr",m="_im_reject_mr";function p(e){return e.parentNode.getAttribute("data-receiver-chat-peer-id")}function b(e,t,n){var i=Object(_.createModule)({handlers:(i,a)=>{a(e,"click",g,e=>(function(e,t){var n=domData(t,"chat-id"),i=domData(t,"hash");return lockButton(t),Object(l.joinChat)(n,i,e.get()).then(n=>{var i=h(n,1)[0];unlockButton(t);var a=e.get();a.longpoll.push([Object(r.changePeer)(i)]),a.onJoinChat&&a.onJoinChat(i)}).catch(e=>{showFastBox(getLang("mail_join_invite_error_title"),e),unlockButton(t)})})(t,e.target)),a(e,"click",f,e=>(function(e,t){var n=p(t);return lockButton(t),e.set(l.acceptMessageRequest.bind(null,n)).then(()=>{unlockButton(t),e.get().longpoll.push([Object(r.changePeer)(n)])}).catch(e=>{jr(),showFastBox(getLang("mail_join_invite_error_title"),e),unlockButton(t)})})(t,e.target)),a(e,"click",m,e=>(function(e,t,n){var r=p(n);return lockButton(n),e.set(l.rejectMessageRequest.bind(null,r)).then(()=>{t.updateMenu(),t.updateList(),unlockButton(n),jr()}).catch(e=>{jr(),showFastBox(getLang("mail_error"),e),unlockButton(n)})})(t,n,e.target))}});return{unmount(){Object(_.destroyModule)(i)}}}var v=n("aong"),y=n("86+7"),O=n("Wu9C"),w=n("wSs/"),k=n("ERyv"),j=n("lJdi"),E=n("t7n3"),I="recently",T="last_week",A="last_month",C="long_ago";function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}n.d(t,"SENDING_CLASS",function(){return P}),n.d(t,"FAILED_CLASS",function(){return M}),n.d(t,"ORIGINAL_CLASS",function(){return D}),n.d(t,"RESTORE_CLASS",function(){return L}),n.d(t,"TYPING_CLASS",function(){return x}),n.d(t,"MESSAGE_KEYBOARD_BUTTON_CLASS",function(){return R}),n.d(t,"MESSAGE_STACK_CLASS",function(){return N}),n.d(t,"CREATE_CHAT_ACTION",function(){return F}),n.d(t,"CHAT_TITLE_ACTION",function(){return B}),n.d(t,"CHAT_INVITE_USER",function(){return H}),n.d(t,"CHAT_KICK_USER",function(){return G}),n.d(t,"CHAT_PHOTO_UPDATE",function(){return U}),n.d(t,"CHAT_PHOTO_REMOVE",function(){return q}),n.d(t,"CHAT_PIN_MESSAGE",function(){return z}),n.d(t,"CHAT_UNPIN_MESSAGE",function(){return $}),n.d(t,"CHAT_INVITE_BY_LINK",function(){return V}),n.d(t,"CHAT_INVITE_BY_MESSAGE_REQUEST",function(){return W}),n.d(t,"DESELECT_ALL_CLASS",function(){return Y}),n.d(t,"HIDE_TOP_NOTICE_CLASS",function(){return K}),n.d(t,"HIDE_ASIDE_NOTICE_CLASS",function(){return Q}),n.d(t,"HIDE_ASIDE_PROMO_BLOCK_CLASS",function(){return X}),n.d(t,"INSTALL_VKADMIN_LINK",function(){return J}),n.d(t,"CLEAR_RECENT_CLASS",function(){return Z}),n.d(t,"TOGGLE_MR_TAB",function(){return ee}),n.d(t,"MESSAGE_SEARCH_CLASS",function(){return te}),n.d(t,"PINNED_CONTAINER_CLASS",function(){return ne}),n.d(t,"getClassicChatHeight",function(){return nt}),n.d(t,"setClassicChatHeight",function(){return rt}),n.d(t,"fixTableCellChildHeight",function(){return it}),n.d(t,"applyInnerHtml",function(){return at}),n.d(t,"compensateHistoryHeightChange",function(){return ot}),n.d(t,"renderSticker",function(){return st}),n.d(t,"isAlreadyDeleted",function(){return ct}),n.d(t,"replaceMessageAttrs",function(){return ut}),n.d(t,"isVoiceMessageAvailable",function(){return dt}),n.d(t,"getAvailableMicrophones",function(){return lt}),n.d(t,"renderAttach",function(){return _t}),n.d(t,"dayFromVal",function(){return ht}),n.d(t,"showInvisibleBar",function(){return gt}),n.d(t,"updateMessageInCache",function(){return ft}),n.d(t,"editAndReplaceMessage",function(){return mt}),n.d(t,"renderMessage",function(){return pt}),n.d(t,"renderMessageMedia",function(){return bt}),n.d(t,"ensureDomHasActions",function(){return vt}),n.d(t,"renderCallMessage",function(){return yt}),n.d(t,"appendToHistory",function(){return Ot}),n.d(t,"restoreQueue",function(){return wt}),n.d(t,"markMessagesAsRead",function(){return kt}),n.d(t,"replaceAttaches",function(){return jt}),n.d(t,"isDuplicate",function(){return Et}),n.d(t,"isContactPeer",function(){return It}),n.d(t,"isPeerActive",function(){return Tt}),n.d(t,"isFvkcomgroup",function(){return At}),n.d(t,"isTabLoaded",function(){return Ct}),n.d(t,"isTabLoadedWithMessage",function(){return St}),n.d(t,"parseMessage",function(){return Lt}),n.d(t,"convertPeerToUrl",function(){return xt}),n.d(t,"unUrlPeer",function(){return Rt}),n.d(t,"simplifyCounter",function(){return Nt}),n.d(t,"chatActions",function(){return Ft}),n.d(t,"renderPhotos",function(){return Gt}),n.d(t,"renderPhotosFromTab",function(){return Ut}),n.d(t,"renderBtnSearchOnlyMessages",function(){return qt}),n.d(t,"renderMessagesSep",function(){return zt}),n.d(t,"renderConversationsSep",function(){return $t}),n.d(t,"renderPopularSuggSep",function(){return Vt}),n.d(t,"renderClearRecent",function(){return Wt}),n.d(t,"renderPopularSuggestions",function(){return Yt}),n.d(t,"setMessageError",function(){return Kt}),n.d(t,"startResendMessage",function(){return Qt}),n.d(t,"removeMessages",function(){return Xt}),n.d(t,"removeStartingFromMessage",function(){return Zt}),n.d(t,"removeMessagesWithRestore",function(){return en}),n.d(t,"restoreMessage",function(){return tn}),n.d(t,"formatTyper",function(){return nn}),n.d(t,"loadSummaryActivityType",function(){return rn}),n.d(t,"renderEmptySearch",function(){return on}),n.d(t,"serviceLink",function(){return sn}),n.d(t,"renderServiceMsg",function(){return cn}),n.d(t,"addChatPhotoToUpdate",function(){return un}),n.d(t,"replaceSpecialSymbols",function(){return dn}),n.d(t,"isSelfMessage",function(){return ln}),n.d(t,"showVerifiedTooltip",function(){return _n}),n.d(t,"wrapLoading",function(){return hn}),n.d(t,"tabFromIds",function(){return gn}),n.d(t,"checkSelectClick",function(){return fn}),n.d(t,"renderGoTo",function(){return mn}),n.d(t,"showFlushChat",function(){return pn}),n.d(t,"showLeaveDialog",function(){return bn}),n.d(t,"showUnpinDialog",function(){return vn}),n.d(t,"showMsgDeleteDialog",function(){return yn}),n.d(t,"cleanHistory",function(){return On}),n.d(t,"inviteUser",function(){return wn}),n.d(t,"toggleMessageRequestsTab",function(){return kn}),n.d(t,"showUnreadOnly",function(){return jn}),n.d(t,"changeTab",function(){return En}),n.d(t,"isImportant",function(){return In}),n.d(t,"isUnrespond",function(){return Tn}),n.d(t,"isPeerBlocked",function(){return An}),n.d(t,"isPendingForward",function(){return Cn}),n.d(t,"isPeerBlockedByMe",function(){return Sn}),n.d(t,"blockLatencyCompensation",function(){return Pn}),n.d(t,"showSpamLayer",function(){return Mn}),n.d(t,"getLastSeenTextInHeader",function(){return Dn}),n.d(t,"getLastSeenText",function(){return Ln}),n.d(t,"showBlacklistBoxUser",function(){return Rn}),n.d(t,"showBlacklistBox",function(){return Nn}),n.d(t,"getBaseLink",function(){return Fn}),n.d(t,"showFavvedBox",function(){return Bn}),n.d(t,"isEditableFocused",function(){return Hn}),n.d(t,"updateStar",function(){return Gn}),n.d(t,"removewNewUnreadBarAndMerge",function(){return Un}),n.d(t,"isMessagesVisible",function(){return qn}),n.d(t,"hideTopNotice",function(){return zn}),n.d(t,"hideAsideNotice",function(){return $n}),n.d(t,"hideAsidePromoBlock",function(){return Vn}),n.d(t,"installVKAdminApp",function(){return Wn}),n.d(t,"renderShortText",function(){return Kn}),n.d(t,"attachToText",function(){return Qn}),n.d(t,"lockButton",function(){return Xn}),n.d(t,"unlockButton",function(){return Jn}),n.d(t,"renderPinnedMessage",function(){return Zn}),n.d(t,"renderPinnedMedia",function(){return er}),n.d(t,"showMessageInfoTooltip",function(){return tr}),n.d(t,"showEditTimeTooltip",function(){return nr}),n.d(t,"getPinnedMessageHeight",function(){return rr}),n.d(t,"boxHandleMessagesLabelsTooltips",function(){return ir}),n.d(t,"showPinnedBox",function(){return ar}),n.d(t,"showRepliedBox",function(){return or}),n.d(t,"isUserAliveInChat",function(){return sr}),n.d(t,"getAliveMembersCount",function(){return cr}),n.d(t,"normalizeTab",function(){return ur}),n.d(t,"normalizeTabsGotFromServer",function(){return dr}),n.d(t,"splitMessageToParts",function(){return lr}),n.d(t,"isMessageTooLong",function(){return _r}),n.d(t,"showInvitationBox",function(){return hr}),n.d(t,"showWaitUntilUploadedBox",function(){return gr}),n.d(t,"canMessageBeDeletedForAll",function(){return fr}),n.d(t,"getTopChatMembers",function(){return mr}),n.d(t,"getChatMembersByIds",function(){return pr}),n.d(t,"getChatMembers",function(){return br}),n.d(t,"formatTimespan",function(){return vr}),n.d(t,"focusOnMessage",function(){return yr}),n.d(t,"getNowEditingMessage",function(){return Or}),n.d(t,"checkMessageRequestsTab",function(){return wr}),n.d(t,"updateMessageRequestsCounterInDOM",function(){return kr}),n.d(t,"hideAllBoxes",function(){return jr}),n.d(t,"getMessageRequestDateText",function(){return Er}),n.d(t,"getFirstUnread",function(){return o.getFirstUnread}),n.d(t,"isSearchShown",function(){return o.isSearchShown}),n.d(t,"getPeer",function(){return o.getPeer}),n.d(t,"getCurrentKeyboard",function(){return o.getCurrentKeyboard}),n.d(t,"getKeyboard",function(){return o.getKeyboard}),n.d(t,"getTab",function(){return o.getTab}),n.d(t,"getCurrentTab",function(){return o.getCurrentTab}),n.d(t,"getSelectedMessages",function(){return o.getSelectedMessages}),n.d(t,"getMessageRangeFromSelection",function(){return o.getMessageRangeFromSelection}),n.d(t,"countUnread",function(){return o.countUnread}),n.d(t,"getMessageByRid",function(){return o.getMessageByRid}),n.d(t,"isRidExist",function(){return o.isRidExist}),n.d(t,"getLocalId",function(){return o.getLocalId}),n.d(t,"getLastMessage",function(){return o.getLastMessage}),n.d(t,"parserMessage",function(){return o.parserMessage}),n.d(t,"getAuthorFullName",function(){return o.getAuthorFullName}),n.d(t,"getMessage",function(){return o.getMessage}),n.d(t,"getPreviousMessage",function(){return o.getPreviousMessage}),n.d(t,"isClassicInterface",function(){return o.isClassicInterface}),n.d(t,"isLocksAvailable",function(){return o.isLocksAvailable}),n.d(t,"isFoldersAvailable",function(){return o.isFoldersAvailable}),n.d(t,"isCommunityInterface",function(){return o.isCommunityInterface}),n.d(t,"isChannel",function(){return o.isChannel}),n.d(t,"getBareTab",function(){return o.getBareTab}),n.d(t,"isReversedDialogs",function(){return o.isReversedDialogs}),n.d(t,"isFullyLoadedTab",function(){return o.isFullyLoadedTab}),n.d(t,"makeTabNotFullyLoaded",function(){return o.makeTabNotFullyLoaded}),n.d(t,"isGoToEndVisible",function(){return o.isGoToEndVisible}),n.d(t,"getUnreadScrollBottom",function(){return o.getUnreadScrollBottom}),n.d(t,"isSendingAvailable",function(){return o.isSendingAvailable}),n.d(t,"isCommunityPeer",function(){return o.isCommunityPeer}),n.d(t,"isCommunityBlocked",function(){return o.isCommunityBlocked}),n.d(t,"checkVoiceMessageAvailable",function(){return o.checkVoiceMessageAvailable}),n.d(t,"isSearching",function(){return o.isSearching}),n.d(t,"getSearchText",function(){return o.getSearchText}),n.d(t,"isSearchingValue",function(){return o.isSearchingValue}),n.d(t,"isRecentSearchesActive",function(){return o.isRecentSearchesActive}),n.d(t,"getPinnedMessage",function(){return o.getPinnedMessage}),n.d(t,"doPopularSuggExist",function(){return o.doPopularSuggExist}),n.d(t,"isAnyMessageBeingEdited",function(){return o.isAnyMessageBeingEdited}),n.d(t,"getGroupId",function(){return o.getGroupId}),n.d(t,"getTabDraft",function(){return o.getTabDraft}),n.d(t,"getTemplates",function(){return o.getTemplates}),n.d(t,"tabIsMessageRequest",function(){return o.tabIsMessageRequest}),n.d(t,"tabIsMessageRequestToChat",function(){return o.tabIsMessageRequestToChat}),n.d(t,"removeMessageRequestFolderFlags",function(){return o.removeMessageRequestFolderFlags}),n.d(t,"isMessageRequestFolder",function(){return o.isMessageRequestFolder}),n.d(t,"tabIsOutgoingMessageRequest",function(){return o.tabIsOutgoingMessageRequest}),n.d(t,"existsIncomingMessageRequest",function(){return o.existsIncomingMessageRequest}),n.d(t,"isMessageRequestChangedEvent",function(){return o.isMessageRequestChangedEvent}),n.d(t,"isCommunityChat",function(){return o.isCommunityChat}),n.d(t,"isCommunityChatDeleted",function(){return o.isCommunityChatDeleted}),n.d(t,"isClosedChat",function(){return o.isClosedChat}),n.d(t,"isChatPeer",function(){return u.isChatPeer}),n.d(t,"isUserPeer",function(){return u.isUserPeer}),n.d(t,"isReservedPeer",function(){return u.isReservedPeer});var P="_im_mess_sending",M="_im_mess_failed",D="_im_mess_original",L="_im_mess_restore",x="_im_typing",R="_im_mess_btn",N="_im_mess_stack",F="chat_create",B="chat_title_update",H="chat_invite_user",G="chat_kick_user",U="chat_photo_update",q="chat_photo_remove",z="chat_pin_message",$="chat_unpin_message",V="chat_invite_user_by_link",W="chat_invite_user_by_message_request",Y="_im_deselect_all",K="_im_top_notice_hide",Q="_im_aside_notice_hide",X="_im_aside_promo_block_hide",J="_im_vkadmin_promo_link",Z="_im_clear_recent",ee="_im_toggle_mr_tab",te="_im_mess_search",ne="_im_pinned",re=window,ie=re.vk,ae=re.ls,oe=re.se,se=re.re,ce=re.rs,ue=re.sech,de=re.inArray,le=re.intval,_e=re.trim,he=re.stripHTML,ge=re.domFC,fe=re.domPS,me=re.domLC,pe=re.domChildren,be=re.domClosestSibling,ve=re.domData,ye=re.geByClass,Oe=re.geByClass1,we=re.gpeByClass,ke=re.addClass,je=re.removeClass,Ee=re.toggleClass,Ie=re.hasClass,Te=re.attr,Ae=re.setStyle,Ce=re.val,Se=re.getTemplate,Pe=re.getLang,Me=re.langSex,De=re.langDate,Le=re.langNumeric,xe=re.getDateText,Re=re.getSmDate,Ne=re.getShortDate,Fe=re.isSameDate,Be=re.isToday,He=re.ajax,Ge=re.showBox,Ue=re.showFastBox,qe=re.showTabbedBox,ze=re.showTooltip,$e=re.onlinePlatformClass,Ve=re.AudioMessagePlayer,We=re.Emoji,Ye=re.slideUp,Ke=re.fadeOut,Qe=re.cancelEvent,Xe=4096,Je=100,Ze=8,et=52,tt="chatPosition";function nt(){return ae.get(tt)||0}function rt(e){e>=window.clientHeight()-30&&(e=0),ae.set(tt,e)}function it(e,t){var n=Oe(e,t);n.firstElementChild.offsetHeight!==n.parentNode.offsetHeight&&Ae(n.firstElementChild,{height:n.parentNode.offsetHeight})}function at(e,t){e&&e.innerHTML!==t&&(e.innerHTML=t)}function ot(e,t,n,r){var i=t&&!n?1:!t&&n?-1:0;i&&!Object(o.isClassicInterface)(e)&&r().compensateHistoryHeightChange(i)}function st(e,t,n,r){var i=window.devicePixelRatio>=2?"256":"128",a="animation"===n,o="im_gift";a&&(o+=" sticker_img");var s=`<img height="128" class="${o}" src="${Stickers.getStickerUrl(le(e),i)}"/>`;if(a){var c="animatedSticker"+r;s=`<div id="${c}" data-loop-count=3 data-animation-path="${"/stickers.php?act=proxy_animation&product_id="+t+"&sticker_id="+e}" onmouseenter="StickersAnimation.loadAndPlaySticker(this);"\n     data-uniq-id="${r}" data-sticker-id="${le(e)}" class="sticker_animation sticker_animation_128 im_gift">${s}</div>`;var u=!1;browser.msie?(0^r)===r&&(u=!0):u=Number.isInteger(r),u&&window.StickersSettings.getAutoplay()&&window.StickersAnimation&&window.StickersAnimation.loadAndPlayStickerWithTimer(c,10)}return t&&(s=`<a onmouseover="return Emoji.stickerOver(${le(e)}, this);"\n        onclick="return Emoji.clickSticker(${le(t)}, this, event);">${s}</a>`),s=`<div class="im_sticker_row">${s}</div>`}function ct(e,t,n){var r=e.get?e.get():e;if(Ct(r,t)){var i=r.tabs[t].deleted||[];return de(n,i)}return!1}function ut(e,t,n){var r=n.randomId,i=Oe(`_im_mess_rid${r}`,t);return i&&(t=Ot(e,n,t=Jt([i],t),!0,!1)),t}function dt(e){var t=Object(o.checkVoiceMessageAvailable)(e);return browser.mobile&&browser.safari?Promise.resolve(!1):void 0!==t?Promise.resolve(t):lt().then(e=>e.length>0).catch(e=>!1)}function lt(){return window.AudioContext&&navigator.mediaDevices?navigator.mediaDevices.enumerateDevices().then(function(e){for(var t=[],n=0;n<e.length;n++)"audioinput"==e[n].kind&&t.push(e[n]);return t}):Promise.reject(new Error("NotSupported"))}function _t(e){return Se("im_preloader",{preloader:ce(ie.pr_tpl,{id:""}),cls:`im-preloader_attach im-preloader_visible im-preloader_${e}`})}function ht(e){var t=e.split(".");return(t[0]<10?"0":"")+t[0]+(t[1]<10?"0":"")+t[1]+t[2]}function gt(e){var t=Oe("_im_invisible_bar",e);t&&(je(t,"_im_invisible_bar"),je(t,"im-page--history-new-bar_hide"))}function ft(e,t,n){var r=ve(n,"msgid"),i=Oe(`_im_mess_${r}`,t),a=n.cloneNode(!0);return i&&(i.parentNode.replaceChild(a,i),vt(t)),t}function mt(e,t,n){var r=pt(e,t),i=Oe(`_im_mess_${t.messageId}`,n);return i&&(i.parentNode.replaceChild(oe(r),i),vt(n)),n}function pt(e,t){var n=[],r=Object(s.isUnread)(e.tabs[t.peerId],t),i=Object(s.isCallMessage)(t),a=Object(s.hasReply)(t)?Se("im_message_media",{type:"reply",messageId:t.messageId,attaches:_t("reply"),text:""}):"";i||n.push("_im_mess"),Object(s.isOut)(t)&&r&&!i&&n.push("im-mess_unread _im_mess_unread"),Object(s.isOut)(t)&&!i&&n.push("im-mess_out"),Object(s.wasEdited)(t)&&n.push("im-mess_was_edited"),Object(w.canMessageBeEdited)(e,t)&&n.push("im-mess_editable"),Object(s.isImportant)(t)&&n.push("im-mess_fav"),-1!=(e.selectedMessages||[]).indexOf(t.messageId)&&n.push("im-mess_selected");var l=Date.now()-1e3*t.date>1e3;t.local&&l&&n.push("im-mess_sending"),t.local&&n.push(`${P}`),t.local&&Object(s.wasEdited)(t)&&!r&&n.push("im-mess_unread im-mess_nobg"),t.failed&&n.push(`im-mess_failed ${M}`),Object(s.isGift)(t)&&n.push("im-mess_gift"),i&&n.push("_im_mess_callsnippet");var _=bt(t).concat(function(e){if(e.kludges.keyboard&&e.kludges.keyboard.inline){var t=e.kludges.keyboard.buttons;return[].concat(Se("sImMessageKeyboard",{content:t.map(e=>Se("sImMessageKeyboardRow",{content:e.map(e=>Se("sImMessageKeyboardButton",{label:Object(d.getButtonLabel)(e),appearance:Object(d.getButtonAppearance)(e),type:e.action.type,modifier:e.action.type.replace("_","-"),attributes:Object(d.getAttributesFromActionObject)(e.action),tagName:e.action.type===d.BUTTON_TYPE_OPEN_LINK?"a":"button"})).join("")})).join("")}))}return[]}(t)),h=function(e,t){var n="",r=Object(v.unpackStore)(e).sourceEnabled&&t.kludges&&t.kludges.from_widget&&t.kludges.ref_source;Object(s.wasEdited)(t)&&(n+=Se("sImLblWasEdited",{update_time:t.update_time}));if(Object(o.isCommunityInterface)(e)&&r){var i=t.kludges.ref_source,a={};try{(a=JSON.parse(Object(E.unclean)(i))).link&&a.info&&(a.link=Object(c.replaceHyperLinks)(Object(E.clean)(a.link),c.linksReplacer.bind(null,!1)),a=Object(E.clean)(langStr(Pe("mail_source_info"),"link",a.link,"info",Object(E.clean)(a.info))),n+=Se("sImLblWasSourceInfo",{source:a}))}catch(e){}}return n}(e,t),g=a+Lt(e,t.text,t.kludges,!1,t.peerId);t.subject&&"..."!==t.subject.trim()&&!Object(u.isChatPeer)(t.peerId)&&(g=Se("im_topic",{topic:t.subject})+g);var f=Object(s.isGift)(t)?`<div class="im-mess--gift-lbl">${g}</div>`:"",m=_.length>0?Se("im_message_media",{type:"media",messageId:t.messageId,attaches:_.join(""),text:f}):"";return Object(s.isGift)(t)||(m=g+m),Object(s.isCallMessage)(t)&&(m+=Se("sImCallSnippet",yt(t,!1,!0,e))),m+=h,Se("im_msg_row",{msg_id:t.messageId,from_id:t.peerId,aria_hidden:t.local&&!t.failed?"true":"false",ts:t.date,marker_params:t.failed?`aria-label="${Pe("mail_send_message_error")}" role="link"`:"",unread_params:r?`aria-label="${Pe("mail_unread_message")}"`:"",cls:n.join(" ")}).replace("%text%",()=>m)}function bt(e){return e.attaches.reduce((t,n)=>!Object(s.hasReply)(e)||"mail"!==n.type&&"reply"!==n.type?"call"===n.type?t:("sticker"===n.type?e.messageId?t.push(st(n.id,n.productId,n.kind,e.messageId)):t.push(st(n.id,n.productId)):t.push(_t(n.type)),t):t,[])}function vt(e){for(var t=e.querySelectorAll("._im_mess_noa:not(._im_mess_callsnippet):not(._im_mess_srv)"),n=t.length;n--;)Ie(t[n],"im-mess_fwd")||t[n].insertAdjacentHTML("afterbegin",Se("sImHistoryRowActions")),je(t[n],"_im_mess_noa")}function yt(e,t,n,r){var i,a,o,s,c,u,d=ie.id,l=e.attaches[0],_=l.initiatorId,h=l.state,g=l.receiverId,f=d===_,m=Boolean(l.video),p={title:"",description:"",modifier:""};switch(h){case"reached":var b=t?"":(a=l.duration,o=Math.floor(a/3600),s=Math.floor(a/60)-60*o,c=!1,u=!1,[o,s,a-3600*o-60*s].reduce((e,t)=>{if(0===t&&!u)return u=!0,e;c&&(t=t<10?"0"+t:t);var n=`${e}${""!==e?":":""}${t}`;return c=!0,u=!0,n},""));i=(i=Pe(f?"mail_call_outgoing":"mail_call_incoming")).replace("{duration}",b),p.title=Pe(f?"mail_call_snippet_outgoing":"mail_call_snippet_incoming"),p.description=b;break;case"canceled_by_initiator":f?(i=Pe("mail_call_canceled"),p={title:Pe("mail_call_snippet_outgoing"),description:Se("sImCallSnippetCanceled",{text:Pe("mail_call_snippet_canceled")})}):(i=Pe("mail_call_missed"),p={title:Pe("mail_call_snippet_missed_call"),description:Se("sImCallSnippetDMLink")});break;case"canceled_by_receiver":if(f){if(t)return Pe("mail_call_declined");var v=Object(y.oCacheGet)(r,g);i=v?Me(v.sex,Pe("mail_call_declined_by","raw")).replace("{user_name}",v.first_name):Pe("mail_call_declined"),p={title:Pe("mail_call_snippet_outgoing"),description:Se("sImCallSnippetCanceled",{text:Pe("mail_call_snippet_declined")})}}else i=Pe("mail_call_canceled"),p={title:Pe("mail_call_snippet_incoming"),description:Se("sImCallSnippetCanceled",{text:Pe("mail_call_snippet_canceled")})};break;default:i=Pe("mail_added_call"),p.title=Pe("mail_added_call")}return m&&(p.modifier="im-call-snippet_video"),n?p:Se("im_calls_link",{text:i})}function Ot(e,t,n){!(arguments.length>3&&void 0!==arguments[3])||arguments[3];var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=Date.now()-1e3*t.date>1e3,c=e.tabs[t.peerId];if(!n||Oe("_im_mess",n)||Oe("_im_bar_date",n)||(n.innerHTML=""),c.skipped>0)return n;var d=[];t.local||(d=e.imQueue(t.peerId,r)),d.length>0&&Jt(d.map(e=>Oe("_im_mess_rid"+e.rid,n),n).filter(e=>e));var l=pt(e,t),_=me(n);Ie(_,"_im_mess_stack")||(_=be(_,"._im_mess_stack",-1));for(var h=Object(o.getLastMessage)(e,t.peerId,t.messageId);t.peerId===e.peer&&h&&!Oe("_im_mess_"+h.messageId);)h=Object(o.getLastMessage)(e,t.peerId,h.messageId);var g=Oe("_im_unread_bar_row",n),f=Object(s.getUserId)(t),m=h?Pt(h.date,e):0;if(!h||Mt(c,h,t,e,i)){var p="",b=!1;if(g&&Object(s.isOut)(t)&&Un(e,n,t.peerId),1===c.unread&&!Object(s.isOut)(t)&&i&&(p+=Se("im_mess_bar",{}),b=!0,Un(e,n,t.peerId)),!Be(new Date(m))){var O=new Date,w=b?"im-page--history-new-bar_hide _im_invisible_bar":"";p+=Se("im_day_bar",{day:Ne(t.date,e.timeshift,!0,Pe("months_of","raw"),!0),date:t.date,day_class:O.getDate()+O.getMonth()+O.getFullYear()+" "+w})}if(Object(s.isServiceMsg)(t))p+=Se("im_service_row",{text:cn(e,t,c),type:"",date:t.date,from_id:"",message_id:t.messageId});else{var k=e.gid&&Object(s.isOut)(t)?le(t.kludges.from_admin)||-e.gid:0,j=Object(y.oCacheGet)(e,k?-e.gid:f)||c,E=Object(u.isChatPeer)(t.peerId)?j.name:j.first_name,I=j.link||c.href,T=Se("im_mess_stack_name",{name:E,link:I,class:Object(s.isMoney)(t)?" im-mess-stack--lnk-money-transfer":""});if(Object(s.isGift)(t)){var A=Pe("mail_gift_message_sent","raw");T+=` <span class="im-mess-stack--gift">${Me(j.sex||0,A)}</span>`}if(Object(s.isMoney)(t)){var C=Object(s.isMoneyRequest)(t)?Pe("mail_money_request_message_sent","raw"):Pe("mail_money_tranfer_message_sent","raw");T+=` <span class="im-mess-stack--money-transfer">${Me(j.sex||0,C)}</span>`}var S,M=e.gid?"/gim"+e.gid:"/im";if(S=t.local?Dt(t.date,e.timeshift):Se("im_stack_date",{date:Dt(t.date,e.timeshift),link:`${M}?sel=${t.peerId}&msgid=${t.messageId}`}),k&&e.admins[k]){var D=e.admins[k],L=k===ie.id?Pe("mail_by_you"):D[0];S=S+" "+Se("im_admin_link",{name:L,href:D[1]})}p+=Se("im_mess_stack",{photo:j.photo,href:I,cls:"",date_attr:"",link:`/im?sel=${t.peerId}&msgid=${t.messageId}`,name:he(T),stack_name:T,peerId:f,date:S,messages:l,admin:t.kludges.from_admin||0})}Object(v.toArray)(ue(p)).forEach(e=>n&&n.appendChild(e))}else g&&e.peer===t.peerId&&!c.inplaceSearch&&Object(s.isOut)(t)&&Un(e,n,t.peerId),Oe("_im_stack_messages",_).appendChild(oe(l));return Object(s.isOut)(t)&&!a&&setTimeout(()=>{var e=Oe("_im_mess_"+t.messageId,n);Ie(e,P)&&ke(e,"im-mess_sending")},500),d=d.filter(e=>e.rid!==t.randomId),vt(n),wt(d,e,n)}function wt(e,t,n){var r;return(r="object"==typeof e?e:t.imQueue(e,!1)).length>0&&r.map(e=>(e.mess.failed=!!e.failed,e.mess)).filter(e=>Object(o.getMessage)(t,e.peerId,e.messageId)).forEach(e=>Ot(t,e,n,!1)),n}function kt(e,t,n){var r=e.tabs[t];return Object(v.toArray)(ye("_im_mess_unread",n)).forEach(e=>{var t=le(ve(e,"msgid"));t>0&&r.out_up_to>=t&&(je(e,"_im_mess_unread"),je(e,"im-mess_unread"),function(e){var t=Oe("_im_mess_blind_unread_marker",e);t&&(t.removeAttribute("aria-label"),t.removeAttribute("role"),t.removeAttribute("tabindex"))}(e))}),n}function jt(e,t,n){var r=t.peerId,i=t.messageId,a=Oe("_im_msg_reply"+i,e),o=Oe("_im_msg_media"+i,e),s=n.tabs[r].mediacontent[i][0];return a&&(a.innerHTML=s[0]),o&&(o.innerHTML=s[1]),e}function Et(e,t){if(!Object(o.isFullyLoadedTab)(t,e.peerId))return 0;var n=t.tabs[e.peerId];return n.msgs[e.messageId]?1:n.msgs["rid"+e.randomId]?2:0}function It(e){return e>19e8&&e<2e9}function Tt(e,t){return e===t.peer}function At(e,t){return Object(j.doesChatTabHaveFlag)(Object(o.getTab)(e,t),1024)}function Ct(e,t){return!!e.tabs[t]}function St(e,t){return!!Ct(e,t)&&null!==e.tabs[t].lastmsg}function Pt(e,t){return 1e3*e+1e3*t.timeshift}function Mt(e,t,n,r,i){if(Object(s.getUserId)(t)!==Object(s.getUserId)(n))return!0;var a=Pt(t.date,r),c=Pt(n.date,r);return!Fe(a,c)||(!(!Object(o.isCommunityInterface)(r)||le(t.kludges.from_admin)===le(n.kludges.from_admin))||(n.date-t.date>300||(!(!Object(s.isServiceMsg)(t)&&!Object(s.isServiceMsg)(n))||(!(!Object(s.isCallMessage)(n)&&!Object(s.isCallMessage)(t))||(!(!Object(s.isGift)(t)&&!Object(s.isGift)(n))||(!(!Object(s.isGraffiti)(t)&&!Object(s.isGraffiti)(n))||(!!Object(s.hasReply)(n)||!(Object(s.isUnread)(e,t)===Object(s.isUnread)(e,n)||!i||Object(s.isOut)(n)||ln(n.peerId,r.gid)))))))))}function Dt(e,t){return De(1e3*e,"{hour}:{minute} {am_pm}",1e3*t,[],!0)}function Lt(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=Math.round(1e9*Math.random()).toString(16),s={},u=0;return t=(t=Object(c.replaceHyperLinks)(t||"",c.linksReplacer.bind(null,r))).replace(/(<a.+?<\/a>)/gi,e=>{var t=`!link_${u}_${a}!`;return s[t]=e,u++,t}),t=Object(c.replaceMentions)(t),t=Object(c.replaceEmailLinks)(t),t=Object(c.replaceHashtags)(t,t=>{var n=Object(o.getGroupId)(e);return`<a href="/${n?"gim"+n:"im"}?sel=${i||Object(o.getPeer)(e)}&st=${encodeURIComponent(t)}">${t}</a>`}),Object.keys(s).forEach(e=>{t=t.replace(e,()=>s[e])}),n.emoji&&(t=We.emojiToHTML(t,!0)),t}function xt(e){return Object(u.isChatPeer)(e)?"c"+(e-2e9):e<-2e9?"e"+Math.abs(e+2e9):It(e)?"mr"+(e-19e8):e}function Rt(e){switch(e.substr(0,1)){case"e":return-2e9-le(e.substr(1));case"c":return 2e9+le(e.substr(1));default:return le(e)}}function Nt(e){return e>9999999?Math.floor(e/1e6)+"M":e>9999?Math.floor(e/1e3)+"K":e>0?e.toString():""}function Ft(e,t){return{search:{name:Pe("mail_im_peer_search"),icon:"search"},block_community:{icon:"block",name:Pe("mail_block_comm_messages")},block_notify:{icon:"block",name:Pe("mail_block_notify_messages")},allow_community:{icon:"unblock",name:Pe("mail_allow_comm_messages")},clear:{name:e.peer<-2e9?Pe("mail_im_delete_email_contact"):Pe("mail_im_delete_all_history"),icon:"clear"},chat:{name:Pe("mail_im_create_chat_with"),icon:"invite"},mute:{name:Pe("mail_im_mute"),icon:"mute"},unmute:{name:Pe("mail_im_unmute"),icon:"unmute"},photos:{name:e.gid?Pe("mail_im_show_media_history_group"):Pe("mail_im_show_media_history"),icon:"media"},avatar:{icon:"avatar",name:Pe("mail_update_photo_red")},block:{icon:"block",name:Pe("mail_block_user")},invite:{icon:"invite",name:Pe("mail_im_create_chat_with")},invite_link:{icon:"invite-link",name:Pe(t?"mail_vkcomgroup_invite_link":"mail_chat_invite_link")},leave:{icon:"leave",name:Pe(t?"mail_leave_channel":"mail_leave_chat")},topic:{icon:"topic",name:Pe("mail_change_topic")},return:{icon:"return",name:Pe(t?"mail_return_to_vkcomgroup":"mail_return_to_chat")},pin_hide:{icon:"pin_hide",name:Pe("mail_menu_pin_hide")},pin_unhide:{icon:"pin_unhide",name:Pe("mail_menu_pin_show")},unpin:{icon:"unpin",name:Pe("mail_menu_unpin")},settings:{icon:"settings",name:Pe(t?"mail_vkcomgroup_settings":"mail_settings")}}}function Bt(e,t){var n=`<img src="${e}" alt="" class="dialogs_inline_chatter dialogs_inline_chatter_half"/>`;return t&&(n=Se("im_dialogs_link",{href:t,photo:n})),`<div class="im_grid">\n    <div class="dialogs_inline_chatter dialogs_inline_chatter_half">\n      ${n}\n    </div>\n  </div>`}function Ht(e,t){var n=`<img src="${e}" alt="" class="dialogs_inline_chatter"/>`;return t&&(n=Se("im_dialogs_link",{href:t,photo:n})),`<div class="im_grid">\n    <div class="dialogs_inline_chatter">\n      ${n}\n    </div>\n  </div>`}function Gt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if("string"==typeof e)return`<div class="im_grid"><img src="${e}" alt=""/></div>`;switch(e.length){case 1:return`<div class="im_grid"><img src="${e[0]}" alt=""/></div>`;case 2:return e.map((e,n)=>Bt(e,t[n])).join("");case 3:return Bt(e[0],t[0])+e.slice(1).map((e,n)=>Ht(e,t[n+1])).join("");case 4:return e.map((e,n)=>Ht(e,t[n])).join("")}}function Ut(e,t,n){if("string"==typeof t.photo&&t.photo)return`<div class="im_grid"><img src="${t.photo}" alt=""></div>`;if(Object(u.isChatPeer)(t.peerId)&&t.membersCount<2)return`<div class="im_grid"><img src="${e.get().default_chat_photo}" alt=""></div>`;if(Array.isArray(t.photo))return Gt(t.photo);var r=t.data.active.slice(0,4).map(y.oCacheGet.bind(null,e)).filter(e=>!!e);return Gt(r.map(e=>e.photo),n?[]:r.map(e=>e.link))}function qt(e){var t=e.get().gid?Pe("mail_search_only_messages_comm"):Pe("mail_search_only_messages");return`<li class="im-page--mess-search-w">\n    <div class="im-page--mess-search ${te}">\n      <button type="button" class="im-i--messages-search"></button>${t}\n    </div>\n  </li>`}function zt(){return`<li class="im-search-results-head">${Pe("mail_search_messages")}</li>`}function $t(){return`<li class="im-search-results-head">${Pe("mail_search_conversations_sep")}</li>`}function Vt(){return`<li class="im-search-results-head">${Pe("mail_search_dialogs_sep")}</li>`}function Wt(){return`<li class="im-search-results-head _im_recent_bar">\n    ${Pe("mail_recent_searches")}\n    <button type="button" class="${Z} im-page--clear-recent">${Pe("mail_clear_recent")}</button>\n  </li>`}function Yt(e){var t=e.get().popular_sugg,n=Object(o.isClassicInterface)(e)?8:5;return t.length>n&&(t=t.slice(0,n)),'<li class="im-popular clear_fix">'+t.map(t=>{var n=t.peerId,r=Object(y.oCacheGet)(e,n)||t,i=e.get().tabs[n]||t,a=(e.get().mutedPeers||[]).indexOf(n)>=0;return`<div class="${["im-popular--item","fl_l","_im_dialog","_dont_add_recent","_im_sugg_"+n,i.unread>0&&"sugg-is_unread",a&&"sugg-is_muted"].filter(e=>!!e).join(" ")}" data-peer="${n}">\n    <a class="im-popular--avatar-w ${$e(i.online)}" href="${r.link}"><img class="im-popular--avatar" src="${r.photo}"/></a>\n    <div class="im-popular--name-w"><a class="im-popular--name" href="${r.link}">${r.first_name||r.name}</a></div>\n    <span class="im-popular--unread _sugg_unread_ct">${Nt(i.unread)}</span>\n</div>`}).join("")+"</li>"}function Kt(e,t,n){var r=Oe("_im_mess_"+t.messageId,n);if(r){Te(r,"aria-hidden","false"),ke(r,`im-mess_failed ${M}`);var i=Oe("_im_mess_marker",r);Te(i,"aria-label",Pe("mail_send_message_error")),Te(i,"role","link")}return n}function Qt(e,t,n){var r=Oe("_im_mess_"+t,n);if(r){je(r,"im-mess_failed"),Te(r,"aria-hidden","true"),je(r,M);var i=Oe("_im_mess_marker",r);Te(i,"aria-label",""),Te(i,"role","")}return n}function Xt(e,t){return Jt(e.map(e=>Oe("_im_mess_"+e,t)).filter(e=>e),t)}function Jt(e,t){var n=e.filter(e=>!Ie(e,"im-mess_srv")).map(e=>e.parentNode);return e.forEach(e=>{Ie(e,"im-mess_srv")?e.parentNode.parentNode.removeChild(e.parentNode):e.parentNode.removeChild(e)}),n.filter(e=>0===pe(e).length).map(e=>we("_im_mess_stack",e)).forEach(e=>{Ie(fe(e),"_im_bar_date")&&se(fe(e)),Ie(fe(e),"_im_unread_bar_row")&&se(fe(e)),se(e)}),t}function Zt(e){for(var t=e;t;){var n=t;if(null===(t=t.previousElementSibling)){Ie(n,"mess_srv")&&(t=n.parentNode);var r=we("_im_mess_stack",n);r&&(t=r.previousElementSibling,1===pe(n.parentNode).length&&r.parentNode.removeChild(r))}Ie(n,"_im_unread_bar_row")||n.parentNode.removeChild(n)}}function en(e,t,n,r){return e.map(e=>Oe("_im_mess_"+e,r)).filter(e=>e).forEach(e=>{Ce(e,function(e,t,n){var r=t.innerHTML;return`<div class="im-mess--text">\n    ${Pe("delete"===n?"mail_deleted_stop":"mail_marked_as_spam")} <button type="button" data-peer="${e}" class="${L} im-mess--btn">${Pe("mail_restore")}</button>\n    <div class="${D} im-mess--original">${r}</div>\n  </div>`}(t,e,n)),ke(e,"im-mess_light")}),r}function tn(e,t,n){var r=Oe("_im_mess_"+e,n);if(r){var i=Oe(D,r);Ce(r,i.innerHTML),je(r,"im-mess_light")}return n}function nn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2;if(arguments.length>5&&void 0!==arguments[5]&&arguments[5])return an(e,t,n,r,!0,i);var a=an(e,t,n,r,!1,i);return a.length>60?an(e,t,n,r,!0,i):a}function rn(e){var t={[l.ACTIVITY_TYPE_TYPING]:1,[l.ACTIVITY_TYPE_RECORDING_AUDIO]:2},n=Object.keys(e).sort((e,n)=>t[n]-t[e]),r={},i=n.reduce((t,n)=>{var i=(e[n]||{}).userIds;return(void 0===i?[]:i).forEach(e=>{r[e]||(r[e]=!0,t[n]=!0)}),t},{}),a=n.filter(e=>!!i[e]);return a.length>1?"":a[0]}function an(e,t,n,r,i,a){var s=function(e,t,n){var r=[],i={};return Object.keys(t).map(n=>{((t[n]||{}).userIds||[]).forEach(t=>{Object(y.oCacheExists)(e,t)?parseInt(t,10)!==e.id&&(i[t]=n):r.push(t)})}),r.length&&Object(l.loadChatMember)({[n]:r},e),Object.keys(i).sort((e,n)=>t[i[e]].ts-t[i[n]].ts)}(r,e,t);if(0===s.length)return"";var c=Object(u.isUserPeer)(t)||Object(o.isCommunityPeer)(t)?"first_name":i?"short_name":"name",d=rn(e),_="";d===l.ACTIVITY_TYPE_RECORDING_AUDIO?_=Pe("mail_recording_audio_several",s.length):d===l.ACTIVITY_TYPE_TYPING&&(_=Pe("mail_typing_several",s.length));var h=s.slice(0,Math.min(s.length-1,a)),g=h.map(e=>Object(y.oCacheGet)(r,e)[c]).join(", ");if(s.length>a+1){var f=function(e){var t={};return Object.keys(e).forEach(n=>{var r=e[n].userIds;(void 0===r?[]:r).forEach(e=>{t[e]=1})}),Object.keys(t).length}(e);g+=" "+Pe("mail_and_peer").replace("{count}",f-a).replace("{typing}",_)}else{if(s.length>1&&(g+=` ${Pe("mail_and_peer_one")}`),!Object(u.isChatPeer)(t)&&n)g+=` ${_}`;else g+=` ${Object(y.oCacheGet)(r,s[h.length])[c]} ${_}`}return g.trim()}function on(){return`<div class="im-page--chat-search-empty">\n    ${Pe("mail_im_search_empty")}\n  </div>`}function sn(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return n?`<a class="im_srv_lnk ${r}" target="_blank" rel="noopener" href="${e}">${t}</a>`:`<span class="${r}">${t}</span>`}function cn(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=t.kludges,a=i.source_act,o=le(i.source_mid),s=t.userId,c=Object(y.oCacheGet)(e,s),u="",d=s===o;switch(a){case F:u="mail_im_chat_created";break;case B:u=i.source_is_channel?"mail_im_title_updated_channel":"mail_im_title_updated_dot";break;case H:u=d?"mail_im_returned_to_chat":"mail_im_invited";break;case G:u=d?"mail_im_left":"mail_im_kicked_from_chat";break;case U:u="mail_im_photo_set";break;case q:u=i.source_is_channel?"mail_im_photo_removed_channel":"mail_im_photo_removed";break;case z:u=i.source_message?"mail_im_pin_message":"mail_im_pin_message_empty2";break;case $:u=i.source_message?"mail_im_unpin_message":"mail_im_unpin_message_empty2";break;case V:u="mail_im_invite_by_link";break;default:return"mail_no_support"}if(u=(u=Me(c.sex,Pe(u,"raw"))).replace("{from}",sn(c.link,c.name,r)),o&&o!==s){var l=i.source_email;if(l)u=u.replace("{user}",sn(`/im?email=${encodeURIComponent(l)}`,"email",r));else{var _=Object(y.oCacheGet)(e,o),h=a===G?_.inv_name:_.kick_name;u=u.replace("{user}",sn(_.link,h,r))}}if(i.source_text){var g=i.source_old_text?`«<b class="im_srv_lnk">${i.source_old_text}</b>» &rarr; `:"";u=u.replace("{title}",g+`«<b class="im_srv_lnk">${i.source_text}</b>»`)}if(i.source_act===z||i.source_act===$)if(i.source_message){var f=sn("",dn(We.emojiToHTML(he(i.source_message.replace(/<br\s?\/?>/gi," ")),!0)),!1,"im_srv_mess_link");u=u.replace("{msg}",f)}else u=u.replace(/{link}(.+){\/link}/i,(e,t)=>sn("",t,!1,"im_srv_mess_link"));return u}function un(e,t,n,r){if(t===U){var i=Oe("_im_mess_"+e.messageId,r);if(i){var a=n.tabs[e.peerId];i.parentNode.innerHTML=Se("im_msg_row",{msg_id:e.messageId,from_id:e.peerId,text:cn(n,e,a)+n.chat_photo_msg,ts:e.date,cls:"im-mess_srv _im_mess_srv"})}}return r}function dn(e){return e.replace(/&lt;&lt;/g,"&laquo;").replace(/&gt;&gt;/g,"&raquo;").replace(/ \-\-/g," &mdash;").replace(/\-\- /g,"&mdash; ").replace(i.MENTION_RAW,"$1$4")}function ln(e,t){return!t&&e===ie.id}function _n(e,t){return ze(e,{url:Object(o.isCommunityPeer)(t)?"al_groups.php":"al_profile.php",params:{act:"verified_tt",mid:t,gid:t},slide:15,ajxdt:200,showdt:200,hidedt:200,dir:"auto",shift:[94,7,7],className:"verified_tt"})}function hn(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bottom",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=oe(Se("im_preloader",{preloader:ce(ie.pr_tpl,{id:""}),cls:["bottom"===n?"im-preloader_bottom":"im-preloader_top",r].join(" ")})),a=!1;function o(){a=!0,je(i,"im-preloader_visible"),i.parentNode&&i.parentNode.removeChild(i)}setTimeout(()=>{a||("bottom"===n?e.appendChild(i):e.insertBefore(i,ge(e)),ke(i,"im-preloader_visible"))},0),t.then(o).catch(e=>{Object(k.imWeirdCatch)("wrapLoading",e),o()})}}function gn(e,t){return{0:{msgs:e.reduce((e,t)=>(e[t]=[t,r.FLAG_IMPORTANT,0,0,"",{},{},0,0,0],e),{}),hash:t,history:1}}}function fn(e,t){if(!t&&!e)return!1;var n=e.target||e.srcElement,r=Ze,i=!1,a=/_im_mess|im_log_act|im_log_ract|_im_log_body|im_log_rspacer|_im_graffiti_w|_wall_post_cont/;do{if(!n||n.onclick||n.onmousedown||"A"==n.tagName||Ie(n,"_im_no_select")||Ie(n,"im_msg_media_link")||"IMG"==n.tagName&&!Ie(n,"_im_graffiti")&&!Ie(n,"emoji")&&!Ie(n,"emoji_css")&&!Ie(n,"im_gift")||"TEXTAREA"==n.tagName||Ie(n,"play_new")||Ie(n,"videoplayer")||(i=a.test(n.className)))break}while(r--&&(n=n.parentNode));return!i||!!_e((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||"").toString())}function mn(e,t){return`<div class="im-mess--text">\n      <span>${Pe("mail_restored")}</span>\n      <a class="_im_go_to" href="/im?sel=${xt(e)}&msgid=${t}">${Pe("mail_im_goto_conversation")}</a>\n    </div>`}function pn(e,t,n){var r=Pe("mail_deleteall1"),i=Pe("mail_sure_to_delete_all"),a=Pe("mail_delete");return Object(u.isChatPeer)(t)&&(Object(j.doesChatTabHaveFlag)(e,1024)?(r=Pe("mail_leave_channel"),i=Pe("mail_unfollow_channel_confirmation"),a=Pe("mail_unfollow_channel")):i=Pe("mail_chat_sure_to_delete_all")),Object(o.isCommunityPeer)(t)&&(i=Pe("mail_group_sure_to_delete_all")),Ue(r,i,a,n,Pe("global_cancel"))}function bn(e,t,n){var r=Object(o.getTab)(e,t),i=Object(u.isChatPeer)(t),a=i&&Object(j.doesChatTabHaveFlag)(r,1024),s=i&&Object(o.tabIsMessageRequestToChat)(r),c=Pe("mail_deleteall1"),d=Pe("mail_sure_to_delete_all"),l=Pe("mail_delete");if(i){if(r.data.closed||r.data.kicked)return pn(r,t,n.bind(null,!0));a?(c=Pe("mail_leave_channel"),d=Pe("mail_vkcomgroup_leave_confirm"),l=Pe("mail_leave_channel")):s?(c=Pe("mail_reject_mr_confirmation_title"),d=Pe("mail_reject_mr_confirmation_text"),l=Pe("mail_message_request_reject")):(c=Pe("mail_leave_chat"),d=Pe("mail_chat_leave_confirm"),l=Pe("mail_leave_chat"))}Object(o.isCommunityPeer)(t)&&(d=Pe("mail_group_sure_to_delete_all"));var _=new MessageBox({title:c,width:a?450:500}).content(d).setButtons(l,()=>n(!!isChecked(Oe("_check_is_delete"))||!i),Pe("global_cancel")).show();return!i||a||s||_.setControlsText(`<div class="checkbox im-delete-forall-checkbox _check_is_delete" onclick="checkbox(this);" role="checkbox" aria-checked="false">${Pe("mail_deleteall1")}</div>`),_}function vn(e){return Ue(Pe("mail_unpin_title"),Pe("mail_unpin_text"),Pe("mail_unpin"),e,Pe("global_cancel"))}function yn(e,t,n,r){var i=Pe("mail_dialog_msg_delete_N",t),a=Ue(Pe("mail_dialog_msg_delete_title"),i,Pe("mail_delete"),()=>r(isChecked(Oe("_check_forall"))),Pe("global_cancel")),o="",s=!1;return n&&(o=`<div class="checkbox im-delete-forall-checkbox _check_forall" onclick="checkbox(this);" role="checkbox" aria-checked="false">${Pe("mail_delete_for_all")}</div>`,s=cur.imDb.selectByKey("del_forall_checked")),a.setControlsText(o),s&&checkbox(Oe("_check_forall")),a}function On(e,t,n,r,i){t.showProgress(),e.set(r.bind(null,i)).then(()=>{t.hideProgress(),t.hide(),n().removePeer(e,i),n().updateDialogFilters(e)})}function wn(e,t,n,r){var i=e.get().tabs[t].memberIds;e.set(r.bind(null,"add_member",i)).then(n().showCreation)}function kn(e,t,n){var r=e.get();if(r.active_tab===i.FOLDER_ALL&&0===r.dialog_tab_cts.mr)return!1;var a=r.active_tab===i.FOLDER_MESSAGE_REQUEST?i.FOLDER_ALL:i.FOLDER_MESSAGE_REQUEST;return e.set(n.bind(null,a)).then(e=>{t().restoreDialogs(e,!0)})}function jn(e,t,n){if(e.get().active_tab===i.FOLDER_ALL&&0===e.get().unread_cnt)return!1;var r=e.get().active_tab===i.FOLDER_UNREAD?i.FOLDER_ALL:i.FOLDER_UNREAD;return e.set(n.bind(null,r)).then(e=>{t().restoreDialogs(e,!0)})}function En(e,t,n,r){if(t.get().active_tab===e)return Promise.resolve(t);var i=Object(o.isReversedDialogs)(t);return t.set(r.bind(null,e)).then(e=>(n().restoreDialogs(e,!0,i!==Object(o.isReversedDialogs)(e)),e))}function In(e,t){void 0===t&&(t=e.get().peer);var n=e.get().tabs[t];return i.FOLDER_MASKS[i.FOLDER_IMPORTANT]&n.folders}function Tn(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===t&&(t=e.get().peer),!Object(o.isFoldersAvailable)(e))return!1;var r=n||e.get().tabs[t];return i.FOLDER_MASKS[i.FOLDER_UNRESPOND]&r.folders}function An(e,t){return!1===((t.get().block_states||{})[e]||{}).free}function Cn(e){return null!=e.get().pendingForward}function Sn(e,t){return(t.get().block_states[e]||{}).who===ie.id}function Pn(e,t){var n=e.get().block_states;Object.keys(n).forEach(i=>{n[i].time?!1===n[i].free&&Date.now()-n[i].time>=5e4&&t.push([r.mutexEvent([,1,"gim"+e.get().gid,i,0,""])]):n[i].time=Date.now()})}function Mn(e,t,n){var r;return!qe("al_im.php",{act:"a_spam",offset:"0",gid:e.get().gid},{onDone:(n,i)=>{i&&(r=t(n,e,i))},params:{width:638,onHide:()=>{Ve.loaded&&Ve.detachPlayer(!0),r.unmount()}}},n)}function Dn(e,t){return Ln(e.get(),t,Object(o.getTab)(e,t).last_seen)}function Ln(e,t,n,r){if(n.platform)return Pe("mail_header_online_status")+(n.mobile?xn(t,!1,!1,!0):"");if(!n.can_see){var i=Object(y.oCacheGet)(e,t),a=i||e.tabs[t];return function(e,t){var n;switch(e){case I:n=getLang("global_online_was_recently","raw");break;case T:n=getLang("global_online_was_week","raw");break;case A:n=getLang("global_online_this_month","raw");break;case C:n=getLang("global_online_long_ago","raw");break;default:return""}return langSex(t,n)}(n.status,a.sex)}if(!n.time||Date.now()-1e3*n.time>7776e6)return"";var o=xe(n.time,e.timeshift),s=Me(Object(y.oCacheGet)(e,t).sex,Pe("mail_last_activity_tip","raw")).replace("{user}","").replace("{time}",o);return n.mobile&&(s+=xn(t,!1,!1,r)),s}function xn(e,t,n,r){var i={mid:e};n||(i.was=1),t?i.forcetoup=!0:i.forcetodown=!0,i=Object.assign(i,r);var a=JSON.stringify(i).slice(1,-1).replace(/"/g,"&quot;");return Se("im_wrap_mobile",{class:"im_status_mob_onl",params:a})}function Rn(e,t){var n=t.get().tabs[e];return Ge("al_settings.php",{act:"blacklist_box",q:n.href},{stat:[jsc("web/settings.js"),"settings.css"],dark:1})}function Nn(e,t){return Ge("groupsedit.php",{act:"bl_edit",name:"/id"+e,gid:t.get().gid},{stat:["page.css","ui_controls.js","ui_controls.css"],dark:1})}function Fn(e){return e.get().gid?"/gim"+e.get().gid:"/im"}function Bn(e,t,n,r){var i;ir(qe("al_im.php",{act:"a_important",offset:"0"},{onDone:(r,a)=>{a&&(i=n(r,e,t,a))},params:{width:638,onHide:()=>{Ve.loaded&&Ve.detachPlayer(!0)},onDestroy:()=>{i&&i.unmount()}}},r),e)}function Hn(){var e=document.activeElement;return null!==e&&("INPUT"===e.tagName||"TEXTAREA"===e.tagName||e.getAttribute("contenteditable"))}function Gn(e,t,n){var r=Oe("_im_mess_"+e,n);return r&&Ee(r,"im-mess_fav",t),n}function Un(e,t,n){var r=Oe("_im_unread_bar_row",t);if(!r)return t;var i=be(r,"._im_mess_stack",-1),a=be(r,"._im_mess_stack"),s=i?ye("_im_mess",i).pop():null,c=a?Oe("_im_mess",a):null;if(se(r),gt(t),!c||!s)return t;var u=ve(c,"msgid"),d=Object(o.getPreviousMessage)(e,n,u),l=Object(o.getMessage)(e,n,u);if(!d||Mt(e.tabs[n],d,l,e))return t;var _=Oe("_im_stack_messages",i),h=Oe("_im_stack_messages",a).children;return Object(v.toArray)(h).forEach(e=>{se(e),_.appendChild(e)}),se(a),t}function qn(e,t,n){var r=Object(o.getFirstUnread)(e,e.get().peer);if(!r)return[!1,0];var i=Oe(`_im_mess_${r}`,t);if(!i){var a=Object(o.getLastMessage)(e,e.get().peer,r);if(!a)return[!0,0];i=Oe(`_im_mess_${a.messageId}`,t)}var s=Ie(i,"_im_mess_srv")?i:we("_im_mess_stack",i);if(!s)return[!0,0];var c=i?i.offsetTop:0,u=s.offsetTop+c,d=n.contHeight();return u<=n.scrollTop()+n.getScrollHeight()?[!0,0]:[!1,Math.max(0,d-u)]}function zn(e,t,n){Qe(t);var r=we("_im_top_notice",n);Ke(r,200,se.pbind(r));var i=we("_im_page_dialogs",r);i&&Ie(i,"im-page--dialogs-notice")&&je(i,"im-page--dialogs-notice"),He.post("al_im.php",{act:"a_hide_top_notice",type:r.getAttribute("data-type"),hash:r.getAttribute("data-hash")})}function $n(e,t,n){Qe(t);var r=we("_im_aside_notice",n);Ye(r,200,se.pbind(r)),He.post("al_im.php",{act:"a_hide_top_notice",type:r.getAttribute("data-type"),hash:r.getAttribute("data-hash")})}function Vn(e,t){Qe(e);var n=we("_im_aside_promo_block",t);Ye(n,200,se.pbind(n)),He.post("al_im.php",{act:"a_hide_promo_block",type:n.getAttribute("data-type"),hash:n.getAttribute("data-hash")})}function Wn(e,t){we("_im_aside_promo_block",t).classList.add("--action-called"),He.post("al_im.php",{act:"a_vkadmin_app_install",hash:ve(t,"hash"),platform:ve(t,"platform")})}function Yn(e){return e.length>1?function(e){return[].concat(e).sort((e,t)=>"mail"!==e.type?"mail"===t.type?-1:1:0)}(e):e}function Kn(e,t,n,r,i){if(n=n.replace(/\<br\s*\/?\>(\n)?/gi," ").replace(/[\n\r]/gi," "),n=Object(c.replaceMentions)(n,(e,t,n,r,i)=>i),r&&(n=We.emojiToHTML(n,!0)),t&&"..."!==t.trim()&&!Object(u.isChatPeer)(e)&&(n=Se("im_topic",{topic:t,cls:"im-topic_dialog"})+n),!n&&i.length>0){var a=Yn(i);n=Se("im_dialog_media",{name:Qn(a[0],a)})}return n}function Qn(e,t){var n={photo:Pe("mail_added_photos","raw"),video:Pe("mail_added_videos","raw"),audio:Pe("mail_added_audios","raw")};switch(e.type){case"mail":var r=e.object?e.object.fwd_count:e.id.split(";").length;return Le(r,Pe("mail_fwd_msgs","raw"),!0);case"photo":case"video":case"audio":var i=t.filter(t=>t.type===e.type).length;return Le(i,n[e.type],!0);case"audio_playlist":return"audio_album"===e.kind?Pe("mail_added_audio_album"):Pe("mail_added_audio_playlist");case"artist":return Pe("mail_added_artist");case"doc":switch(e.kind){case"graffiti":return Pe("mail_added_graffiti");case"audiomsg":return Pe("mail_added_audiomsg");default:return Pe("mail_added_docs")}case"geo":case"map":return Pe("mail_added_geo");case"wall":return Pe("mail_added_wall");case"wall_reply":return Pe("mail_added_wall_reply");case"gift":return Pe("mail_added_gift");case"link":case"share":return Pe("mail_added_link");case"sticker":return Pe("mail_added_sticker");case"market":return Pe("mail_added_market_item");case"money_transfer":return Pe("mail_added_money_transfer");case"money_request":return Pe("mail_added_money_request");case"story":return Pe("mail_added_story");case"mask":return Pe("mail_added_mask");case"article":return Pe("mail_added_article");case"call":return Pe("mail_added_call");case"poll":return Pe("mail_added_poll");case"podcast":return Pe("mail_added_podcast");default:return Pe("mail_added_"+e.type)}return""}function Xn(e){ke(e,"im-send-btn_loading")}function Jn(e){je(e,"im-send-btn_loading")}function Zn(e){var t=e.get(),n=Object(o.getPinnedMessage)(e);if(!n||!Object(O.isPinnedMessageVisibleInTab)(e,Object(o.getPeer)(e)))return"";var r=Object(y.oCacheGet)(e,n.userId);if(!r)return"";var i=er(e,n);if(!i)if(!(i=n.text)&&n.attaches.length){var a=Yn(n.attaches);i=Se("im_pinned_message_media",{text:Qn(a[0],a)})}else i=Lt(e,i,n&&n.kludges||{})||"";return i=i.replace(/<br\s?\/?>/gi," "),Se("im_pinned_message",{date:Re(n.date,t.timeshift),content:i,link:r.link,name:r.name})}function er(e,t){var n="";if(t&&Object(s.isMoneyRequest)(t)&&void 0!==t.kludges.attach1_tr_amount){var r="%s "+t.kludges.attach1_currency;if("RUB"===t.kludges.attach1_currency&&(r=Pe("mail_money_amount_rub","raw")),t.kludges.attach1_total_amount){var i=Le(t.kludges.attach1_tr_amount/1e3,"%s",!0),a=Le(t.kludges.attach1_total_amount/1e3,r,!0);n=Pe("mail_money_request_collected_amount_from").replace("{amount}",i).replace("{total_amount}",a)}else{var o=Le(t.kludges.attach1_tr_amount/1e3,r,!0);n=Pe("mail_money_request_collected_amount").replace("{amount}",o)}if(le(t.kludges.attach1_held_amount)){var c=Le(t.kludges.attach1_held_amount/1e3,r,!0);n+=" "+Pe("mail_money_request_held_amount").replace("{amount}",c)}t.text&&(n+='<span class="divider"></span>'+Lt(e,t.text,t.kludges)),t.kludges.attach1_total_amount&&(n+=Se("im_pinned_message_media_bar",{percent:Math.min(100,Math.floor(t.kludges.attach1_tr_amount/t.kludges.attach1_total_amount*100))}))}return n}function tr(e,t,n){var r=n.getAttribute("data-info");r&&ze(n,{text:r,className:"_im_history_tooltip",appendParentCls:"_im_mess_stack",black:1,hidedt:1e3,shift:[0,4]})}function nr(e,t,n){var r=+n.getAttribute("data-time");r&&ze(n,{text:Pe("mail_message_edited")+" "+Re(r,e.get().timeshift),className:"_im_history_tooltip",appendParentCls:"_im_mess_stack",black:1,shift:[0,4]})}function rr(){var e=getSize(Oe(ne))[1];return e||(e=et),e}function ir(e,t){e.bodyNode.addEventListener("mouseover",e=>{Ie(e.target,"_im_edit_time")?nr(t,0,e.target):Ie(e.target,"_im_page_info")&&tr(0,0,e.target)})}function ar(e,t,n,r,i){var a,o=e.get();ir(qe("al_im.php",{act:"a_get_pinned_message_box",chat:n,gid:e.get().gid,hash:o.tabs[n].hash},{onDone:(n,i)=>{i&&(a=r(n,e,t,i))},params:{width:638,onHide:()=>{Ve.loaded&&Ve.detachPlayer(!0)},onDestroy:()=>{a&&a.unmount()}}},i),e)}function or(e,t,n){var r=e.get();ir(qe("al_im.php",{act:"a_get_replied_message_box",chat:r.peer,msgid:t,gid:r.gid,hash:r.tabs[r.peer].hash},{onDone:(e,t)=>{},params:{width:638,onHide:()=>{Ve.loaded&&Ve.detachPlayer(!0)},onDestroy:()=>{}}},n),e)}function sr(e,t){return!(!Object(u.isChatPeer)(e.peerId)||!e.memberIds)&&e.memberIds.indexOf(t)>=0}function cr(e){return!Object(u.isChatPeer)(e.peerId)||e.data.kicked?0:e.membersCount}function ur(e,t){var n=Object(y.oCacheGet)(e,t.peerId),r=Object(o.getTab)(e,t.peerId)||{};return n&&(t.photo=t.photo||n.photo,t.name=t.name||n.name,t.href=t.link||n.link,t.sex=t.sex||n.sex),t.last_touched=r.last_touched||0,t.verified=!!t.verified,t.lastmsg=t.lastmsg||t.lastmsg_meta&&t.lastmsg_meta[0]||!1,t.folders=t.folders||null,t.unread=t.unread||0,t.last_seen=t.last_seen||{platform:0,time:0,mobile:0,can_see:0},t.online=t.last_seen&&t.last_seen.platform||0,t.out_up_to=null!=t.out_up_to?t.out_up_to:t.in_up_to||0,Object(u.isChatPeer)(t.peerId)&&(t.memberIds=t.memberIds||r.memberIds||null),t}function dr(e,t){for(var n in t)t.hasOwnProperty(n)&&ur(e,t[n])}function lr(e,t){var n=[],r=t.find(e=>"mail"===e[0]),i=r?r[1].split(";"):[];for(i.length>Je&&(r[1]=i.slice(0,Je).join(";"));e.length>Xe;){var a=e.substr(0,Xe).lastIndexOf(" ");-1==a&&(a=Xe),n.push({msgText:_e(e.substr(0,a))}),e=_e(e.substr(a))}for(e.length&&n.push({msgText:e,attaches:t}),n.length||n.push({attaches:t}),i=i.slice(Je);i.length;i=i.slice(Je))n.push({attaches:[["mail",i.slice(0,Je).join(";")]]});return n}function _r(e){return e.length>Xe}function hr(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=Object.assign(function(e,t){if(t)return{chat_id:e.invite_chat_id,hash:e.invite_hash};return e}(t,r),{act:"a_chat_preview"}),o=!1;Ge("al_im.php",a,{stat:["boxes.css"],params:{dark:1,hideButtons:!0,onHide(){e.set(n),o&&o.unmount()}},onFail:e=>(setTimeout(()=>Ue(Pe("global_error"),e),0),!0),onDone(t){o=b(t.bodyNode,e,i)}},{})}function gr(){Ue(Pe("global_error"),Pe("mail_message_wait_until_uploaded"))}function fr(e,t){var n=Object(o.getTab)(e,t.peerId)||{},r=e.get(),i=Object(u.isChatPeer)(t.peerId)&&Object(j.isUserAdminInChat)(n,r.id),a=Object(u.isChatPeer)(t.peerId)&&Object(j.isUserAdminInChat)(n,t.userId);if(!t)return!1;if(!Object(s.isOut)(t)&&(!i||a))return!1;if(333==t.peerId)return!1;if(Date.now()/1e3-t.date>86400)return!1;if(ct(e,t.peerId,t.messageId))return!1;if(Object(u.isChatPeer)(t.peerId)){if(n.data.kicked||n.data.closed)return!1}else if(n.block_error>0)return!1;return!0}function mr(e,t){var n=Object(o.getTab)(e,t),r=-1!==n.memberIds.indexOf(n.ownerId),i=r?[n.ownerId]:[];return(i=i.concat(n.memberIds.filter(t=>t!==n.ownerId&&Object(y.oCacheExists)(e,t)).slice(0,r?4:5))).map(t=>Object(y.oCacheGet)(e,t))}function pr(e,t){return t.map(t=>Object(y.oCacheGet)(e,t))}function br(e,t){return Object(o.getTab)(e,t).memberIds.reduce((t,n)=>{var r=Object(y.oCacheGet)(e,n);return t[r.id]=r,t},{})}function vr(e,t){if("number"!=typeof e||0===e)return"";var n,r=[[31536e3,Pe(t?"global_years_accusative":"global_age_years","raw")],[2592e3,Pe(t?"global_months_accusative":"global_age_months","raw")],[604800,Pe(t?"global_weeks_accusative":"global_age_weeks","raw")],[86400,Pe(t?"global_days_accusative":"global_age_days","raw")],[3600,Pe(t?"global_hours_accusative":"global_hours","raw")],[60,Pe(t?"global_minutes_accusative":"global_minutes","raw")],[1,Pe(t?"global_seconds_accusative":"global_age_seconds","raw")]],i=e,a=[];if(r.forEach(e=>{var t=S(e,2),n=t[0],r=t[1],o=Math.floor(i/n);i%=n,o>=1&&a.push(Le(o,r))}),1===(n=a.length))return a.pop();var o=a.slice(0,n-1).join(", "),s=a.pop();return Pe("global_and").replace(/{before}/gi,o).replace(/{after}/gi,s)}function yr(e,t,n,i){i&&!ct(e,n,i)&&(Object(o.getMessage)(e,n,i)?(e.setState({msgid:i}),Object(a.updateLocation)({msgid:i}),t()):e.get().longpoll.push([Object(r.changePeer)(n,i)]))}function Or(e){var t=Oe("im-mess_is_editing");if(!t)return null;var n=e.get().tabs[e.get().peer],r=Object(o.parserMessage)(n.msgs[ve(t,"msgid")]);return r&&r.peerId==e.get().peer?r:null}function wr(e,t){if(Object(o.isClassicInterface)(e)){var n=document.getElementById("ui_rmenu_mr");n&&(Object(o.existsIncomingMessageRequest)(e)?n.classList.remove("unshown"):n.classList.add("unshown"))}else t(e)}function kr(e){var t=Object(v.unpackStore)(e),n=Number(t.dialog_tab_cts[i.FOLDER_MESSAGE_REQUEST]),r=n>0?n:"",a=document.querySelector('._im_right_menu_counter[data-tab="mr"]');a&&(a.innerHTML=r)}function jr(){for(var e=curBox();e;)e.hide(),e=curBox()}function Er(e,t){return Pe("mail_invitation_sended_ago").replace("{when}",xe(e,t))}},S2bU:function(e,t,n){"use strict";n.r(t),n.d(t,"replaceHyperLinks",function(){return o}),n.d(t,"replaceEmailLinks",function(){return s}),n.d(t,"replaceMentions",function(){return c}),n.d(t,"replaceHashtags",function(){return l}),n.d(t,"linksReplacer",function(){return _});var r,i=n("h++7"),a=n("t7n3");function o(e,t){for(var n,r=0,a=e;null!==(n=i.MESSAGE_REGEXP.exec(e));){var o=(n=u(n))[0].length,s=n.index+o,c=e[n.index-1],l=e[s-1],_=void 0!==c&&/([\w\$А-Яа-яёЁєЄҐґЇїІіЈј\—\-\_@;.])/i.test(c),h=void 0!==l&&/([:;$])/i.test(l);if(!_&&!h){var g=d(n),f=g.domain.toLowerCase();if(f.length<=i.MAX_DOMAIN_LENGTH&&i.TOP_DOMAINS.includes(f)){var m=t(g);a=a.slice(0,n.index+r)+m+a.slice(s+r),r+=m.length-o}}}return a}function s(e,t){return e.replace(i.EMAIL,t||function(e){return'<a href="mailto:'+e+'">'+e+"</a>"})}function c(e,t){return e.replace(i.MENTION,t||function(e,t,n,r,i){return'<a href="/'+(t+n)+'" class="mem_link" mention="'+Object(a.clean)(r||"")+'" mention_id="'+Object(a.clean)(t+n)+'" onclick="return mentionClick(this, event)" onmouseover="mentionOver(this)">'+i+"</a>"})}function u(e){if(!e[0]||!e[6])return e;var t=e[0].length-1,n=e[6].length-1;return"."===e[0][t]&&"."===e[6][n]&&(e[0]=e[0].slice(0,t),e[6]=e[6].slice(0,n)),e}function d(e){return{full:e[0],protocol:e[1]||"http://",url:e[2],domain:e[4],query:e[6]||""}}function l(e,t){return e.replace((r||(r=new RegExp(i.RE_HASHTAG_EXTRACTION_PATTERN,"ig")),r),function(e,n,r,i,a){return(n||"")+t(r+(a||""))})}function _(e,t){var n=t.url,r=t.full,o=t.protocol,s=t.query,c=t.domain;try{r=decodeURIComponent(r)}catch(e){}if(r.length>55&&(r=r.substr(0,53)+".."),r=Object(a.clean)(r).replace(/&amp;/g,"&"),!e&&c.match(i.OUR_DOMAINS)){var u=n=Object(a.replaceEntities)(n).replace(i.ENTITIES,encodeURIComponent),d=n.indexOf("#/"),l="";d>=0?u=n.substr(d+1):(d=n.indexOf("#!"))>=0&&(u="/"+n.substr(d+2).replace(/^\//,""));var _=u.match(i.VK_DOMAIN);return _&&_[1].length<32&&(l=' mention_id="'+_[1]+'" onclick="return mentionClick(this, event)" onmouseover="mentionOver(this)"'),'<a href="'+function(e){return e.replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}(o+n+s)+'" target="_blank" rel="noopener"'+l+">"+r+"</a>"}var h=Object(a.replaceEntities)(n+s).toString();return'<a href="'+("away.php?utf=1&to="+encodeURIComponent(o+h))+'" target="_blank" rel="noopener" onclick="'+("return goAway('"+Object(a.clean)((o+n+s).replace(/'/g,"\\'"))+"', {}, event);")+'">'+r+"</a>"}},"T/g7":function(e,t,n){"use strict";n.r(t),n.d(t,"getLang",function(){return o});var r=n("nAFc"),i=n("4+be"),a={};function o(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,o="number"==typeof t,s=e+(t||o?".raw":"");if(void 0===a[s]){var c=t||o?Object(i.getLang)(e,"raw"):Object(i.getLang)(e);"string"==typeof c?a[s]=Object(r.decodeHTMLEntities)(c):Array.isArray(c)&&(a[s]=c.map(r.decodeHTMLEntities))}if(o){var u=t;return Object(i.langNumeric)(u,a[s],n)}return a[s]||""}t.default={getLang:o}},TBLV:function(e,t,n){"use strict";n.r(t);n("91GP"),n("ioFf"),n("rGqo"),n("Btvt");var r=n("q1tI"),i=(n("17x9"),n("pemR"));function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=e=>{var t=e.className,n=e.children,s=o(e,["className","children"]),c=Object(i.classNames)("Radio",t,{"Radio--disabled":e.disabled});return r.createElement("label",{className:c},r.createElement("input",a({className:"Radio__input Radio__visuallyHidden",type:"radio"},s)),r.createElement("span",{className:"Radio__control"}),Boolean(n)&&r.createElement("span",{className:"Radio__text"},n))};s.defaultProps={className:"",name:void 0,onChange:void 0,checked:void 0,defaultChecked:void 0,autoFocus:!1,disabled:!1,children:null},t.default=s},WbBG:function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},Wu9C:function(e,t,n){"use strict";n.r(t);var r=n("ofcU"),i=n("vT4u"),a=n("P13b");function o(e){return{unmount(){Object(r.destroyModule)(e)}}}function s(e,t,n,i){var s=Object(r.createMutations)(o).bindMutations,c=t=>{n().messageKeyboardButtonClick(t),e.hide()};return s(Object(r.createModule)({handlers:(t,n)=>{n(e.bodyNode,"click",a.MESSAGE_KEYBOARD_BUTTON_CLASS,c)}}))}var c=n("rHUl"),u=n("aong"),d=n("uytb");n.d(t,"isPinnedMessageVisibleInTab",function(){return h}),n.d(t,"pinnedMessageHide",function(){return g}),n.d(t,"pinnedMessageUnHide",function(){return f}),n.d(t,"pinnedMessageUnpin",function(){return m}),n.d(t,"mount",function(){return v});var l="_im_pin_hide",_="_im_pinned_message";function h(e,t){if(Object(u.unpackStore)(e).searchShown)return!1;var n=Object(c.getTab)(e,t),r=n&&Object(c.parserMessage)(n.pinned);return!!r&&n.pinHideId!=r.chat_local_id}function g(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=Object(c.getTab)(e,t),a=i&&Object(c.parserMessage)(i.pinned);i&&a&&(i.pinHideId=a.chat_local_id,cur.imDb.update(d.PIN_HIDDEN_ID_OP,[i.peerId,i.pinHideId]),p(n,t,e),re(geByClass1("_im_pinned_tt")),r&&window.Notifier&&Notifier.lcSend("pin_hide",{hide:1,peer:t}),statlogsValueEvent("im_pinned_messages","hide"))}function f(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=Object(c.getTab)(e,t);i&&i.pinHideId&&(delete i.pinHideId,cur.imDb.update(d.PIN_HIDDEN_ID_OP,[i.peerId,void 0]),p(n,t,e),r&&window.Notifier&&Notifier.lcSend("pin_hide",{hide:0,peer:t}),statlogsValueEvent("im_pinned_messages","show"))}function m(e,t,n){var r=p.bind(null,n,t),o=Object(a.showUnpinDialog)(()=>{o.hideProgress(),o.hide(),e.set(i.unpinMessageOptimistic.bind(null,t)).then(r).then(e=>e.set(i.unpinMessage.bind(null,t))).then(r)})}function p(e,t,n){return e().updateChatTopic(t,n),Object(i.setActions)(n.get()),e().updateActions(n),n}function b(e){return{unmount(){Object(r.destroyModule)(e)}}}function v(e,t,n){var i=Object(r.createMutations)(b).bindMutations,o=function(e,t,n){var r=e.get().peer,i=Object(c.parserMessage)(Object(c.getTab)(e,r).pinned);if(n.target.classList.contains(l))i&&g(e,r,t);else if("A"!==n.target.tagName){var o=i&&i.messageId;o&&!Object(a.isAlreadyDeleted)(e,r,o)?Object(a.focusOnMessage)(e,t().focusOnMessage,r,o):Object(a.showPinnedBox)(e,t,r,s,n),statlogsValueEvent("im_pinned_messages","open")}}.bind(null,t,n),u=function(e){showTooltip(e.target,{text:getLang("mail_hide_unpin_hover"),black:1,needLeft:1,shift:[8,4],forcetoup:!0,className:"_im_pinned_tt",appendEl:bodyNode})}.bind(null);return i(Object(r.createModule)({handlers:(t,n)=>{n(e,"click",_,o),n(e,"mouseover",l,u)}}))}},X3vJ:function(e,t,n){"use strict";n.r(t),n.d(t,"initGroupsMenu",function(){return k});n("a1Th"),n("Btvt"),n("rE2o"),n("ioFf"),n("rGqo"),n("KKXr");var r=n("D1OX"),i=n("Egk5"),a=n("XzvV"),o=n("zxIV"),s=n("/PiP"),c=n("Ia1d"),u=n("pp2G"),d=n("XuKo");function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var _=1,h=3,g=4,f=5,m=8,p=10,b=16,v=17,y=25,O=26,w=6441755;function k(e){window.onDomReady(function(){var t=ge("group_section_menu_gallery");if(t){var n=Object(o.geByClass)("ui_gallery_item",t),k={markOutside:!0};(!n||n.length<4)&&(k.scrollX=!1,k.scrollY=!1),Object(o.domQuery1)(".ui_gallery_item ._transparent",t)&&(k.scrollX=!1,k.scrollY=!1);var j=new r.UIGallery(t,k);(j?j.getItems():[]).forEach(t=>{var n=t.firstElementChild;if(n&&(Object(i.addEvent)(n,"click",t=>{var r=n.getAttribute("data-hash"),o=Number(n.getAttribute("data-id")),k=Number(n.getAttribute("data-type")),j=Number(n.getAttribute("data-pos")),E=n.getAttribute("data-object-id");if(r&&o&&k&&E&&(Object(a.statlogsValueEvent)("groups_menu_item_click",r,e,o,k,j),!Object(i.checkEvent)(t))){var I=null;switch(k){case _:var T={w:`wall${E}`};(I=n.getAttribute("data-click")?JSON.parse(n.getAttribute("data-click")):{}).reply&&(T.reply=I.reply),Object(s.showWiki)(T,!1,t);break;case f:Object(c.showVideo)(`${E}`,"",{autoplay:1},t);break;case b:-1===E.indexOf("_")?nav.change({z:`tag${E}`},t):nav.change({z:`album${E}`},t);break;case g:Object(s.showPhoto)(`${E}`,"",{},t);break;case h:Object(s.showWiki)({w:`product${E}`,from:"group_module"},!1,t,{queue:1});break;case m:case v:I=n.getAttribute("data-click")?JSON.parse(n.getAttribute("data-click")):{};var A=l(E.split("_"),2),C=A[0],S=A[1],P=I.access_hash;u.AudioUtils.showAudioPlaylist(C,S,P,void 0,t);break;case p:var M=l(E.split("_"),2),D=M[0],L=M[1];if(Number(D)===w)window.Groups.inviteToChat(-Number(L));else if((I=n.getAttribute("data-click")?JSON.parse(n.getAttribute("data-click")):{})&&I.forward){var x=I.forward.split("#");x=x?x[1]?x[1]:x[0]:"",Object(s.showWiki)({w:`app${E}#${x}`})}else Object(s.showWiki)({w:`app${E}`});break;case y:Object(s.showPodcast)(null,E);break;case O:Object(d.showNarrative)(E,{});break;default:return}Object(i.cancelEvent)(t)}}),Number(n.getAttribute("data-type"))===p)){var r=l(n.getAttribute("data-object-id").split("_"),1)[0];Number(r)===w&&Object(i.addEvent)(n,"mouseover",()=>{window.Groups.inviteToChatPreload()})}})}})}},bIHZ:function(e,t,n){"use strict";n.r(t),n.d(t,"updateLocation",function(){return a}),n.d(t,"updateLazyLocation",function(){return o});var r=n("t7n3"),i=window.nav;function a(e){var t=Object(r.extend)({},i.objLoc,e);Object.keys(t).filter(function(e){return""===t[e]}).forEach(function(e){delete t[e]});var n=i.toStr(t);i.setLoc(n)}function o(){var e={};return{scheduleNav:function(t){e=Object(r.extend)(e,t)},commitNav:function(){a(e),e={}},scheduleNavWithTimeOut:function(t,n){void 0===n&&(n=100),e=Object(r.extend)(e,t),setTimeout(function(){a(e),e={}},n)}}}},dV62:function(e,t,n){"use strict";n.r(t),n.d(t,"rootId",function(){return i}),n.d(t,"registerReactApplication",function(){return a}),n.d(t,"showComponentInBox",function(){return o}),n.d(t,"destroyComponentInBox",function(){return s});var r=n("i8i4"),i="react_root";function a(e,t){window.applicationInitFunctions[e]=t}function o(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n.onDestroy||(n.onDestroy=s),window.showFastBox(n),r.render(e,document.querySelector(".box_layout")),t=document.querySelector(".popup_box_container"),boxRefreshCoords(t)}function s(e){var t=document.querySelector(".box_layout");t&&r.unmountComponentAtNode(t);var n=window.curBox();n&&n.hide(e)}window.applicationInitFunctions||(window.applicationInitFunctions={}),window.initReactApplication=(e,t)=>{if(!window.applicationInitFunctions[e])throw new Error("Unknown react application to init");window.applicationInitFunctions[e](t)}},f01n:function(e,t,n){"use strict";n.r(t),n.d(t,"DELETE",function(){return a}),n.d(t,"SET_FLAGS",function(){return o}),n.d(t,"REPLACE_FLAGS",function(){return s}),n.d(t,"RESET_FLAGS",function(){return c}),n.d(t,"ADD_MESSAGE",function(){return u}),n.d(t,"READ_INBOUND",function(){return d}),n.d(t,"READ_OUTBOUND",function(){return l}),n.d(t,"GOT_ONLINE",function(){return _}),n.d(t,"GOT_OFFLINE",function(){return h}),n.d(t,"CHAT_CHANGED",function(){return g}),n.d(t,"CONVERSATION_UPDATED",function(){return f}),n.d(t,"TYPING",function(){return m}),n.d(t,"RECORDING_AUDIO",function(){return p}),n.d(t,"VIDEO_CALL",function(){return b}),n.d(t,"UNREAD_COUNT",function(){return v}),n.d(t,"NOTIFY_SETTINGS_CHANGED",function(){return y}),n.d(t,"EMPTY",function(){return O}),n.d(t,"RESET_DIRECTORIES",function(){return w}),n.d(t,"REPLACE_DIRECTORIES",function(){return k}),n.d(t,"SET_DIRECTORIES",function(){return j}),n.d(t,"RESYNC",function(){return E}),n.d(t,"REFRESH_LP_KEY",function(){return I}),n.d(t,"TRANSITION",function(){return T}),n.d(t,"RESET_PEER",function(){return A}),n.d(t,"MUTEX",function(){return C}),n.d(t,"CHANGE_PEER",function(){return S}),n.d(t,"CHANGE_TAB",function(){return P}),n.d(t,"FAILED_MESSAGE",function(){return M}),n.d(t,"RESEND",function(){return D}),n.d(t,"DELETE_DIALOG",function(){return L}),n.d(t,"EDIT_MESSAGE",function(){return x}),n.d(t,"REPLACE_MESSAGE",function(){return R}),n.d(t,"AUDIO_START",function(){return N}),n.d(t,"WAITING_FOR_RECONNECT",function(){return F}),n.d(t,"RECONNECTING",function(){return B}),n.d(t,"RECONNECTED",function(){return H}),n.d(t,"FLAG_UNREAD",function(){return G}),n.d(t,"FLAG_OUTBOUND",function(){return U}),n.d(t,"FLAG_IMPORTANT",function(){return q}),n.d(t,"FLAG_CHAT",function(){return z}),n.d(t,"FLAG_FRIENDS",function(){return $}),n.d(t,"FLAG_SPAM",function(){return V}),n.d(t,"FLAG_DELETED",function(){return W}),n.d(t,"FLAG_MEDIA",function(){return Y}),n.d(t,"FLAG_STEALTH",function(){return K}),n.d(t,"FLAG_HAS_REPLY",function(){return Q}),n.d(t,"FLAG_AUDIO_MESSAGE_LISTENED",function(){return X}),n.d(t,"FOLDER_IMPORTANT",function(){return J}),n.d(t,"FOLDER_UNRESPOND",function(){return Z}),n.d(t,"FOLDER_HAS_BANNER",function(){return ee}),n.d(t,"MAIL_CHAT_UPDATE_TYPE_TITLE_CHANGED",function(){return te}),n.d(t,"MAIL_CHAT_UPDATE_TYPE_AVATAR_CHANGED",function(){return ne}),n.d(t,"MAIL_CHAT_UPDATE_TYPE_ADMIN_GRANTED",function(){return re}),n.d(t,"MAIL_CHAT_UPDATE_TYPE_FLAGS_CHANGED",function(){return ie}),n.d(t,"MAIL_CHAT_UPDATE_TYPE_PINNED",function(){return ae}),n.d(t,"MAIL_CHAT_UPDATE_TYPE_USER_JOINED",function(){return oe}),n.d(t,"MAIL_CHAT_UPDATE_TYPE_USER_LEFT",function(){return se}),n.d(t,"MAIL_CHAT_UPDATE_TYPE_USER_KICKED",function(){return ce}),n.d(t,"MAIL_CHAT_UPDATE_TYPE_ADMIN_KICKED",function(){return ue}),n.d(t,"MAIL_CHAT_UPDATE_TYPE_BANNER_CHANGED",function(){return de}),n.d(t,"MAIL_CHAT_UPDATE_TYPE_KEYBOARD_CHANGED",function(){return le}),n.d(t,"MAIL_CHAT_UPDATE_TYPE_MESSAGE_REQUEST_CHANGED",function(){return _e}),n.d(t,"MAIL_CHAT_UPDATE_TYPE_CONTACT_CONVERTED",function(){return he}),n.d(t,"MESSAGE_REQUEST_STATUS_NEW",function(){return ge}),n.d(t,"deleteEvent",function(){return fe}),n.d(t,"replaceFlagsEvent",function(){return me}),n.d(t,"setFlagsEvent",function(){return pe}),n.d(t,"resetFlagsEvent",function(){return be}),n.d(t,"addMessageEvent",function(){return ve}),n.d(t,"editMessageEvent",function(){return ye}),n.d(t,"replaceMessageEvent",function(){return Oe}),n.d(t,"editMessageLocallyEvent",function(){return we}),n.d(t,"readInboundEvent",function(){return ke}),n.d(t,"readOutboundEvent",function(){return je}),n.d(t,"gotOnlineEvent",function(){return Ee}),n.d(t,"gotOfflineEvent",function(){return Ie}),n.d(t,"resetDirectoriesEvent",function(){return Te}),n.d(t,"replaceDirectoriesEvent",function(){return Ae}),n.d(t,"setDirectoriesEvent",function(){return Ce}),n.d(t,"deleteDialogEvent",function(){return Se}),n.d(t,"chatChangedEvent",function(){return Pe}),n.d(t,"chatUpdatedEvent",function(){return Me}),n.d(t,"typingEvent",function(){return De}),n.d(t,"recordingAudioEvent",function(){return Le}),n.d(t,"videoCallEvent",function(){return xe}),n.d(t,"unreadCountEvent",function(){return Re}),n.d(t,"notifySettingsChangedEvent",function(){return Ne}),n.d(t,"refreshMessageEvent",function(){return Fe}),n.d(t,"audioStartEvent",function(){return Be}),n.d(t,"emptyEvent",function(){return He}),n.d(t,"transitionEvent",function(){return Ge}),n.d(t,"resyncEvent",function(){return Ue}),n.d(t,"refreshLpKeyEvent",function(){return qe}),n.d(t,"waitingForReconnectEvent",function(){return ze}),n.d(t,"reconnectingEvent",function(){return $e}),n.d(t,"reconnectedEvent",function(){return Ve}),n.d(t,"resetPeer",function(){return We}),n.d(t,"changePeer",function(){return Ye}),n.d(t,"changeTab",function(){return Ke}),n.d(t,"failedMessage",function(){return Qe}),n.d(t,"mutexEvent",function(){return Xe}),n.d(t,"resendEvent",function(){return Je});n("a1Th"),n("Btvt"),n("rE2o"),n("ioFf"),n("rGqo"),n("OEbY");var r=n("rudk");function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a="event_delete",o="event_set_flags",s="event_replace_flags",c="event_reset_flags",u="event_add_message",d="event_read_inbound",l="event_read_outbound",_="event_got_online",h="event_got_offline",g="event_chat_changed",f="event_chat_updated",m="event_typing",p="event_recoding_audio",b="event_video_call",v="event_unread_count",y="event_notify_settings_changed",O="event_empty",w="event_reset_directories",k="event_replace_directories",j="event_set_directories",E="event_resync",I="event_refresh_lp_key",T="transition_event",A="reset_peer",C="mutex",S="change_peer",P="event_change_tab",M="event_failed_message",D="event_resend",L="event_delete_dialog",x="event_edit_message",R="event_replace_message",N="event_audio_start",F="event_waiting_for_reconnect",B="event_reconnecting",H="event_reconnected",G=1,U=2,q=8,z=16,$=32,V=64,W=128,Y=512,K=65536,Q=1<<21,X=4096,J=1,Z=2,ee=8,te=1,ne=2,re=3,ie=4,ae=5,oe=6,se=7,ce=8,ue=9,de=10,le=11,_e=12,he=13,ge=3;function fe(e){var t=i(e,2)[1];return{type:a,localId:t}}function me(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:s,messageId:n,mask:r,peerId:a}}function pe(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:o,messageId:n,flags:r,peerId:a}}function be(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:c,messageId:n,flags:r,peerId:a}}function ve(e){var t=i(e,11),n=t[1],a=t[2],o=t[3],s=t[4],c=t[5],d=t[6],l=t[7],_=t[8],h=t[9],g=t[10],f=extend(d,l||void 0);return{type:u,messageId:intval(n),flags:intval(a),peerId:intval(o),date:intval(s),attaches:Object(r.convertKludgesToAttaches)(f,n),subject:d.title||"",text:c,kludges:f,randomId:intval(_),userId:Object(r.isChatPeer)(o)?intval(f.from):intval(o),update_time:g,chat_local_id:h}}function ye(e){var t=ve(e);return t.type=x,t}function Oe(e){var t=ve(e);return t.type=R,t}function we(e){return extend({},e,{type:x})}function ke(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:d,peerId:n,upToId:r,unread:a}}function je(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:l,peerId:n,upToId:r,unread:a}}function Ee(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:_,userId:-n,platform:r,lastSeenTs:a}}function Ie(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:h,userId:-n,reason:r,lastSeenTs:a}}function Te(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:w,peerId:n,mask:r,local:void 0!==a&&a}}function Ae(e){var t=i(e,3),n=t[1],r=t[2];return{type:k,peerId:n,mask:r}}function Ce(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:j,peerId:n,mask:r,local:void 0!==a&&a}}function Se(e){var t=i(e,3),n=t[1],r=t[2];return{type:L,peerId:n,localId:r}}function Pe(e){var t=i(e,3),n=t[1],r=t[2];return{type:g,chatId:n,self:r}}function Me(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:f,peerId:r,updateType:n,updateArg:a}}function De(e){var t=i(e,5),n=t[1],r=t[2],a=t[3],o=t[4];return{type:m,peerId:n,userIds:r,totalCount:a,ts:o}}function Le(e){var t=i(e,5),n=t[1],r=t[2],a=t[3],o=t[4];return{type:p,peerId:n,userIds:r,totalCount:a,ts:o}}function xe(e){var t=i(e,3),n=t[1],r=t[2];return{type:b,userId:n,callId:r}}function Re(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:v,count:n,countNotMuted:r,showOnlyNotMuted:a}}function Ne(e){var t=i(e,2)[1],n=void 0===t?{}:t;return{type:y,peerId:n.peer_id,sound:n.sound,disabledUntil:n.disabled_until}}function Fe(e){var t=i(e,2)[1],n=void 0===t?{}:t,r=ve([!1,n.id,n.flags,n.peer_id,n.date,n.message,extend(n.kludges,{title:n.title||""}),{},n.random_id,n.chat_local_id,n.update_time]);return r.type=x,r}function Be(e){var t=i(e,2)[1],n=void 0===t?{}:t;return{type:N,uuid:n.uuid,deviceName:n.device_name||""}}function He(e){return{type:O,params:e}}function Ge(e){return{type:T,state:e}}function Ue(){return{type:E}}function qe(e){var t=i(e,3),n=t[1],r=t[2];return{type:I,key:n,url:r}}function ze(e){var t=i(e,2)[1];return{type:F,timeout:t}}function $e(){return{type:B}}function Ve(){return{type:H}}function We(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:A,cancelSearch:e,removeActivePeer:t}}function Ye(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";return{type:S,peerId:e,msgid:t,forward:n,cancelSearch:r,entryPoint:i}}function Ke(e){return{type:P,tab:e}}function Qe(e,t,n){return{type:M,message:t,peer:e,error:n}}function Xe(e){var t=i(e,6),n=(t[0],t[1]),r=t[2],a=t[3],o=t[4],s=t[5];return{type:C,free:!!intval(n)||intval(o)===vk.id,resource:r,peerId:intval(a),who:intval(o),name:s}}function Je(e,t){return{type:D,message:t,peerId:e}}},gVOz:function(e,t,n){"use strict";n.r(t),n.d(t,"WarningNotification",function(){return d}),n.d(t,"default",function(){return l});n("91GP");var r=n("q1tI"),i=(n("17x9"),n("dV62")),a=n("Hx9h"),o=n("kHqu"),s=n("6raB"),c=n("T/g7");function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}class d extends r.Component{constructor(e){super(e),this.clickProceed=()=>{this.sendViewSignal(),this.props.onClose()},this.clickBack=()=>{this.setState({isLoading:!0}),window.history.length>1?window.history.back():window.nav.go("/")},this.state={isLoading:!1}}sendViewSignal(){var e=this.props,t={act:"hide_warning_notification",notification_id:e.notification_id,group_id:e.group_id,user_id:e.user_id,hash:e.hash};ajax.post("al_groups.php",t,{})}renderImage(){var e="/images/groups/warning_notification";return r.createElement("img",{alt:Object(c.getLang)("groups_warning_notification_web_img_alt"),src:e+".png",srcSet:e+"_2x.png 2x",className:"WarningNotification__image"})}render(){var e=this.props,t=this.state,n=this.renderImage();return r.createElement("div",{className:"WarningNotification__box"},r.createElement("div",{className:"WarningNotification__image-container"},n),r.createElement("div",{className:"WarningNotification__title WarningNotification__component--centered",dangerouslySetInnerHTML:{__html:e.title_html}}),r.createElement("div",{className:"WarningNotification__text WarningNotification__component--centered",dangerouslySetInnerHTML:{__html:e.text_html}}),r.createElement(s.default,{loading:t.isLoading,onClick:this.clickBack,className:"WarningNotification__button WarningNotification__button--back WarningNotification__component--centered"},Object(c.getLang)("global_back")),r.createElement(a.default,{onClick:this.clickProceed,appearance:"link",className:"WarningNotification__button WarningNotification__button--proceed WarningNotification__component--centered"},Object(c.getLang)("groups_warning_notification_proceed")))}}function l(e){var t=()=>{l(e)};cur._back.show.push(t),cur._back.onArticleNavBack=t;var n=()=>{Object(i.destroyComponentInBox)(!0)};cur.zNavInfo&&(n=()=>{Object(i.destroyComponentInBox)(!0),Object(o.zNav)(cur.zNavInfo.info,cur.zNavInfo.opts)});var a={containerClass:"WarningNotification",width:655,height:538,onHideAttempt:e=>Boolean(e)};Object(i.showComponentInBox)(r.createElement(d,u({onClose:n},e)),a)}},"h++7":function(e,t,n){"use strict";n.r(t),n.d(t,"OUR_DOMAINS",function(){return r}),n.d(t,"ENTITIES",function(){return i}),n.d(t,"VK_DOMAIN",function(){return a}),n.d(t,"MENTION",function(){return o}),n.d(t,"MENTION_RAW",function(){return s}),n.d(t,"ARROW_UP",function(){return c}),n.d(t,"ARROW_DOWN",function(){return u}),n.d(t,"PAGE_UP",function(){return d}),n.d(t,"PAGE_DOWN",function(){return l}),n.d(t,"END_KEY",function(){return _}),n.d(t,"HOME",function(){return h}),n.d(t,"ENTER",function(){return g}),n.d(t,"ESC",function(){return f}),n.d(t,"UNPRINTABLE_KEYS",function(){return m}),n.d(t,"UP_DOWN_CONTROLS",function(){return p}),n.d(t,"PRINTABLE",function(){return b}),n.d(t,"FOLDER_UNREAD",function(){return v}),n.d(t,"FOLDER_ALL",function(){return y}),n.d(t,"FOLDER_UNRESPOND",function(){return O}),n.d(t,"FOLDER_IMPORTANT",function(){return w}),n.d(t,"FOLDER_MESSAGE_REQUEST",function(){return k}),n.d(t,"FOLDER_MESSAGE_REQUEST_REJECTED",function(){return j}),n.d(t,"FOLDERS",function(){return E}),n.d(t,"FOLDER_MASKS",function(){return I}),n.d(t,"TOP_DOMAINS",function(){return T}),n.d(t,"MAX_DOMAIN_LENGTH",function(){return A}),n.d(t,"EMAIL",function(){return C}),n.d(t,"MESSAGE_REGEXP",function(){return S}),n.d(t,"RE_HASHTAG_EXTRACTION_PATTERN",function(){return M}),n.d(t,"LINE_FEED",function(){return D});n("Oyvg");var r=/^([a-zA-Z0-9\.\_\-]+\.)?(vkontakte\.ru|vk\.com|vkadre\.ru|vshtate\.ru|userapi\.com|vk\.me)$/,i=/([^a-zA-Z0-9#%;_\-.\/?&=\[\]])/g,a=/^(?:https?:\/\/)?(?:vk\.com|vkontakte\.ru)?\/([a-zA-Z0-9\._]+)\??$/,o=/\[(id|club)(\d+)(?:\:([a-z0-9_\-]+))?\|([^\$]+?)\]/g,s=/(^|[\s.,:\'\";>\)\(])(\*|@)([A-Za-z0-9_\.]{2,32})\s*\((.+?)\)/g,c=38,u=40,d=33,l=34,_=35,h=36,g=13,f=27,m=[c,u,d,l,g,f,_,h],p=[d,l,u,c,h,_],b="printable",v="unread",y="all",O="unrespond",w="important",k="mr",j="mr_rejected",E=[y,v,O,w,k],I={[O]:2,[w]:1,[k]:256,[j]:512},T=[].concat("aaa,aarp,abarth,abb,abbott,abbvie,abc,able,abogado,abudhabi,ac,academy,accenture,accountant,accountants,aco,active,actor,ad,adac,ads,adult,ae,aeg,aero,aetna,af,afamilycompany,afl,africa,ag,agakhan,agency,ai,aig,aigo,airbus,airforce,airtel,akdn,al,alfaromeo,alibaba,alipay,allfinanz,allstate,ally,alsace,alstom,am,americanexpress,americanfamily,amex,amfam,amica,amsterdam,an,analytics,android,anquan,anz,ao,aol,apartments,app,apple,aq,aquarelle,ar,aramco,archi,army,arpa,art,arte,as,asda,asia,associates,at,athleta,attorney,au,auction,audi,audible,audio,auspost,author,auto,autos,avianca,aw,aws,ax,axa,az,azure,ba,baby,baidu,banamex,bananarepublic,band,bank,bar,barcelona,barclaycard,barclays,barefoot,bargains,baseball,basketball,bauhaus,bayern,bb,bbc,bbt,bbva,bcg,bcn,bd,be,beats,beauty,beer,bentley,berlin,best,bestbuy,bet,bf,bg,bh,bharti,bi,bible,bid,bike,bing,bingo,bio,biz,bj,bl,black,blackfriday,blanco,blockbuster,blog,bloomberg,blue,bm,bms,bmw,bn,bnl,bnpparibas,bo,boats,boehringer,bofa,bom,bond,boo,book,booking,boots,bosch,bostik,boston,bot,boutique,box,bq,br,bradesco,bridgestone,broadway,broker,brother,brussels,bs,bt,budapest,bugatti,build,builders,business,buy,buzz,bv,bw,by,bz,bzh,ca,cab,cafe,cal,call,calvinklein,cam,camera,camp,cancerresearch,canon,capetown,capital,capitalone,car,caravan,cards,care,career,careers,cars,cartier,casa,case,caseih,cash,casino,cat,catering,catholic,cba,cbn,cbre,cbs,cc,cd,ceb,center,ceo,cern,cf,cfa,cfd,cg,ch,chanel,channel,chase,chat,cheap,chintai,chloe,christmas,chrome,chrysler,church,ci,cipriani,circle,cisco,citadel,citi,citic,city,cityeats,ck,cl,claims,cleaning,click,clinic,clinique,clothing,cloud,club,clubmed,cm,cn,co,coach,codes,coffee,college,cologne,com,comcast,commbank,community,company,compare,computer,comsec,condos,construction,consulting,contact,contractors,cooking,cookingchannel,cool,coop,corsica,country,coupon,coupons,courses,cr,credit,creditcard,creditunion,cricket,crown,crs,cruise,cruises,csc,cu,cuisinella,cv,cw,cx,cy,cymru,cyou,cz,dabur,dad,dance,data,date,dating,datsun,day,dclk,dds,de,deal,dealer,deals,degree,delivery,dell,deloitte,delta,democrat,dental,dentist,desi,design,dev,dhl,diamonds,diet,digital,direct,directory,discount,discover,dish,diy,dj,dk,dm,dnp,do,docs,doctor,dodge,dog,doha,domains,dot,download,drive,dtv,dubai,duck,dunlop,duns,dupont,durban,dvag,dvr,dz,earth,eat,ec,eco,edeka,edu,education,ee,eg,eh,email,emerck,energy,engineer,engineering,enterprises,epost,epson,equipment,er,ericsson,erni,es,esq,estate,esurance,et,eu,eurovision,eus,events,everbank,exchange,expert,exposed,express,extraspace,fage,fail,fairwinds,faith,family,fan,fans,farm,farmers,fashion,fast,fedex,feedback,ferrari,ferrero,fi,fiat,fidelity,fido,film,final,finance,financial,fire,firestone,firmdale,fish,fishing,fit,fitness,fj,fk,flickr,flights,flir,florist,flowers,fly,fm,fo,foo,food,foodnetwork,football,ford,forex,forsale,forum,foundation,fox,fr,free,fresenius,frl,frogans,frontdoor,frontier,ftr,fujitsu,fujixerox,fun,fund,furniture,futbol,fyi,ga,gal,gallery,gallo,gallup,game,games,gap,garden,gb,gbiz,gd,gdn,ge,gea,gent,genting,george,gf,gg,ggee,gh,gi,gift,gifts,gives,giving,gl,glade,glass,gle,global,globo,gm,gmail,gmbh,gmo,gmx,gn,godaddy,gold,goldpoint,golf,goo,goodhands,goodyear,goog,google,gop,got,gov,gp,gq,gr,grainger,graphics,gratis,green,gripe,group,gs,gt,gu,guardian,gucci,guge,guide,guitars,guru,gw,gy,hair,hamburg,hangout,haus,hbo,hdfc,hdfcbank,health,healthcare,help,helsinki,here,hermes,hgtv,hiphop,hisamitsu,hitachi,hiv,hk,hkt,hm,hn,hockey,holdings,holiday,homedepot,homegoods,homes,homesense,honda,honeywell,horse,hospital,host,hosting,hot,hoteles,hotmail,house,how,hr,hsbc,ht,htc,hu,hughes,hyatt,hyundai,ibm,icbc,ice,icu,id,ie,ieee,ifm,ikano,il,im,imamat,imdb,immo,immobilien,in,industries,infiniti,info,ing,ink,institute,insurance,insure,int,intel,international,intuit,investments,io,ipiranga,iq,ir,irish,is,iselect,ismaili,ist,istanbul,it,itau,itv,iveco,iwc,jaguar,java,jcb,jcp,je,jeep,jetzt,jewelry,jio,jlc,jll,jm,jmp,jnj,jo,jobs,joburg,jot,joy,jp,jpmorgan,jprs,juegos,juniper,kaufen,kddi,ke,kerryhotels,kerrylogistics,kerryproperties,kfh,kg,kh,ki,kia,kim,kinder,kindle,kitchen,kiwi,km,kn,koeln,komatsu,kosher,kp,kpmg,kpn,kr,krd,kred,kuokgroup,kw,ky,kyoto,kz,la,lacaixa,ladbrokes,lamborghini,lamer,lancaster,lancia,lancome,land,landrover,lanxess,lasalle,lat,latino,latrobe,law,lawyer,lb,lc,lds,lease,leclerc,lefrak,legal,lego,lexus,lgbt,li,liaison,lidl,life,lifeinsurance,lifestyle,lighting,like,lilly,limited,limo,lincoln,linde,link,lipsy,live,living,lixil,lk,loan,loans,local,locker,locus,loft,lol,london,lotte,lotto,love,lpl,lplfinancial,lr,ls,lt,ltd,ltda,lu,lundbeck,lupin,luxe,luxury,lv,ly,ma,macys,madrid,maif,maison,makeup,man,management,mango,market,marketing,markets,marriott,marshalls,maserati,mattel,mba,mc,mcd,mcdonalds,mckinsey,md,me,med,media,meet,melbourne,meme,memorial,men,menu,meo,metlife,mf,mg,mh,miami,microsoft,mil,mini,mint,mit,mitsubishi,mk,ml,mlb,mls,mm,mma,mn,mo,mobi,mobile,mobily,moda,moe,moi,mom,monash,money,monster,montblanc,mopar,mormon,mortgage,moscow,moto,motorcycles,mov,movie,movistar,mp,mq,mr,ms,msd,mt,mtn,mtpc,mtr,mu,museum,mutual,mv,mw,mx,my,mz,na,nab,nadex,nagoya,name,nationwide,natura,navy,nba,nc,ne,nec,net,netbank,netflix,network,neustar,new,newholland,news,next,nextdirect,nexus,nf,nfl,ng,ngo,nhk,ni,nico,nike,nikon,ninja,nissan,nissay,nl,no,nokia,northwesternmutual,norton,now,nowruz,nowtv,np,nr,nra,nrw,ntt,nu,nyc,nz,obi,observer,off,office,okinawa,olayan,olayangroup,oldnavy,ollo,om,omega,one,ong,onl,online,onyourside,ooo,open,oracle,orange,org,organic,orientexpress,origins,osaka,otsuka,ott,ovh,pa,page,pamperedchef,panasonic,panerai,paris,pars,partners,parts,party,passagens,pay,pccw,pe,pet,pf,pfizer,pg,ph,pharmacy,philips,phone,photo,photography,photos,physio,piaget,pics,pictet,pictures,pid,pin,ping,pink,pioneer,pizza,pk,pl,place,play,playstation,plumbing,plus,pm,pn,pnc,pohl,poker,politie,porn,post,pr,pramerica,praxi,press,prime,pro,prod,productions,prof,progressive,promo,properties,property,protection,pru,prudential,ps,pt,pub,pw,pwc,py,qa,qpon,quebec,quest,qvc,racing,radio,raid,re,read,realestate,realtor,realty,recipes,red,redstone,redumbrella,rehab,reise,reisen,reit,reliance,ren,rent,rentals,repair,report,republican,rest,restaurant,review,reviews,rexroth,rich,richardli,ricoh,rightathome,ril,rio,rip,rmit,ro,rocher,rocks,rodeo,rogers,room,rs,rsvp,ru,ruhr,run,rw,rwe,ryukyu,sa,saarland,safe,safety,sakura,sale,salon,samsclub,samsung,sandvik,sandvikcoromant,sanofi,sap,sapo,sarl,sas,save,saxo,sb,sbi,sbs,sc,sca,scb,schaeffler,schmidt,scholarships,school,schule,schwarz,science,scjohnson,scor,scot,sd,se,seat,secure,security,seek,select,sener,services,ses,seven,sew,sex,sexy,sfr,sg,sh,shangrila,sharp,shaw,shell,shia,shiksha,shoes,shop,shopping,shouji,show,showtime,shriram,si,silk,sina,singles,site,sj,sk,ski,skin,sky,skype,sl,sling,sm,smart,smile,sn,sncf,so,soccer,social,softbank,software,sohu,solar,solutions,song,sony,soy,space,spiegel,spot,spreadbetting,sr,srl,srt,ss,st,stada,staples,star,starhub,statebank,statefarm,statoil,stc,stcgroup,stockholm,storage,store,stream,studio,study,style,su,sucks,supplies,supply,support,surf,surgery,suzuki,sv,swatch,swiftcover,swiss,sx,sy,sydney,symantec,systems,sz,tab,taipei,talk,taobao,target,tatamotors,tatar,tattoo,tax,taxi,tc,tci,td,tdk,team,tech,technology,tel,telecity,telefonica,temasek,tennis,teva,tf,tg,th,thd,theater,theatre,tiaa,tickets,tienda,tiffany,tips,tires,tirol,tj,tjmaxx,tjx,tk,tkmaxx,tl,tm,tmall,tn,to,today,tokyo,tools,top,toray,toshiba,total,tours,town,toyota,toys,tp,tr,trade,trading,training,travel,travelchannel,travelers,travelersinsurance,trust,trv,tt,tube,tui,tunes,tushu,tv,tvs,tw,tz,ua,ubank,ubs,uconnect,ug,uk,um,unicom,university,uno,uol,ups,us,uy,uz,va,vacations,vana,vanguard,vc,ve,vegas,ventures,verisign,vermögensberater,vermögensberatung,versicherung,vet,vg,vi,viajes,video,vig,viking,villas,vin,vip,virgin,visa,vision,vista,vistaprint,viva,vivo,vlaanderen,vn,vodka,volkswagen,volvo,vote,voting,voto,voyage,vu,vuelos,wales,walmart,walter,wang,wanggou,warman,watch,watches,weather,weatherchannel,webcam,weber,website,wed,wedding,weibo,weir,wf,whoswho,wien,wiki,williamhill,win,windows,wine,winners,wme,wolterskluwer,woodside,work,works,world,wow,ws,wtc,wtf,xbox,xerox,xfinity,xihuan,xin,xperia,xxx,xyz,yachts,yahoo,yamaxun,yandex,ye,yodobashi,yoga,yokohama,you,youtube,yt,yu,yun,za,zappos,zara,zero,zip,zippo,zm,zone,zuerich,zw".split(","),"бг,бел,дети,ею,католик,ком,мкд,мон,москва,онлайн,орг,рус,рф,сайт,срб,укр".split(","),"qxam,90ae,90ais,d1acj3b,e1a4c,80aqecdr1a,j1aef,d1alf,l1acc,80adxhks,80asehdb,c1avg,p1acf,p1ai,80aswg,90a3ac,j1amh,80ao21a,y9a3aq,9dbq2a,mgbca7dzdo,mgba3a3ejt,mgbayh7gpa,lgbbat1ad8j,mgberp4a5d4ar,mgba7c0bbn0a,mgbc0a9azcg,mgb2ddes,mgbaam7a8h,mgba3a4f16a,mgbbh1a,mgbab2bd,ngbe9e0a,mgbbh1a71e,pgbs0dh,mgbpl2fh,ogbpf8fl,ngbc5azd,mgbtx2b,mgb9awbf,ygbi2ammx,wgbl6a,mgbi4ecexp,fhbei,wgbh1c,mgbx4cd0ab,mgbb9fbpob,4gbrim,mgbt3dhd,mgbai9azgqp6j,mgbgu82a,11b4c3d,c2br7g,h2brj9c,h2breg3eve,h2brj9c8c,i1b6b1a6a2e,54b7fta0cc,45brj9c,45br5cyl,s9brj9c,gecrj9c,3hcrj9c,xkc2dl3a5ee0h,xkc2al3hye2a,clchc0ea0b2g2a9gcd,fpcrj9c3d,2scrj9c,rvc1e0am3e,fzc2c9e2c,42c2d9a,o3cw4h,node,q9jyb4c,gckr3f0f,qcka1pmc,tckwe,cck2b3b,1ck2e1b,bck1b9a5dre4c,eckvdtc9d,rhqv96g,fiq64b,fiqs8s,fiqz9s,fiq228c5hs,vhquv,1qqw23a,vuq861b,nyqy26a,45q11c,55qx5d,55qw42g,kprw13d,kpry57d,czru2d,czrs0t,czr694b,w4rs40l,w4r85el8fhu5dnra,3ds443g,3oq18vl8pn36a,pssy2u,tiq49xqyj,fjq720a,fct429k,estv75g,xhq521b,9krt00a,30rr7y,6qq986b3xl,kput3i,kpu716f,zfr164b,mxtq1m,yfro4i67o,efvy88h,9et52u,rovu88b,nqv7f,b4w605ferd,unup4y,mix891f,mix082f,3pxu8k,pbt977c,6frz82g,nqv7fs00ema,ses554g,hxt814e,5tzm5g,io0a7i,8y0a063a,jlq61u9w7b,flw351e,g2xx48c,gk3at1e,3bst00m,fzys8d69uvgm,kcrx77d1x4a,jvr189m,imr513n,5su34j936bgsg,j6w193g,t60b56a,mk1bu44c,cg4bki,3e0b707e".split(",").map(e=>"xn--"+e)),A=T.reduce((e,t)=>Math.max(e,t.length),0),C=new RegExp("([a-zA-Zа-яА-Я\\-_\\.0-9\\+]+@(((?:[\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј\\—\\-\\_]+\\.){1,5})([A-Za-zа-яА-Я\\-\\d]{2,22})))","ig"),S=new RegExp("(https?:\\/\\/)?(((?:[\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј\\—\\-\\_]+\\.){1,5})([A-Za-zа-яА-Я\\-\\d]{2,22})(?:\\:(\\d{2,5}))?)(([\\/?#])(?:\\&amp;|\\&#\\d{2,6};|,[_%]|!|,*[\\wА-Яа-я\\xa8\\xb8\\xc0-\\xffєЄҐґЇїІіЈј\\—\\-\\_@#%?+\\/\\$.~=;:'ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴࢶ-ࢽऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢄᢇ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞮꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ　-〿＀-￯*]+|(?:\\(|\\[)[\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј\\d&#%;,]+(?:\\)|\\])){0,200})?","ig"),P="(?:[a-zA-Zа-яА-ЯёіјєїґўЁІЈЄЇҐЎ’_\\d]|(?:&#(?:19[2-9]|(?:[2-9]|1[0-3])[0-9][0-9]);?))",M=`(^|[s.,:'";>)(]?)(${`(#${P}{0,100}(?:[a-zA-Zа-яА-ЯёіјєїґўЁІЈЄЇҐЎ’]|(?:&#(?:19[2-9]|(?:[2-9]|1[0-3])[0-9][0-9]);?))${P}{0,100})`})(@((?:[a-z0-9_]*[a-z0-9])?(?:(?:.[a-z](?:[a-z0-9_]+[a-z0-9])?)*.[a-z][a-z0-9_]{2,40}[a-z0-9])?))?(?=$|[s.,:'"&;?<)(]?)`,D=10},k3PD:function(e,t,n){"use strict";function r(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}n.r(t),n.d(t,"isElementInViewport",function(){return r})},lJdi:function(e,t,n){"use strict";n.r(t),n.d(t,"MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_INVITE",function(){return o}),n.d(t,"MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_PIN",function(){return s}),n.d(t,"MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CHANGE_TITLE",function(){return c}),n.d(t,"MAIL_CHAT_FLAG_ADMINS_CAN_ADD_ADMINS",function(){return u}),n.d(t,"MAIL_CHAT_FLAG_ADMINS_CAN_INVITE_LINK",function(){return d}),n.d(t,"MAIL_CHAT_FLAG_DENY_ANYONE_TO_WRITE",function(){return l}),n.d(t,"MAIL_CHAT_FLAG_IS_COMMUNITY_CHAT",function(){return _}),n.d(t,"MAIL_CHAT_FLAG_IS_COMMUNITY_CHAT_DELETED",function(){return h}),n.d(t,"MAIL_CHATS_ACTION_SEE_INVITE_LINK",function(){return g}),n.d(t,"MAIL_CHATS_ACTION_CHANGE_INVITE_LINK",function(){return f}),n.d(t,"MAIL_CHATS_ACTION_INVITE_USER",function(){return m}),n.d(t,"MAIL_CHATS_ACTION_PIN_OR_UNPIN",function(){return p}),n.d(t,"MAIL_CHATS_ACTION_CHANGE_TITLE",function(){return b}),n.d(t,"MAIL_CHATS_ACTION_ADD_ADMIN",function(){return v}),n.d(t,"canSeeInviteLink",function(){return w}),n.d(t,"canChangeInviteLink",function(){return k}),n.d(t,"canAddAdmin",function(){return j}),n.d(t,"canInviteUser",function(){return E}),n.d(t,"canKickUser",function(){return I}),n.d(t,"canPinOrUnpin",function(){return T}),n.d(t,"canChangeTitle",function(){return A}),n.d(t,"canChangeAvatar",function(){return C}),n.d(t,"canSeeAllMessages",function(){return S}),n.d(t,"canSeeSettingsItem",function(){return P}),n.d(t,"canCloseChat",function(){return M}),n.d(t,"checkChatRights",function(){return D}),n.d(t,"doesChatTabHaveFlag",function(){return L}),n.d(t,"isUserAdminInChat",function(){return x}),n.d(t,"isUserOwnerInChat",function(){return R}),n.d(t,"isUserInvitedByMe",function(){return N});n("OEbY");var r=n("rHUl"),i=n("aong"),a=n("P13b"),o=1,s=4,c=8,u=16,d=32,l=16384,_=1<<17,h=1<<18,g="see_invite_link",f="change_invite_link",m="invite_user",p="pin_unpin",b="change_title",v="add_admin",y={[g]:d,[f]:d,[v]:u,[m]:o,[p]:s,[b]:c},O=1;function w(e,t,n){return D(e,g,t,n)}function k(e,t,n){return D(e,f,t,n)}function j(e,t,n,a){var o=Object(i.unpackStore)(e);return!R(Object(r.getTab)(o,n||o.peer),t)&&D(e,v,n,a)}function E(e,t,n){return D(e,m,t,n)}function I(e,t,n,o){var s=Object(i.unpackStore)(e);if(function(e,t){var n=Object(i.unpackStore)(e);return void 0!==n.service&&(n.service&t)>0}(e,O))return!0;var c=Object(r.getTab)(s,n||s.peer);return!(c.data.kicked&&!c.data.closed)&&(!Object(a.isFvkcomgroup)(e,n)&&(!R(c,t)&&(!!R(c,o=void 0===o?window.vk.id:o)||(x(c,o)?!x(c,t):N(c,t)&&!x(c,t)))))}function T(e,t,n){return D(e,p,t,n)}function A(e,t,n){return D(e,b,t,n)}function C(e,t,n){return A(e,t,n)&&!Object(a.isFvkcomgroup)(e,t)}function S(e,t,n){return!Object(r.isCommunityPeer)(n)||!!Object(r.getTab)(e,t).caccess[n]}function P(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.vk.id,o=Object(i.unpackStore)(e),s=Object(a.isFvkcomgroup)(o,t),c=o.tabs[o.peer];if(Object(r.isCommunityChat)(o,t)){var u=c&&c.data&&!c.data.kicked&&!c.data.closed,d=R(c,-o.gid)&&u||x(c,n)&&u,_=c.allowedUpdateFlags?c.allowedUpdateFlags.filter(e=>e!==l):[];return!(!d||!_.length)}return R(c,n)&&!s}function M(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.vk.id,a=Object(i.unpackStore)(e),o=Object(r.isCommunityChat)(a,t),s=Object(r.isCommunityChatDeleted)(a,t),c=a.tabs[a.peer],u=c&&c.data&&!c.data.kicked&&!c.data.closed,d=R(c,-a.gid)&&u||x(c,n)&&u;return o&&!s&&d&&c.allowedUpdateFlags&&c.allowedUpdateFlags.includes(l)}function D(e,t,n,o){var s=Object(i.unpackStore)(e);o=void 0===o?window.vk.id:o,n=void 0===n?s.peer:n;var c=Object(r.getTab)(s,n),u=c&&c.data&&!c.data.kicked&&!c.data.closed,d=y[t];if(Object(a.isFvkcomgroup)(e,n))switch(t){case v:case m:return!1;case g:return u;default:return s.gid>0}else if(Object(r.isCommunityChat)(e,n)){if(Object(r.isClosedChat)(e,n))return!1;var l=R(c,-s.gid)&&u,_=l||x(c,o)&&u;switch(t){case v:return!1;case g:case f:return L(c,d)?_:l;case m:return!l&&(!(null===c.canInvite||!c.canInvite)&&(L(c,d)?_:u));case p:case b:return _;default:return!1}}switch(t){case g:case f:case v:return L(c,d)?x(c,o)&&u:R(c,o);case m:case p:case b:return L(c,d)?x(c,o)&&u:u}return!1}function L(e,t){return((e&&e.data&&e.data.flags||0)&t)>0}function x(e,t){return(e&&e.adminIds||[]).indexOf(+t)>-1}function R(e,t){return e.ownerId===t}function N(e,t){return-1!==e.invitedByMe.indexOf(t)}},lcT2:function(e,t,n){"use strict";n.r(t),n.d(t,"joinChatBox",function(){return c});var r=n("Egk5"),i=n("vT4u"),a=n("rudk"),o=n("P13b"),s=n("4cFO");function c(e,t,n,a){Object(r.cancelEvent)(a);var c={invite_chat_id:t,invite_hash:e},d=Object(s.default)({writeHash:n,longpoll:[],tabs:{},dialog_tabs:{},invitation:c,onJoinChat:u});Object(o.showInvitationBox)(d,c,i.leaveInvitation)}function u(e){if(Object(a.isChatPeer)(e)){var t=Object(o.convertPeerToUrl)(e);nav.go(`im?sel=${t}`)}}},ofcU:function(e,t,n){"use strict";n.r(t);n("a1Th"),n("rE2o"),n("ioFf"),n("rGqo"),n("Btvt"),n("KKXr");function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i=new window.Map;function a(e){var t=i.get(e.currentTarget);if(t){var n=t[e.type];if(n)for(var a,o=0;o<n.length;o++){var s=r(n[o],2),c=s[0],u=s[1],d=void 0;if(hasClass(e.target,c)?d=u(e,e.target):(a=gpeByClass(c,e.target,e.currentTarget))&&(d=u(e,a)),!1===d)break}}}var o=n("Egk5");function s(e){return{callMutations:function(){if("function"==typeof e)throw console.trace(),new Error("Mutations are not initialized");return e},bindMutations:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if("function"!=typeof e)throw console.trace(),new Error("Mutations are already initialized");return e=e.apply(void 0,t)}}}function c(e,t,n,r,o){!function(e,t,n,r){var o=i.get(e);o||(i.set(e,{}),o=i.get(e));for(var s=t.split(" "),c=0;c<s.length;c++){var u=s[c];o[u]||(o[u]=[],addEvent(e,u,a)),o[u].push([n,r])}}(t,n,r,o),e._registeredHandlers.push({handlerType:"delegate",elem:t,types:n,selector:r,handler:o})}function u(e){var t={_registeredHandlers:[]};return e.handlers(function(e,t,n,r){Object(o.addEvent)(t,n,r),e._registeredHandlers.push({handlerType:"bind",elem:t,types:n,handler:r})}.bind(null,t),c.bind(null,t)),t}function d(e){e._registeredHandlers.forEach(function(e){var t,n,r,s,c;"delegate"===e.handlerType?(t=e.elem,n=e.types,r=e.selector,s=e.handler,(c=i.get(t))&&(n.split(" ").forEach(e=>{c[e]&&(c[e]=c[e].filter(e=>e[0]!==r||e[1]!==s),0===c[e].length&&removeEvent(t,e,a))}),0===Object.keys(c).map(e=>c[e].length).reduce((e,t)=>e+t)&&i.delete(t))):Object(o.removeEvent)(e.elem,e.types,e.handler)}),e._registeredHandlers=[]}n.d(t,"createMutations",function(){return s}),n.d(t,"createModule",function(){return u}),n.d(t,"destroyModule",function(){return d})},rHUl:function(e,t,n){"use strict";n.r(t),n.d(t,"getFirstUnread",function(){return l}),n.d(t,"isSearchShown",function(){return _}),n.d(t,"getPeer",function(){return h}),n.d(t,"getCurrentKeyboard",function(){return g}),n.d(t,"getKeyboard",function(){return f}),n.d(t,"getTab",function(){return m}),n.d(t,"getCurrentTab",function(){return p}),n.d(t,"getSelectedMessages",function(){return b}),n.d(t,"getMessageRangeFromSelection",function(){return v}),n.d(t,"countUnread",function(){return y}),n.d(t,"getMessageByRid",function(){return O}),n.d(t,"isRidExist",function(){return w}),n.d(t,"getLocalId",function(){return k}),n.d(t,"getLastMessage",function(){return j}),n.d(t,"parserMessage",function(){return E}),n.d(t,"getAuthorFullName",function(){return I}),n.d(t,"getMessage",function(){return T}),n.d(t,"getPreviousMessage",function(){return A}),n.d(t,"isClassicInterface",function(){return C}),n.d(t,"isLocksAvailable",function(){return S}),n.d(t,"isFoldersAvailable",function(){return P}),n.d(t,"isCommunityInterface",function(){return M}),n.d(t,"isChannel",function(){return D}),n.d(t,"getBareTab",function(){return L}),n.d(t,"isReversedDialogs",function(){return x}),n.d(t,"isFullyLoadedTab",function(){return R}),n.d(t,"makeTabNotFullyLoaded",function(){return N}),n.d(t,"isGoToEndVisible",function(){return F}),n.d(t,"getUnreadScrollBottom",function(){return B}),n.d(t,"isSendingAvailable",function(){return H}),n.d(t,"isCommunityPeer",function(){return G}),n.d(t,"isCommunityBlocked",function(){return U}),n.d(t,"checkVoiceMessageAvailable",function(){return q}),n.d(t,"isSearching",function(){return z}),n.d(t,"getSearchText",function(){return $}),n.d(t,"isSearchingValue",function(){return V}),n.d(t,"isRecentSearchesActive",function(){return W}),n.d(t,"getPinnedMessage",function(){return Y}),n.d(t,"doPopularSuggExist",function(){return K}),n.d(t,"isAnyMessageBeingEdited",function(){return Q}),n.d(t,"getGroupId",function(){return X}),n.d(t,"getTabDraft",function(){return J}),n.d(t,"getTemplates",function(){return Z}),n.d(t,"tabIsMessageRequest",function(){return ee}),n.d(t,"tabIsMessageRequestToChat",function(){return te}),n.d(t,"removeMessageRequestFolderFlags",function(){return ne}),n.d(t,"isMessageRequestFolder",function(){return re}),n.d(t,"tabIsOutgoingMessageRequest",function(){return ie}),n.d(t,"existsIncomingMessageRequest",function(){return ae}),n.d(t,"isMessageRequestChangedEvent",function(){return oe}),n.d(t,"isCommunityChat",function(){return se}),n.d(t,"isCommunityChatDeleted",function(){return ce}),n.d(t,"isClosedChat",function(){return ue});n("Vd3H"),n("rGqo"),n("Btvt");var r=n("MhhX"),i=n("f01n"),a=n("h++7"),o=n("86+7"),s=n("rjmT"),c=n("aong"),u=n("lJdi"),d=n("rudk");function l(e,t){var n=Object(c.unpackStore)(e),i=n.tabs[n.peer];return Object.keys(i.msgs).filter(n=>{var a=T(e,t,n);return!Object(r.isOut)(a)&&intval(n)>i.in_up_to})[0]}function _(e){return Object(c.unpackStore)(e).searchShown}function h(e){return Object(c.unpackStore)(e).peer}function g(e){return f(e,h(e))}function f(e,t){var n=(m(e,t)||{}).keyboard;if(!n||!n.buttons||n.buttons.length)return n}function m(e,t){var n=Object(c.unpackStore)(e);return n.tabs&&n.tabs[t]}function p(e){var t=Object(c.unpackStore)(e);return t.peer?t.tabs[t.peer]:null}function b(e){return Object(c.unpackStore)(e).selectedMessages}function v(e,t,n){var i=m(e,t),a=b(e)[0];if(void 0===a)return[n];var o=Math.min(n,a),s=Math.max(n,a);return Object.keys(i.msgs).filter(e=>e>=o&&e<=s).filter(t=>{var n=T(e,e.get().peer,t);return!Object(r.isServiceMsg)(n)&&!Object(r.isCallMessage)(n)}).map(intval)}function y(e,t){var n=m(Object(c.unpackStore)(t),e),i=0;for(var a in n.msgs)if(n.msgs.hasOwnProperty(a)){var o=T(t,e,a);Object(r.isOut)(o)||(i+=Object(r.isUnread)(n,o)?1:0)}return i}function O(e,t,n){var r=m(e,t);return Object.keys(r.msgs).filter(r=>intval(T(e,t,r).randomId)===n).length>0}function w(e,t,n){return!!O(e,t,n)}function k(e,t){var n=Object(c.unpackStore)(e),r=n.msg_local_ids_sort&&n.msg_local_ids_sort[t];return void 0!==r?2e9+r:t}function j(e,t,n){var r=m(e,t),a=T(e,t,n),o=Object.keys(r.msgs).filter(n=>{var r=T(e,t,n),o=r.local&&r.type!==i.EDIT_MESSAGE;return!(!a.local&&o)&&(!(!a.local||o)||k(e,a.messageId)>k(e,r.messageId))}).pop();return o?T(e,t,o):null}function E(e){return e&&e.length>0?i.addMessageEvent([0].concat(e)):e}function I(e,t,n){var i=m(e,t),a=T(e,t,n),s=Object(c.unpackStore)(e);return Object(r.isOut)(a)?Object(o.oCacheGet)(e,s.id).name:a.userId!==a.peerId?!!Object(o.oCacheExists)(e,a.userId)&&Object(o.oCacheGet)(e,a.userId).name:i.tab}function T(e,t,n){var r=m(e,t),i=r&&r.msgs&&r.msgs[n];return i?E(i):null}function A(e,t,n){var r=m(e,t),i=r&&r.msgs&&Object.keys(r.msgs).sort((e,t)=>+e-t);if(!i)return null;var a=i&&i.indexOf(""+n),o=a>-1?i[a-1]:null;return r.msgs[o]}function C(e){var t=Object(c.unpackStore)(e);return t.gid||t.isClassic}function S(e){return Object(c.unpackStore)(e).gid}function P(e){return Object(c.unpackStore)(e).gid}function M(e){return!!Object(c.unpackStore)(e).gid}function D(e,t){return!!(t.peerId>2e9&&Object(u.doesChatTabHaveFlag)(t,1024))}function L(e,t){var n=Object(c.unpackStore)(t);return n.tabs[e]||n.mapped_index[e]}function x(e){var t=Object(c.unpackStore)(e);return!!M(e)&&((19542789===t.gid||103416369==t.gid)&&(t.active_tab===a.FOLDER_UNRESPOND||t.active_tab===a.FOLDER_UNREAD))}function R(e,t){var n=(e=Object(c.unpackStore)(e)).tabs;return!(!n||!n[t]||void 0===n[t].history||!n[t].msgs)}function N(e,t){var n=m(e,t);n&&(n.msgs=void 0,n.msgid=void 0,n.scrollTop=void 0,n.scrollBottom=void 0,n.contHeight=void 0,n.offset=void 0,n.skipped=void 0)}function F(e){var t=e.get().go_to_end_visible;return!!t&&t[0]}function B(e){var t=e.get().go_to_end_visible;return t?t[1]:0}function H(e){return!Object(c.unpackStore)(e).lockedSending}function G(e){return e>-2e9&&e<0}function U(e,t){return!!G(t)&&!!m(e,t).blocked_community}function q(e){return Object(c.unpackStore)(e).voice_message_available}function z(e){var t=Object(c.unpackStore)(e);return!(!$(t)&&!t.recentSearch)}function $(e){return Object(c.unpackStore)(e).searchText}function V(e,t){var n=Object(c.unpackStore)(e);return!!(t&&t!==$(e)||n.recentSearch)}function W(e){return Object(c.unpackStore)(e).recentSearch}function Y(e){var t=p(e);return t&&t.pinned&&E(t.pinned)}function K(e){var t=e.get().popular_sugg;return t&&t.length>0}function Q(e){return 1==Object(c.unpackStore)(e).isEditing}function X(e){return Object(c.unpackStore)(e).gid}function J(e){return e.draft||(e.draft=Object(s.loadDraftForPeer)(cur.imDb,e.peerId)),e.draft}function Z(e){return(Object(c.unpackStore)(e).templates||[]).filter(e=>!e.deleted)}function ee(e){return!!e&&Boolean(e.is_message_request||e.folders&a.FOLDER_MASKS[a.FOLDER_MESSAGE_REQUEST]||e.folders&a.FOLDER_MASKS[a.FOLDER_MESSAGE_REQUEST_REJECTED])}function te(e){return Object(d.isChatPeer)(e.peerId)&&ee(e)}function ne(e){return e&~a.FOLDER_MASKS[a.FOLDER_MESSAGE_REQUEST]&~a.FOLDER_MASKS[a.FOLDER_MESSAGE_REQUEST_REJECTED]}function re(e){return Object(c.unpackStore)(e).active_tab===a.FOLDER_MESSAGE_REQUEST}function ie(e){return e.peerId>19e8&&e.peerId<2e9}function ae(e){return!!Object(c.unpackStore)(e).dialog_tab_cts[a.FOLDER_MESSAGE_REQUEST]}function oe(e){var t=e.type,n=e.updateType;return t===i.CONVERSATION_UPDATED&&(n===i.MAIL_CHAT_UPDATE_TYPE_MESSAGE_REQUEST_CHANGED||n===i.MAIL_CHAT_UPDATE_TYPE_CONTACT_CONVERTED)}function se(e,t){return Object(u.doesChatTabHaveFlag)(m(e,t),u.MAIL_CHAT_FLAG_IS_COMMUNITY_CHAT)}function ce(e,t){return Object(u.doesChatTabHaveFlag)(m(e,t),u.MAIL_CHAT_FLAG_IS_COMMUNITY_CHAT_DELETED)}function ue(e,t){return Object(u.doesChatTabHaveFlag)(m(e,t),u.MAIL_CHAT_FLAG_DENY_ANYONE_TO_WRITE)}},rjmT:function(e,t,n){"use strict";n.r(t),n.d(t,"ImDraft",function(){return s}),n.d(t,"loadDraftForPeer",function(){return u});n("a1Th"),n("rE2o"),n("ioFf"),n("rGqo"),n("KKXr"),n("VRzm"),n("Btvt"),n("OEbY"),n("pIFo");var r=n("BxOC"),i=n("f01n"),a=n("vT4u");function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e,t){this._db=e,this._key=t,this.dData={txt:"",attaches:[],urlBinds:[],cancelled:[]},this.load()}function c(e){switch(e.type){case"mail":case"reply":return e.id<0&&1==e.object.fwd_count;default:return!e.object}}function u(e,t){return new s(e,"draft_"+t)}s.prototype.dump=function(){var e;this._key&&this._db.updateByKey(this._key,{txt:(e=this.dData).txt,attaches:e.attaches.length?e.attaches:void 0,urlBinds:e.urlBinds.length?e.urlBinds:void 0,cancelled:e.cancelled.length?e.cancelled:void 0})},s.prototype.load=function(){if(this._key){var e=this._db.selectByKey(this._key);e&&(this.dData=function(e){return{txt:e.txt,attaches:e.attaches||[],urlBinds:e.urlBinds||[],cancelled:e.cancelled||[]}}(e))}},s.prototype.clear=function(){this.dData={txt:"",attaches:[],urlBinds:[],cancelled:[]},this.dump()},s.prototype.setText=function(e){this.dData.txt=trim(e),this.dump()},s.prototype.addAttach=function(e,t,n){if(("share"===e&&this.removeAttachByType(e),"mail"!==e&&"reply"!==e||(this.removeAttachByType("mail"),this.removeAttachByType("reply")),"audio_playlist"===e||"artist"===e)&&this.dData.attaches.find(t=>t.type===e))return!1;if(!e||!t&&"poll"!==e)return!1;var r=this.dData.attaches.findIndex(n=>n.type===e&&n.id===t);-1===r?(this.dData.attaches.push({type:e,id:t,object:n}),this.dump()):"video"!==e&&"poll"!==e||(this.dData.attaches[r]={type:e,id:t,object:n},this.dump())},s.prototype.syncWithSelector=function(e){var t=this.getFwdRaw();this.dData.attaches=(t?[t]:[]).concat(e.getMedias().map(e=>{var t=o(e,2),n=t[0],r=t[1];return this.dData.attaches.find(e=>e.type==n&&e.id==r)||{type:n,id:r}})),this.dump()},s.prototype.removeAttachByType=function(e){for(var t=this.dData.attaches.length;t--;)this.dData.attaches[t].type===e&&this.dData.attaches.splice(t,1);this.dump()},s.prototype.removeAllAttaches=function(){this.dData.attaches=[],this.dData.cancelled=[],this.dump()},s.prototype.addBindUrl=function(e,t,n){this.getBoundAttach(e)||(this.dData.urlBinds.push({url:e,type:t,id:n}),this.dump())},s.prototype.getBoundAttach=function(e){var t=this.dData.urlBinds.find(t=>t.url===e);return t&&this.dData.attaches.find(e=>e.type===t.type&&e.id===t.id)||null},s.prototype.getShareUrl=function(){var e=this.dData.attaches.find(e=>"share"===e.type);if(e&&e.object)return e.object.url.replace(/&amp;/g,"&")},s.prototype.hasOnlyReplies=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?e.flags&i.FLAG_HAS_REPLY&&!this.dData.attaches.find(e=>"mail"!==e.type):this.hasAttaches()&&!this.dData.attaches.find(e=>"reply"!==e.type)},s.prototype.getCancelledShares=function(){return this.dData.cancelled.length?this.dData.cancelled:void 0},s.prototype.hasAttaches=function(){return this.dData.attaches.length>0},s.prototype.destroy=function(){this.dData={},this._key=this._db=null},s.prototype.prepareObjects=function(e,t){return this.dData.attaches.find(c)?Object(r.post)(a.CONTROLLER,{act:"draft_medias",gid:e,messageId:t||0,media:t?void 0:this.dData.attaches.map(e=>[e.type,e.id]).join("*")}).then(e=>{var t=o(e,1)[0];this.dData.attaches=t.map(e=>({type:e[0],id:e[1],object:e[2]}))}):Promise.resolve()},s.prototype.getFwdRaw=function(){return this.dData.attaches.find(e=>"mail"===e.type||"reply"===e.type)},s.prototype.getFwdCount=function(){var e=this.getFwdRaw();return e?e.id<0?e.object.fwd_count:e.id.split(";").length:0}},rudk:function(e,t,n){"use strict";n.r(t),n.d(t,"parseFwd",function(){return o}),n.d(t,"convertKludgesToAttaches",function(){return s}),n.d(t,"isReservedPeer",function(){return c}),n.d(t,"isUserPeer",function(){return u}),n.d(t,"isChatPeer",function(){return d}),n.d(t,"convertAttachesToPhpMedia",function(){return l});var r=n("jE6c");function i(e,t){void 0===t&&(t=[]);var n=e.split("_");return[n[0],n[1],t]}var a={};function o(e){if(a[e])return a[e];for(var t=e?e.length:0,n=[],r=[],o="",s=0;s<t;s++){var c=e[s],u=c.charCodeAt(0);u>=48&&u<=57||"_"===c||"-"===c?o+=c:"("!==c&&")"!==c&&":"!==c&&","!==c||(""!==o&&(r.push(o),n.push("id"),o=""),r.push(c),n.push(c))}o.length>0&&(r.push(o),n.push("id"));var d=function e(t,n,r,a){if(void 0===r&&(r=0),void 0===a&&(a=0),a>50)return[[],t.length];for(var o=[],s="";r<t.length;){var c=t[r];if("id"===c)s=n[r];else if(","===c&&s)o.push(i(s)),s="";else if("("===c){var u=e(t,n,r+1,a+1),d=u[0];r=u[1],o.push(i(s,d)),s=""}else if(")"===c)return""!==s&&o.push(i(s)),[o,r];r++}return s&&o.push(i(s)),[o,r]}(n,r)[0];return Object.keys(a).length>300&&(a={}),a[e]=d,d}function s(e,t){var n=[];e.fwd_count?n.push({type:"mail",id:-t,object:{fwd_count:e.fwd_count}}):e.fwd&&n.push({type:"mail",id:-t,object:{fwd_count:o(e.fwd).length}});for(var i=1;e["attach"+i+"_type"];++i)"call"===e["attach"+i+"_type"]?n.push({type:e["attach"+i+"_type"],id:e["attach"+i],initiatorId:Object(r.intval)(e["attach"+i+"_call_initiator_id"]),state:e["attach"+i+"_call_state"],duration:Object(r.intval)(e["attach"+i+"_call_duration"]),receiverId:Object(r.intval)(e["attach"+i+"_call_receiver_id"])}):n.push({type:e["attach"+i+"_type"],id:e["attach"+i],kind:e["attach"+i+"_kind"],productId:e["attach"+i+"_product_id"]});return e.geo&&n.push({type:"geo",id:e.geo}),n}function c(e){return 0==e}function u(e){return e>0&&e<2e9}function d(e){return e>2e9}function l(e){return e.map(function(e){var t="audiomsg"===e[2]?"audio_message":e[2];return e[0]+":"+e[1]+":"+t}).join(",")}},uytb:function(e,t,n){"use strict";n.r(t),n.d(t,"RECENT_SEARCH_OP",function(){return i}),n.d(t,"PIN_HIDDEN_ID_OP",function(){return a}),n.d(t,"deleteOldStoredFormat",function(){return u}),n.d(t,"mount",function(){return d});n("a1Th"),n("Btvt"),n("rE2o"),n("ioFf"),n("rGqo");function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i="recent_search",a="pin_hide";function o(e){return"im_store_"+e}function s(e){return ls.get(o(e))||{}}function c(e,t,n){if(ls.checkVersion()){var r=JSON.stringify(t);rand(0,1e5)<=1&&statlogsValueEvent("im_local_store_size",r.length),n(o(e),r)}}function u(e,t){for(var n=["fwd","draft","bind_attach"],r=s(e),i=!1,a=n.length;a--;)n[a]in r&&(delete r[n[a]],i=!0);i&&c(e,r,t)}function d(e){var t=debounce((e,t)=>{localStorage.setItem(e,t)},300);ls.checkVersion()&&u(e,t);var n={db:s(e),checkTime:Date.now()},d=function(e,t,n){n.key===o(e)&&(t.db=JSON.parse(n.newValue),t.checkTime=Date.now())}.bind(null,e,n);return window.addEventListener("storage",d,!1),{select:(t,r)=>(Date.now()-n.checkTime>1e3&&(n.db=s(e)),function(e,t,n){return t===i?e[t]||[]:t===a?e[t]&&e[t][n]:e[t]?extend(!0,{},e[t][n]):null}(n.db,t,r)),selectByKey:t=>(Date.now()-n.checkTime>1e3&&(n.db=s(e)),n.db[t]),update(o,s){var u=function(e,t,n){switch(e[t]||(e[t]={}),t){case i:var o=n;o&&o.length>0?e[t]=o:delete e[t];break;case a:var s=r(n,2),c=s[0],u=s[1];u?e[t][c]=+u:delete e[t][c]}return e}(n.db,o,s);return n.db=u,n.checkTime=Date.now(),c(e,u,t)},updateByKey:(r,i)=>(n.db[r]=i,n.checkTime=Date.now(),c(e,n.db,t)),unmount(){window.removeEventListener("storage",d,!1)}}}},vT4u:function(e,t,n){"use strict";n.r(t),n.d(t,"CONTROLLER",function(){return k}),n.d(t,"ACTIVITY_PERIOD",function(){return j}),n.d(t,"ACTIVITY_TYPE_TYPING",function(){return E}),n.d(t,"ACTIVITY_TYPE_RECORDING_AUDIO",function(){return I}),n.d(t,"ACTION_PRIORITIES",function(){return P}),n.d(t,"loadHashes",function(){return M}),n.d(t,"strHistory",function(){return R}),n.d(t,"updateBlockStates",function(){return N}),n.d(t,"loadPeer",function(){return F}),n.d(t,"restoreHistoryQueue",function(){return B}),n.d(t,"removeFailed",function(){return H}),n.d(t,"selectPeer",function(){return U}),n.d(t,"selectPeerOnMessage",function(){return z}),n.d(t,"changePeer",function(){return $}),n.d(t,"updateMentions",function(){return V}),n.d(t,"setActions",function(){return W}),n.d(t,"loadMoreHistory",function(){return Y}),n.d(t,"loadLessHistory",function(){return K}),n.d(t,"readLastMessages",function(){return X}),n.d(t,"markAudioMessageAsListened",function(){return J}),n.d(t,"loadLongPollKey",function(){return Z}),n.d(t,"loadLongPollTs",function(){return ee}),n.d(t,"setMessageErrored",function(){return te}),n.d(t,"resendMessage",function(){return ne}),n.d(t,"loadAdmins",function(){return ie}),n.d(t,"updateVideoThumb",function(){return se}),n.d(t,"editMessage",function(){return ce}),n.d(t,"addMessage",function(){return ue}),n.d(t,"markInboundMessagesAsRead",function(){return le}),n.d(t,"markOutboundMessagesAsRead",function(){return _e}),n.d(t,"initTextStore",function(){return he}),n.d(t,"processFwd",function(){return ge}),n.d(t,"mergeTabs",function(){return fe}),n.d(t,"updateOnline",function(){return me}),n.d(t,"setActivity",function(){return pe}),n.d(t,"updateActivity",function(){return be}),n.d(t,"waitActivity",function(){return ve}),n.d(t,"sendMessage",function(){return Oe}),n.d(t,"deliverMessage",function(){return we}),n.d(t,"deliverEditedMessage",function(){return ke}),n.d(t,"addSelection",function(){return je}),n.d(t,"cleanSelected",function(){return Ee}),n.d(t,"dropSelection",function(){return Ie}),n.d(t,"replaceMessage",function(){return Te}),n.d(t,"saveMedia",function(){return Ae}),n.d(t,"loadMedia",function(){return Ce}),n.d(t,"addAttachmentsToStoreData",function(){return Se}),n.d(t,"replaceMediaAttachesStore",function(){return Pe}),n.d(t,"setCurrentSearchDate",function(){return Me}),n.d(t,"setInplaceSearch",function(){return De}),n.d(t,"setCurrentSearch",function(){return Le}),n.d(t,"searchHints",function(){return xe}),n.d(t,"searchHintsIndex",function(){return Re}),n.d(t,"localIndexToDialog",function(){return Ne}),n.d(t,"searchTopConv",function(){return Be}),n.d(t,"searchImTopConv",function(){return He}),n.d(t,"searchLocalHints",function(){return Ge}),n.d(t,"preloadSearchIndex",function(){return Ue}),n.d(t,"loadDialogs",function(){return qe}),n.d(t,"searchMessages",function(){return ze}),n.d(t,"isSearchAllLoaded",function(){return $e}),n.d(t,"isSearchingInplace",function(){return Ve}),n.d(t,"cancelSearch",function(){return We}),n.d(t,"clearDate",function(){return Ye}),n.d(t,"searchInplaceStart",function(){return Ke}),n.d(t,"searchMessagesInplace",function(){return Qe}),n.d(t,"loadImportant",function(){return Xe}),n.d(t,"loadActualLastMessage",function(){return Je}),n.d(t,"removeMessagesMarkDeleted",function(){return Ze}),n.d(t,"removeMessages",function(){return et}),n.d(t,"removeMessageSend",function(){return tt}),n.d(t,"removeMessagesWithRestore",function(){return nt}),n.d(t,"restoreMessage",function(){return rt}),n.d(t,"restoreMessageSend",function(){return it}),n.d(t,"acceptMessageRequest",function(){return ot}),n.d(t,"rejectMessageRequest",function(){return st}),n.d(t,"cancelMessageRequest",function(){return ct}),n.d(t,"sendTyping",function(){return ut}),n.d(t,"sendRecordingAudio",function(){return dt}),n.d(t,"forwardMessages",function(){return lt}),n.d(t,"prepareForward",function(){return _t}),n.d(t,"deletedDialog",function(){return ht}),n.d(t,"flushHistory",function(){return gt}),n.d(t,"updateChatTopic",function(){return ft}),n.d(t,"loadChatInfo",function(){return mt}),n.d(t,"addNewMemberOptimisticly",function(){return pt}),n.d(t,"addNewMember",function(){return bt}),n.d(t,"loadChatMember",function(){return vt}),n.d(t,"checkNewPeople",function(){return yt}),n.d(t,"loadNewPeople",function(){return Ot}),n.d(t,"updateChatPhoto",function(){return wt}),n.d(t,"updateActions",function(){return kt}),n.d(t,"leaveChat",function(){return jt}),n.d(t,"returnToChat",function(){return Et}),n.d(t,"toggleMutePeer",function(){return It}),n.d(t,"setMutedPeer",function(){return Tt}),n.d(t,"setExecStack",function(){return At}),n.d(t,"favMessage",function(){return Ct}),n.d(t,"updateFavMessage",function(){return St}),n.d(t,"updateImportant",function(){return Pt}),n.d(t,"loadSpam",function(){return Mt}),n.d(t,"flushSpam",function(){return Dt}),n.d(t,"setCreationType",function(){return Lt}),n.d(t,"getOwnerPhoto",function(){return xt}),n.d(t,"presetAvatar",function(){return Rt}),n.d(t,"setChatPhoto",function(){return Nt}),n.d(t,"createChat",function(){return Ft}),n.d(t,"createCommunityChat",function(){return Bt}),n.d(t,"resync",function(){return Ht}),n.d(t,"toggleSendingAbility",function(){return Gt}),n.d(t,"setDelayedMessage",function(){return Ut}),n.d(t,"isAnythingLoading",function(){return qt}),n.d(t,"updateUnreadCount",function(){return zt}),n.d(t,"changeSubmitSettings",function(){return $t}),n.d(t,"updateFavAndTitle",function(){return Vt}),n.d(t,"saveHistoryScroll",function(){return Wt}),n.d(t,"filterFromTab",function(){return Yt}),n.d(t,"changeDialogsTab",function(){return Kt}),n.d(t,"updateFolderState",function(){return Xt}),n.d(t,"toggleDialogImportant",function(){return Jt}),n.d(t,"markDialogAnswered",function(){return Zt}),n.d(t,"getMutexQueue",function(){return en}),n.d(t,"releaseBlock",function(){return tn}),n.d(t,"toggleCommunityMute",function(){return nn}),n.d(t,"deleteDialog",function(){return rn}),n.d(t,"restoreDialog",function(){return an}),n.d(t,"spamDialog",function(){return on}),n.d(t,"updateTabbedPeers",function(){return sn}),n.d(t,"isEverythingLoaded",function(){return cn}),n.d(t,"cleanTab",function(){return un}),n.d(t,"stringifyTab",function(){return dn}),n.d(t,"updateGoToEndVisibility",function(){return ln}),n.d(t,"toggleCommunityMessages",function(){return _n}),n.d(t,"updateHistory",function(){return hn}),n.d(t,"syncHistory",function(){return gn}),n.d(t,"startRecording",function(){return fn}),n.d(t,"cancelRecording",function(){return mn}),n.d(t,"setVoiceMessageAvail",function(){return pn}),n.d(t,"toggleConversation",function(){return bn}),n.d(t,"updateSearchQuery",function(){return vn}),n.d(t,"initializeChatResize",function(){return yn}),n.d(t,"joinChat",function(){return On}),n.d(t,"getInviteLink",function(){return wn}),n.d(t,"resetInviteLink",function(){return kn}),n.d(t,"leaveInvitation",function(){return jn}),n.d(t,"saveRecentSearchPeer",function(){return En}),n.d(t,"resetRecentSearch",function(){return In}),n.d(t,"removeFromRecentSearch",function(){return Tn}),n.d(t,"pinMessageOptimistic",function(){return An}),n.d(t,"unpinMessageOptimistic",function(){return Cn}),n.d(t,"pinMessage",function(){return Sn}),n.d(t,"unpinMessage",function(){return Pn}),n.d(t,"getPinnedMessage",function(){return Mn}),n.d(t,"getMessageLocalId",function(){return Dn}),n.d(t,"getChatMembers",function(){return Ln}),n.d(t,"getChatDetails",function(){return xn}),n.d(t,"updateFlags",function(){return Rn}),n.d(t,"removeChatPhoto",function(){return Nn}),n.d(t,"kickUserOptimisticly",function(){return Fn}),n.d(t,"kickUser",function(){return Bn}),n.d(t,"toggleAdminOptimisticly",function(){return Hn}),n.d(t,"toggleAdmin",function(){return Gn}),n.d(t,"checkChatMember",function(){return Un}),n.d(t,"hidePromoTooltip",function(){return qn}),n.d(t,"videoAutoPlayHandler",function(){return zn}),n.d(t,"hideTopBannerAction",function(){return $n}),n.d(t,"callbackTopBannerAction",function(){return Vn}),n.d(t,"loadBanner",function(){return Wn}),n.d(t,"setKeyboard",function(){return Yn}),n.d(t,"deleteKeyboard",function(){return Kn}),n.d(t,"toggleKeyboard",function(){return Qn}),n.d(t,"loadKeyboard",function(){return Xn}),n.d(t,"changeCommunityAccess",function(){return Jn}),n.d(t,"deleteTemplate",function(){return Zn}),n.d(t,"createTemplate",function(){return er}),n.d(t,"updateTemplate",function(){return tr}),n.d(t,"resetTabAll",function(){return nr}),n.d(t,"updateMessageRequestsCounter",function(){return rr});n("rE2o"),n("ioFf"),n("a1Th"),n("OG14"),n("OEbY"),n("Vd3H"),n("tUrg"),n("91GP"),n("SRfc"),n("rGqo"),n("VRzm"),n("Btvt");var r=n("BxOC"),i=n("bIHZ"),a=n("f01n"),o=n("DM26"),s=n("rudk"),c=n("aong"),u=n("uytb"),d=n("P13b"),l=n("h++7"),_=n("rHUl"),h=n("MhhX"),g=n("86+7"),f=n("ERyv"),m=n("Wu9C"),p=n("lJdi"),b=n("O8ze"),v=n("zxIV"),y=n("XzvV");function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var k="al_im.php",j=5,E="typing",I="audiomessage",T=Object(i.updateLazyLocation)(),A=T.scheduleNav,C=T.commitNav,S=T.scheduleNavWithTimeOut;var P={settings:0,block:1,fav:1,chat:2,invite:2,invite_link:3,topic:3,avatar:4,photos:5,search:6,pin_hide:7,pin_unhide:7,unpin:8,mute:10,unmute:10,clear:11,leave:12,return:12,block_community:12,allow_community:12,block_notify:12};function M(e,t,n){return Object(r.post)(k,{act:"a_renew_hash",peers:e.join(","),gid:t.hidegid?void 0:n.gid})}function D(e,t,n){return function(e){return e.resync_in_process?e.resync_in_process:Promise.resolve(!1)}(e).then(r=>r?t(...n):function(e){if(!e.renew_hashes){var t=e.last_hashes_update||0;if(Date.now()-t<1e4)return Promise.resolve();var n=Object.keys(e.tabs).filter(t=>Object(d.isFullyLoadedTab)(e,t));e.renew_hashes=M(n,{},e).then(t=>{var r=w(t,2),i=r[0],a=r[1];return n.forEach(t=>{e.tabs[t].hash=i[t]}),e.writeHash=a,delete e.renew_hashes,e.last_hashes_update=Date.now(),e})}return e.renew_hashes}(e).then(e=>t(...n)))}function L(e){return function(){var t=arguments,n=t[t.length-1];return e(...t).catch(r=>{if(r&&r.match&&r.match(/1001;/))return D(n,e,t);throw r})}}function x(e){return"string"==typeof e?Object(v.se)(`<div>${e}</div>`):e}function R(e){return"string"==typeof e?e:e.innerHTML}function N(e,t){return t.block_states=extend(t.block_states,e),Promise.resolve(t)}function F(e,t,n,i,a){return a.tabHistoryNotChanged=!1,Object(o.retryFn)(r.post,3,e=>e-1)(k,{act:"a_start",peer:e,msgid:n,history:t,prevpeer:a.prevPeer,gid:a.gid,block:i}).then(t=>{var r=w(t,5),i=r[0],o=r[1],s=r[2],c=r[3],u=r[4];if(o.forEach(e=>Object(g.oCacheAdd)(a,e)),a.tabs||(a.tabs={}),a.dialog_tab_cts=Object.assign({},u,{[l.FOLDER_MESSAGE_REQUEST]:a.dialog_tab_cts[l.FOLDER_MESSAGE_REQUEST]}),a.tabs[e]||(a.tabs[e]=Object(d.normalizeTab)(a,i)),N(c,a),n){if(a.tabs[e]){var _=a.tabs[e].lastmsg,h=a.tabs[e].lastmsg_meta;extend(a.tabs[e],i),a.tabs[e].lastmsg=_,a.tabs[e].lastmsg_meta=h}}else extend(a.tabs[e],i);return a.admins=extend(a.admins,s),a.imQueue(e,!1),zn(),B(e,a)}).catch(e=>Object(f.imWeirdCatch)("loadPeer",e))}function B(e,t){var n=t.imQueue(e,!1),r=t.tabs[e],i=n.filter(n=>!Object(_.isRidExist)(t,e,n.rid));return r.msgs=i.reduce((e,t)=>(e["rid"+t.rid]=t.mess,e),r.msgs),t.imQueueSet(e,i),t.tabs[e].history=Object(d.restoreQueue)(i,t,x(t.tabs[e].history)),Promise.resolve(t)}function H(e,t,n){var r=n.imQueue(e,!1).filter(e=>e.failed&&e.mess.messageId!==t);return n.imQueueSet(e,r),n.tabs[e].history=Object(d.removeMessages)([t],x(n.tabs[e].history)),Promise.resolve(n)}function G(e,t){return!1===(t.block_states[e]||{}).free?Promise.resolve(t):Object(r.post)(k,{act:"a_block",peer:e,prevPeer:t.prevPeer,gid:t.gid}).then(e=>{return N(w(e,1)[0],t)})}function U(e,t){var n=t.peer;return Promise.resolve(t).then(t=>(t.tabHistoryNotChanged=!1,Object(d.isFullyLoadedTab)(t,n)&&!t.tabs[n].msgid?(t.gid&&G(n,t),Promise.resolve(t).then(W)):(Object(d.isFullyLoadedTab)(t,n)&&(t.tabs[n].msgid=!1),F(n,e,!1,!0,t)))).then(W).then(q.bind(null,n))}function q(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(d.isTabLoaded)(t,e)&&(t.tabs[e].last_touched=Date.now()),Object(d.isTabLoaded)(t,e)&&n&&(t.tabs[e].last_visited=Date.now()),t}function z(e,t,n){var r=n.msgid,i=n.peer;return!e&&Object(d.isFullyLoadedTab)(n,i)&&n.tabs[i].msgs[r]?(t===n.peer?n.tabHistoryNotChanged=!0:n.tabHistoryNotChanged=!1,n.gid&&G(i,n),Promise.resolve(n).then(W).then(q.bind(null,i))):F(i,!0,r,!0,n).then(W).then(()=>{return Object(_.getTab)(n,i).msgid=r,n}).then(q.bind(null,i))}function $(e,t,n,r){if(qt(r))throw Object(d.showWaitUntilUploadedBox)(),new Error("Cant change peer while loading something");var i=r.gid?"gim"+r.gid:"im";if(r.prevPeer=r.peer,r.peer=e,r.msgid=t||"",r.currentEntryPoint=n,cur.peer=e,A({sel:e?Object(d.convertPeerToUrl)(e):null,msgid:r.msgid,email:"",0:i}),0!=r.prevPeer&&q(r.prevPeer,r,!0),0!==e){Object(d.isTabLoaded)(r,e)&&q(e,r,!0),sn(r.tabbedPeers.map(e=>e.peer).indexOf(e)<0?[{peer:e,type:"perm"}].concat(r.tabbedPeers):r.tabbedPeers.map(t=>(t.peer==e&&"perm"!==t.type&&(t.type="perm"),t)),!1,r)}else sn(r.tabbedPeers,!1,r);return C(),We(r.prevPeer,r)}function V(e){cur.wallMentions=()=>new Promise((t,n)=>{if(cur.wallMentions=[],!Object(d.isChatPeer)(e.peer)||!Object(d.isFullyLoadedTab)(e,e.peer)||Object(d.isFvkcomgroup)(e,e.peer))return n();var r=e.tabs[e.peer];function i(){var n=[];Object.keys(r.msgs||{}).reverse().forEach(e=>{var t=Object(_.parserMessage)(r.msgs[e]),i=t&&t.userId;i&&i!=vk.id&&-1===n.indexOf(i)&&Object(d.isUserAliveInChat)(r,i)&&n.push(i)}),(r.memberIds||[]).forEach(e=>{-1===n.indexOf(e)&&n.push(e)});var i=[];n.forEach(t=>{if(Object(g.oCacheExists)(e,t)){var n=Object(g.oCacheGet)(e,t),r=n.link.substring(1);i.push([n.id,n.name,"@"+r,n.photo,void 0,void 0,void 0,r,n.first_name])}}),t(i)}r.membersLoaded?i():Ln(e.peer,e).then(i)})}function W(e){var t=e.peer;if(0===t)return Promise.resolve(e);var n=e.tabs[t],r=[],i=Object(d.isChatPeer)(t)&&(n.data.closed||n.data.kicked),a=Object(d.isFvkcomgroup)(e,t),o=Object(_.isCommunityChat)(e,t);n.offset&&r.push("photos"),n.offset&&r.push("search"),(t<-2e9||n.offset)&&!a&&r.push("clear"),!Object(d.isCommunityInterface)(e)||a||o||r.push("block"),a&&!i&&r.push("settings"),Object(d.isCommunityPeer)(t)&&(n.can_send_notify?r.push("block_notify"):r.push(n.blocked_community?"allow_community":"block_community")),!Object(d.isCommunityInterface)(e)&&(Object(d.isChatPeer)(t)||Object(d.isUserPeer)(t)||Object(d.isCommunityPeer)(t))&&(Object(d.isChatPeer)(t)&&(n.data.kicked||n.data.closed)||r.push(inArray(t,e.mutedPeers)?"unmute":"mute")),Object(d.isUserPeer)(t)&&!e.gid&&!n.blacklisted&&n.is_friend&&r.push("invite"),Object(d.isChatPeer)(t)&&!i&&(Object(p.canInviteUser)(e)&&r.push("invite"),e.gid||r.push("leave")),Object(d.isChatPeer)(t)&&n.data.closed&&!n.data.kicked&&r.push("return"),Object(d.isChatPeer)(t)&&n.pinned&&(r.push(Object(m.isPinnedMessageVisibleInTab)(e,t)?"pin_hide":"pin_unhide"),Object(p.canPinOrUnpin)(e)&&r.push("unpin"));var s=Object(d.chatActions)(e,a);return e.curActions=r.sort((e,t)=>P[e]-P[t]).reduce((e,t)=>(e[t]=s[t],e),{}),Promise.resolve(e)}function Y(e,t,n){var i=n.tabs[n.peer];return Object(r.post)(k,{peer:n.peer,whole:e,act:"a_history",offset:i.offset+(i.skipped||0),toend:t,gid:n.gid}).then(e=>{var t=w(e,4),r=t[0],a=t[1],o=t[2],s=t[3];return i.allShown=o,n.admins=extend(n.admins,s),i.history=r+R(i.history),i.historyToAppend=r,i.offset+=Object.keys(a).length,i.msgs=extend(i.msgs,a),n})}function K(e){var t=e.tabs[e.peer];return Object(r.post)(k,{peer:e.peer,act:"a_history",rev:1,offset:t.skipped,gid:e.gid}).then(n=>{var r=w(n,5),i=r[0],a=r[1],o=r[2];r[3],r[4];t.allShown=t.allShown||o,t.history=R(t.history)+i,t.historyToAppend=i;var s=Object.keys(a).length;return t.skipped-=s,t.offset+=s,t.msgs=extend(t.msgs,a),e})}function Q(e,t,n,r){var i=e.tabs[t];return r===a.FLAG_OUTBOUND&&i.out_up_to>n?e:(r===a.FLAG_OUTBOUND?i.out_up_to=n:i.in_up_to=n,e)}var X=L(function(e,t){if(Object(d.tabIsMessageRequest)(t.tabs[e]))return Promise.resolve(t);var n=t.tabs[e],i=n.msgs||{},o=Object.keys(i).map(n=>Object(_.getMessage)(t,e,n)).filter(e=>!Object(h.isOut)(e)).map(e=>e.messageId).sort((e,t)=>t-e);return n.skipped>0&&(o=o.filter(e=>intval(e)<=n.lastmsg-n.skipped)),(o=intval(o.shift()))<=n.in_up_to?Promise.resolve(t):(t.longpoll.push([a.readInboundEvent([6,e,o])]),Object(r.post)(k,{peer:e,ids:[o],hash:n.hash,act:"a_mark_read",gid:t.gid}).then(()=>Q(t,e,o,a.FLAG_OUTBOUND)).catch(()=>{}))}),J=L(function(e,t,n){var i=n.tabs[e];return Object(r.post)(k,{peer:e,id:t,hash:i.hash,act:"a_mark_listened",gid:n.gid})});function Z(e){return Object(r.post)(k,{act:"a_get_key",uid:e.id,gid:e.gid}).then(t=>{var n=w(t,3),r=n[0],i=n[1],a=n[2];return extend({},e,{imKey:r,imUrl:i,imPart:a})})}function ee(e){return Object(r.post)(k,{act:"a_get_ts",gid:e.gid}).then(t=>{var n=w(t,1)[0];return extend({},e,{imTs:n})})}function te(e,t,n){var r=n.tabs[e];return r.msgs[t.messageId]&&(r.msgs[t.messageId].errored=1,r.history=Object(d.setMessageError)(e,t,x(r.history))),Promise.resolve(n)}function ne(e,t,n,r){var i=r.tabs[e];return i.msgs[t]&&(i.msgs[t].errored=0,i.lastmsg_meta=n,i.lastmsg=t,i.history=Object(d.startResendMessage)(e,t,x(i.history))),Promise.resolve(r)}function re(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];t.deletedDialog||(e.dialog_tabs=Object.keys(e.dialog_tabs).reduce((e,a)=>(!n&&!Yt(a)(t)||i&&!i(a,e[a],t)||(e[a]=Object(c.arrayUnique)(r(e[a],a))),e),e.dialog_tabs))}function ie(e,t){return 0===e.length?Promise.resolve(t):Object(r.post)(k,{act:"a_get_admin",admins:e.join(","),gid:t.gid}).then(e=>{var n=w(e,1)[0];return t.admins=extend(t.admins,n),t})}function ae(e,t){if(!inArray(e,t.tabbedPeers.map(e=>e.peer))&&(0!==t.peer||t.searchText)&&!inArray(e,t.mutedPeers)){var n={peer:e,type:"temp"};sn(t.tabbedPeers.concat([n]),!1,t)}}function oe(e,t,n){return Object(d.isReversedDialogs)(n)?t.concat([e]):[e].concat(t)}function se(e,t){var n=e.get().peer,r=Object(_.getTab)(e,n);if(Object(d.isFullyLoadedTab)(e,n)){var i=x(r.history);r.history=Object(d.updateMessageInCache)(e,i,t)}}function ce(e,t){var n=Object(_.getTab)(t,e.peerId);if(Object(d.isFullyLoadedTab)(t,e.peerId)){var r=x(n.history);n.msgs[e.messageId]=extend(!0,{},e),n.history=Object(d.editAndReplaceMessage)(t,e,r)}n&&n.lastmsg==e.messageId&&(n.lastmsg_meta=e);var i=n&&n.pinned&&Object(_.parserMessage)(n.pinned);return i&&i.messageId==e.messageId&&(n.pinned=e),Promise.resolve(t)}function ue(e,t){var n=e.flags&a.FLAG_OUTBOUND,r=e.peerId;if(Object(d.isTabLoaded)(t,r)){var i=t.tabs[r];if(i.deletedDialog=!1,!t.msg_local_ids_sort&&e.local?t.msg_local_ids_sort={[e.messageId]:0}:e.local&&(t.msg_local_ids_sort[e.messageId]=Object.keys(t.msg_local_ids_sort).length),n||Object(d.tabIsMessageRequest)(i)?i.unread=0:(i.lastmsg==e.messageId&&i.unread?de(t,1,e.peerId):(!i.unread&&de(t,1,e.peerId),i.unread++),ae(e.peerId,t)),Object(d.isFullyLoadedTab)(t,r)){var o=x(i.history);i.skipped>0&&i.skipped++,i.offset++,i.msgs[e.messageId]=extend(!0,{},e),i.history=Object(d.appendToHistory)(t,e,o,!0,!0,!0),Object(h.isOut)(e)&&(i.blocked_community=0,W(t))}if(i.typing){var s=i.typing.userIds.indexOf(e.userId);s>=0&&i.typing.userIds.splice(s,1)}return i.lastmsg=e.messageId,i.lastmsg_meta=e,q(e.peerId,t),re(t,i,!1,oe.bind(null,r),Qt.bind(null,t)),Promise.resolve(t)}return F(r,0,0,0,t).then(t=>{return re(t,t.tabs[r],!1,oe.bind(null,r),Qt.bind(null,t)),q(e.peerId,t),n||ae(e.peerId,t),t})}function de(e,t,n){e.cur_unread_cnt||(e.cur_unread_cnt={}),-1===t&&delete e.cur_unread_cnt[n],e.unread_cnt+=t}function le(e,t){if(Object(d.isFullyLoadedTab)(t,e.peerId)){var n=t.tabs[e.peerId],r=n.unread;if(t=Q(t,e.peerId,e.upToId,0),null!=e.unread?n.unread=e.unread:n.unread=e.upToId>=n.lastmsg?0:Object(_.countUnread)(e.peerId,t)+(n.unread>0?+n.skipped:0),r>0&&!n.unread&&de(t,-1,e.peerId),!n.skipped){var i=x(n.history);n.history=Object(d.removewNewUnreadBarAndMerge)(t,i,e.peerId)}}else Object(d.isTabLoaded)(t,e.peerId)&&(t.tabs[e.peerId].unread>0&&de(t,-1,e.peerId),t.tabs[e.peerId].unread=0,t.tabs[e.peerId].in_up_to=e.upToId);return Object(d.isTabLoaded)(t,e.peerId)&&(t.dialog_tabs[l.FOLDER_UNREAD]=t.dialog_tabs[l.FOLDER_UNREAD].filter(t=>intval(t)!==e.peerId)),0!==t.unread_cnt||t.active_tab!==l.FOLDER_UNREAD||t.gid?Promise.resolve(t):Kt(l.FOLDER_ALL,t)}function _e(e,t){var n=t.tabs[e.peerId];if(Object(d.isTabLoaded)(t,e.peerId)&&Q(t,e.peerId,e.upToId,a.FLAG_OUTBOUND),Object(d.isFullyLoadedTab)(t,e.peerId)){var r=x(n.history);n.history=Object(d.markMessagesAsRead)(t,e.peerId,r)}return Promise.resolve(t)}function he(e,t,n,r,i){return i.text={},i.imQueue=e,i.imQueueResend=t,i.imQueueSet=n,i.imQueueComplete=r,Promise.resolve(i)}function ge(e,t,n){function r(e,t){return{id:e.messageId,text:e.text,date:e.date,kludges:e.kludges,authorName:t}}if(1===e.length){var i=e[0],a=Object(_.getMessage)(n,t,i),o=Object(_.getAuthorFullName)(n,t,i);return!1===o?n.set(vt.bind(null,{[t]:[a.userId]})).then(n=>{var o=Object(_.getAuthorFullName)(n,t,i);return{msgIds:e,object:r(a,o)}}):Promise.resolve({msgIds:e,object:r(a,o)})}return Promise.resolve({msgIds:e})}function fe(e,t){Object(d.normalizeTabsGotFromServer)(t,e);var n=t.tabs[t.peer];return t.tabs=Object.keys(e).reduce((n,r)=>{var i=t.tabs[r]?t.tabs[r].msgs:{},a=extend({},i||{},e[r].msgs||{});return n[r]=extend(t.tabs[r]||{},e[r]),a&&(n[r].msgs=a),e[r].lastmsg||(n[r].lastmsg=!1),n},t.tabs),n&&(t.tabs[t.peer]=n),Promise.resolve(t)}function me(e,t,n,r){var i=Object(_.getTab)(r,e);if(i&&i.last_seen&&i.last_seen.can_see){var a=!1!==t?mobPlatforms[t]?1:0:i.last_seen.mobile;i.online=t,i.last_seen={platform:t,time:n||i.last_seen.time,mobile:a,can_see:i.last_seen.can_see}}return Promise.resolve(r)}function pe(e,t,n){var r=Object(_.getTab)(n,e.peerId);return r&&(e.ts=Date.now()/1e3,r.activity||(r.activity={}),r.activity[t]=e,r.typing===E&&(r.typing=e)),Promise.resolve(n)}function be(e,t){var n=Object(_.getTab)(t,e.peerId),r=Object(h.isAudioMsg)(e)?"audiomessage":"typing";return n&&n.activity&&n.activity[r]&&(n.activity[r].userIds=n.activity[r].userIds.filter(t=>t!==e.userId)),Promise.resolve(t)}function ve(e,t,n){var r=e.peerId;return Object(o.pause)(j+2).then(()=>{if(Object(d.isTabLoaded)(n,r)){var e=n.tabs[r];if((e.activity||{})[t])Date.now()-1e3*e.activity[t].ts>=1e3*j&&(delete e.activity[t],0===Object.keys(e.activity)&&delete e.activity);if(e.typing)Date.now()-1e3*e.typing.ts>=1e3*j&&(e.typing=void 0)}return n})}function ye(e){var t={},n=e.find(e=>"poll"===e[0]);if(n){var r=w(n,3)[2];Object.assign(t,r)}return t}var Oe=function(e,t,n,i){var a=Date.now()+rand(0,100).toFixed(0),o=i.ref_id,c=i.ref_source;i.ref_source=void 0,i.ref_id=void 0,(c||o)&&(A({ref_source:null,ref:null}),C()),Object(b.statlogsSendingQueueLength)(i);var u=t.attaches.length>0,d=Object(b.statlogsSendingTime)(i,"send","server",u),l=Object.assign({act:"a_send",to:e,hash:n.hash,ref_source:c,ref:o,msg:t.message,payload:t.payload,media:Object(s.convertAttachesToPhpMedia)(t.attaches),guid:a,share_url:t.share_url,cancelled_shares:t.cancelled_shares,random_id:t.rid,gid:n.hidegid?void 0:i.gid,entrypoint:i.currentEntryPoint||"",sticker_referrer:t.sticker_referrer},n.external,ye(t.attaches));return Object(r.post)(k,l,2e4).then(e=>{var t=w(e,1)[0];return d(),i.version!==t.version&&nav.reload({force:!0}),i.currentEntryPoint="",i}).catch(e=>{throw Object(b.statlogsSendingError)(i,e,"send","server_send"),e})},we=L(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0,i=r.tabs[e];return Oe(e,t,O({hash:i.hash},n),r)}),ke=L(function(e,t,n){var i=t.attaches.length>0,a=Object(b.statlogsSendingTime)(n,"edit","server",i);return Object(r.post)(k,Object.assign({act:"a_edit_message",hash:e.hash,id:t.messageId,peerId:e.peerId,gid:n.gid,msg:t.origText,media:Object(s.convertAttachesToPhpMedia)(t.attaches),share_url:t.share_url,cancelled_shares:t.cancelled_shares},ye(t.attaches)),2e4).then(e=>{w(e,1)[0];return a(),n}).catch(e=>{throw Object(b.statlogsSendingError)(n,e,"edit","server_send"),e})});function je(e,t){if(t.selectedMessages||(t.selectedMessages=[]),1===e.length&&inArray(e[0],t.selectedMessages))t.selectedMessages=t.selectedMessages.filter(t=>t!==e[0]);else{var n=t.selectedMessages.concat(e);t.selectedMessages=Object(c.arrayUnique)(n).sort((e,t)=>e-t)}return Promise.resolve(t)}function Ee(e){return e.selectedMessages=[],Promise.resolve(e)}function Ie(e){return e.selectedMessages=[],Promise.resolve(e)}function Te(e,t){if(Object(d.isFullyLoadedTab)(t,e.peerId)){var n=t.tabs[e.peerId],r=t.imQueue(e.peerId).filter(t=>t.failed&&t.rid!==e.randomId);t.imQueueSet(e.peerId,r),t.imQueueComplete(e.peerId,e.randomId),n.lastmsg_meta=e,n.lastmsg=e.messageId,n.msgs["rid"+e.randomId]&&(n.msgs[e.messageId]=e,delete n.msgs["rid"+e.randomId]),n.history=Object(d.replaceMessageAttrs)(t,x(n.history),e)}return Promise.resolve(t)}function Ae(e,t){return Promise.resolve()}function Ce(e,t){var n=Object(b.statlogsSendingTime)(t,"unknown","attach"),i={act:"a_get_media",id:e.messageId,gid:t.gid};return Object(o.retryFn)(r.post,3,e=>e*e)(k,i).then(r=>(n(),Se(e,r,t))).catch(n=>(Object(b.statlogsSendingError)(t,n,"unknown","server_load_attach"),Se(e,null,t)))}function Se(e,t,n){var r=n.tabs[e.peerId];return r.mediacontent||(r.mediacontent={}),r.mediacontent[e.messageId]=t||[getTemplate("im_retry_link")],Pe(e,n)}function Pe(e,t){var n=t.tabs[e.peerId];return n.history=Object(d.replaceAttaches)(x(n.history),e,t),Promise.resolve(t)}function Me(e,t,n){var r=Object(d.dayFromVal)(t),i=n.tabs[e];return i.searchDay=r,i.searchOffset=0,i.searchAllLoaded=!1,Promise.resolve(n)}function De(e,t,n){return n.tabs[t].searchText=e,Ke(t,n),n}function Le(e,t,n){if(t){var r=n.tabs[t];r.searchText=e,r.searchOffset=0,r.searchAllLoaded=!1}else n.searchText=e,n.searchOffset=0,n.searchAllLoaded=!1;return Promise.resolve(n)}function xe(e,t,n,i,a){var o=+new Date;return Object(r.post)(k,{act:"a_hints",str:e,gid:i.hidegid?0:a.gid,query:n,peerIds:t.join(",")}).then(t=>{var n=w(t,3),r=n[0],i=n[1];return N(n[2],a),i.forEach(e=>Object(g.oCacheAdd)(a,e)),fe(r,a),Object(y.saveSearchAttemptStats)("messages",o,r&&r.length,e),Object.keys(r).sort((e,t)=>r[e].order-r[t].order).map(e=>r[e])})}function Re(e,t,n,r){return xe(e,t,n,{},r).then(e=>e.map(e=>({peerId:e.peerId,name:e.tab,photo:e.photo,online:e.online,is_friend:"friends"===n})))}function Ne(e){var t={peerId:e[0],name:e[1],tab:e[1],photo:e[2],href:e[3],online:e[4],is_friend:e[5],local_index:!0};return e[6]&&(t.data={flags:e[6]}),t}function Fe(e){return(t,n)=>e(n).then(e=>{var r=(t?e.search(t):e.list).map(Ne);return n.mapped_index||(n.mapped_index={}),r.forEach(e=>{n.mapped_index[e.peerId]=e}),r})}var Be=Fe(e=>e.topConvTree),He=Fe(e=>e.imTopConvTree),Ge=Fe(e=>e.hintsTree);function Ue(e,t){var n,i,a;t.topConvTree=new Promise(e=>{n=e}),t.hintsTree=new Promise(e=>{i=e}),t.imTopConvTree=new Promise(e=>{a=e});var s=e.select(u.RECENT_SEARCH_OP);return Object(o.retryFn)(r.post,1,()=>4)(k,{act:"a_dialogs_preload",rs:s.join(","),gid:t.gid}).catch(e=>[[],[],[]]).then(e=>{var r=w(e,4),o=r[0],s=r[1],c=r[2],u=r[3];return t.popular_sugg=c,new vkIndexer(o,e=>e[1],n),new vkIndexer(s,e=>e[1],i),u&&u.length>0?new vkIndexer(u,e=>e[1],a):a(),t})}function qe(e){var t,n=e.active_tab;return t=e.dialog_tabs[n].length>0?Math.min.apply(null,e.dialog_tabs[n].map(t=>e.tabs[t].lastmsg)):0,Object(r.post)(k,{act:"a_get_dialogs",start_message_id:t,tab:n,gid:e.gid}).then(t=>{var r=w(t,4),i=r[0],a=r[1],o=r[2],s=r[3];return o.forEach(t=>Object(g.oCacheAdd)(e,t)),N(s,e),fe(a,e),e.dialog_tabs[n]=e.dialog_tabs[n].concat(Object.keys(a).map(intval)),e.dialog_tabs_all[n]=!i.has_more,Promise.resolve(e)})}var ze=L(function(e,t){return Object(r.post)(k,{act:"a_search",q:e,from:"all",gid:t.gid,hash:t.writeHash,offset:t.searchOffset||0}).then(n=>{var r=w(n,5),i=r[0],a=r[1],o=r[2],s=r[3],c=r[4];return a.forEach(e=>Object(g.oCacheAdd)(t,e)),Object(d.normalizeTabsGotFromServer)(t,i),e===t.searchText&&(t.searchOffset=s,t.searchAllLoaded=c),Object.keys(i).filter(e=>!t.tabs[e]).forEach(e=>{t.tabs[e]=i[e]}),[i,o]})});function $e(e,t){return t.tabs[e].searchAllLoaded}function Ve(e,t){return!(t.peer!==e||!Object(d.isFullyLoadedTab)(t,e))&&t.tabs[e].inplaceSearch}function We(e,t){if(Object(d.isFullyLoadedTab)(t,e)){var n=t.tabs[e];delete n.inplaceSearch,delete n.searchOffset,delete n.searchAllLoaded,delete n.searchText,delete n.searchDay,A({st:""}),C()}return Promise.resolve(t)}function Ye(e,t){if(Object(d.isFullyLoadedTab)(t,e)){var n=t.tabs[e];delete n.searchDay,n.searchOffset=0,n.searchAllLoaded=!1}return Promise.resolve(t)}function Ke(e,t){return t.tabs[e].inplaceSearch=!0,Promise.resolve(t)}var Qe=L(function(e,t){var n=t.tabs[e],i="";if(Ke(e,t),n.searchDay&&(i=`day:${n.searchDay}`),!i&&!n.searchText)return Promise.reject();var a=`in:${e} ${i} ${n.searchText||""}`;return A({st:n.searchText}),C(),Object(r.post)(k,{act:"a_search",q:a,from:"in",gid:t.gid,hash:t.writeHash,offset:n.searchOffset||0}).then(e=>{var t=w(e,3),r=t[0],i=t[1],a=t[2];return n.searchOffset=i,n.searchAllLoaded=a,r})});function Xe(e){return Object(r.post)(k,{act:"a_important",offset:e,part:e>0})}function Je(e,t){var n=Object(_.getTab)(e,t);return Object(r.post)(k,{act:"a_load_lastmsg",peerId:t,gid:e.get().gid}).then(r=>{var i=w(r,2),a=i[0],o=i[1];n.lastmsg=a[0]||!1,n.lastmsg_meta=a;var s=w(o,3);n.unread=s[0],n.in_up_to=s[1],n.out_up_to=s[2],n.unread||(e.get().dialog_tabs[l.FOLDER_UNREAD]=e.get().dialog_tabs[l.FOLDER_UNREAD].filter(e=>e!=t)),re(e.get(),n,!1,oe.bind(null,t),Qt.bind(null,e.get()))})}function Ze(e,t,n){if(Object(d.isFullyLoadedTab)(n,t)){var r=n.tabs[t];r.deleted=r.deleted?r.deleted.concat(e):e}return Promise.resolve(n)}function et(e,t,n){if(Object(d.isFullyLoadedTab)(n,t)){var r=n.tabs[t];r.history=Object(d.removeMessages)(e,x(r.history)),r.offset-=e.filter(e=>r.msgs[e]).length,e.forEach(e=>delete r.msgs[e]),e.forEach(e=>{var t=(n.selectedMessages||[]).indexOf(e);-1!=t&&n.selectedMessages.splice(t,1)})}return Promise.resolve(n)}var tt=L(function(e,t,n,i,a){return Object(r.post)(k,{act:"a_mark",peer:t,hash:n||a.tabs[t].hash,gid:a.gid,msgs_ids:e.join(","),mark:i})});function nt(e,t,n,r){if(Object(d.isFullyLoadedTab)(r,t)){var i=r.tabs[t];i.deleted=i.deleted?i.deleted.concat(e):e,i.history=Object(d.removeMessagesWithRestore)(e,t,n,x(i.history)),i.offset-=e.filter(e=>i.msgs[e]).length}return Promise.resolve(r)}function rt(e,t,n){if(Object(d.isFullyLoadedTab)(n,t)){var r=n.tabs[t];r.deleted&&(r.deleted=r.deleted.filter(t=>t!==e)),r.history=Object(d.restoreMessage)(e,t,x(r.history)),r.offset++}return Promise.resolve(n)}function it(e,t,n,i){return Object(r.post)(k,{act:"a_restore",id:e,peer:t,hash:n,gid:i})}var at=L(function(e,t,n){return Object(d.tabIsMessageRequest)(n.tabs[e])?Promise.resolve(n):(n.tabs[e].lastTyping=Date.now(),Object(r.post)(k,{act:"a_activity",type:t,peer:e,gid:n.gid,hash:n.tabs[e].hash}).then(()=>n,()=>n))}),ot=L((e,t)=>Object(r.post)(k,{act:"a_accept_message_request",peer_id:e,hash:t.tabs[e].hash}).then(()=>{var n=t.tabs[e];return n.is_message_request=!1,n.folders=Object(_.removeMessageRequestFolderFlags)(n.folders),t})),st=L((e,t)=>Object(r.post)(k,{act:"a_reject_message_request",peer_id:e,hash:t.tabs[e].hash}).then(()=>(re(t,t.tabs[e],!0,t=>t.filter(t=>t!==Number(e))),sn(t.tabbedPeers.filter(t=>t.peer!==e),!0,t),t))),ct=L((e,t,n)=>Object(r.post)(k,{act:"a_cancel_message_request",peer_id:e,contact_id:t,hash:n.tabs[e].hash}).then(()=>{var r=n.tabs[e];return r&&r.invitedByMessageRequest&&(r.invitedByMessageRequest=r.invitedByMessageRequest.filter(e=>e.id!==t)),n})),ut=L(function(e,t){return at(e,E,t)}),dt=L(function(e,t){return at(e,I,t)});function lt(e,t,n,r){return t&&(r.pendingForward=null,e||(e={msgIds:[]}),t.addAttach(n?"reply":"mail",e.msgIds.join(";"),e.object||null)),Promise.resolve(r)}function _t(e,t){return t.pendingForward=e,Promise.resolve(t)}function ht(e,t,n){if(!Object(d.isTabLoaded)(n,e))return n;n.blockedFlagUpdates||(n.blockedFlagUpdates={}),n.blockedFlagUpdates[e]=!0;var r=n.tabs[e];return re(n,r,!0,t=>t.filter(t=>t!==e)),r.unread>0&&!Object(d.tabIsMessageRequest)(r)&&de(n,-1,e),r.deletedDialog=!0,sn(n.tabbedPeers.filter(t=>t.peer!==e),!0,n),t.then(t=>{var i=w(t,2);i[0],i[1];return delete n.blockedFlagUpdates[e],r.msgs=null,r.history=null,r.unread=0,r.lastmsg=!1,r.lastmsg_meta=null,n})}var gt=L(function(e,t){return ht(e,Object(r.post)("al_im.php",{act:"a_flush_history",id:e,from:"im",gid:t.gid,hash:t.tabs[e].hash}),t)}),ft=L(function(e,t,n){return Object(r.post)(k,{act:"a_set_chat_title",peer:e,new_title:t,gid:n.gid,hash:n.tabs[e].hash}).then(()=>(n.onUpdate&&n.onUpdate(),n))}),mt=L(function(e,t){return Object(r.post)(k,{act:"a_load_chat_info",peer:e,gid:t.gid,hash:t.tabs[e].hash}).then(n=>{var r=w(n,1)[0];return t.tabs[e]=extend(t.tabs[e],r),t})});function pt(e,t,n){var r=n.tabs[e];return r.memberIds=[].concat(r.memberIds,t).filter((e,t,n)=>n.indexOf(e)===t),r.membersCount=r.memberIds.length,Promise.resolve(n)}var bt=L(function(e,t,n,i){return Object(r.post)(k,{act:"a_add_chat_members",peer:e,new_peer:t.join(","),gid:i.gid,hash:i.tabs[e].hash,show_history:n?1:0}).then(e=>i)});function vt(e,t){if(isEmpty(e))return Promise.resolve(t);var n=Object.keys(e).map(t=>`${t}:${e[t].join(",")}`).join(";");return Object(r.post)(k,{act:"a_load_member",need:n,gid:t.gid}).then(e=>{return w(e,1)[0].forEach(e=>Object(g.oCacheAdd)(t,e)),t})}function yt(e,t,n){var r={},i=n.get();function o(e,t){Object(d.isChatPeer)(e)&&t&&!Object(g.oCacheExists)(i,t)&&(r[e]?-1===r[e].indexOf(t)&&r[e].push(t):r[e]=[t])}var s=t.filter(e=>!Object(d.isTabLoaded)(i,e.peerId)).map(e=>e.peerId);t.forEach(e=>{o(e.peerId,e.userId)}),e.forEach(e=>{o(e.peerId,+e.kludges.source_mid)});var c=t.filter(e=>e.flags&a.FLAG_OUTBOUND&&!e.local).map(e=>e.kludges.from_admin).filter(e=>e&&!i.admins[e]);return 0===Object.keys(r).length&&0===c.length&&0===s.length?Promise.resolve(i):{shouldLoad:Object.keys(r).length>0||c.length>0||s.length>0,needMembers:r,needAdminIds:c,needPeers:s}}function Ot(e,t,n){var r=e.needMembers,i=e.needAdminIds,a=e.needPeers;return t.pause(),Promise.all([vt(r,n),ie(i,n),Promise.all(a.map(e=>F(e,0,0,0,n)))]).catch(()=>n).then(()=>t.resume()).then(()=>n)}var wt=L(function(e,t){return e.kludges.source_act===d.CHAT_PHOTO_REMOVE?(delete t.tabs[e.peerId].photo,delete t.tabs[e.peerId].photoLarge,Promise.resolve(t)):(t.onUpdate&&t.onUpdate(),Object(r.post)(k,{act:"a_get_chat_photo",msg_id:e.messageId}).then(n=>{var r=w(n,2),i=r[0],a=r[1];t.chat_photo_msg=a;var o=t.tabs[e.peerId];if(t.tabs[e.peerId].photo=i[0],t.tabs[e.peerId].photoLarge=i[1],Object(d.isFullyLoadedTab)(t,e.peerId)){var s=e.kludges.source_act;o.history=Object(d.addChatPhotoToUpdate)(e,s,t,x(o.history))}return t}))});function kt(e,t,n,r){return t!==vk.id?Promise.resolve(r):(Object(d.isTabLoaded)(r,n)&&r.peer==n&&(r=W(r)),Promise.resolve(r))}var jt=L(function(e,t){return Object(r.post)(k,{act:"a_leave_chat",chat:e-2e9,gid:t.gid,hash:t.tabs[e].hash}).then(kt.bind(null,d.CHAT_KICK_USER,vk.id,e,t))}),Et=L(function(e,t){return Object(r.post)(k,{act:"a_return_to_chat",chat:e-2e9,gid:t.gid,hash:t.tabs[e].hash}).then(kt.bind(null,d.CHAT_INVITE_USER,vk.id,e,t))}),It=L(function(e,t,n){return Object(r.post)(k,{act:"a_mute",peer:e,hash:n.tabs[e].hash,gid:n.gid,value:t?1:0}).then(()=>{var r=t?"mute":"unmute";return window.Notifier&&Notifier.lcSend("im",{act:r,peer:e}),n}).then(Tt.bind(null,e,t))});function Tt(e,t,n){var r=n.mutedPeers.filter(t=>t!==e);return t&&r.push(e),n.mutedPeers=r,cur.mutedPeers=n.mutedPeers,W(n)}function At(e,t){return t.stack=e,Promise.resolve(t)}var Ct=L(function(e,t,n,i){return St(e,n,t,i),Object(r.post)(k,{act:"a_mark_important",ids:e,val:t?1:0,from:"im",gid:i.gid,peer:n,hash:i.tabs[n].hash}).then(()=>i)});function St(e,t,n,r){if(Object(d.isFullyLoadedTab)(r,t)){var i=r.tabs[t];e.filter(e=>i.msgs[e]).forEach(e=>{var o=Object(_.getMessage)(r,t,e),s=n?o.flags|a.FLAG_IMPORTANT:o.flags&~a.FLAG_IMPORTANT;o.flags=s,i.msgs[e]=o,i.history=Object(d.updateStar)(e,n,x(i.history))})}return Promise.resolve(r)}function Pt(e,t,n){return n.importants||(n.importants={}),(n.importants[t]||0)!==e&&(n.important_cnt+=e,n.importants[t]=e),Promise.resolve(n)}function Mt(e,t){return Object(r.post)(k,{act:"a_spam",offset:e,gid:t,part:e>0})}function Dt(e,t){return Object(r.post)(k,{act:"a_flush_spam",gid:t,hash:e})}function Lt(e,t,n){return n.creationType=e,n.creationFilter=t,Promise.resolve(n)}function xt(e,t){return Object(r.post)(k,{act:"a_owner_photo",photo:JSON.parse(e).data[0],peer:t})}function Rt(e,t){return t.next_chat_avatar=e,Promise.resolve(t)}function Nt(e,t,n){return Object(r.post)("al_page.php",{act:"owner_photo_save",peer:e,_query:t,gid:n.gid}).then(e=>n)}var Ft=L(function(e,t,n,i){return i.creating=!0,i.longpoll.pause(),Object(r.post)(k,{act:"a_multi_start",hash:i.writeHash,peers:t.join(","),title:n}).then(e=>{var t=w(e,1)[0];return i.next_peer=t.peerId,i.tabs[t.peerId]=t,re(i,t,!1,e=>[t.peerId].concat(e)),i.longpoll.resume(),i}).then(t=>e?Nt(t.next_peer,e,t):t).then(e=>(e.creating=!1,e)).catch(e=>{throw i.creating=!1,i.longpoll.resume(),e})}),Bt=L(function(e,t,n){return n.creating=!0,Object(r.post)(k,{act:"a_multi_start",hash:n.writeHash,peers:[],title:t,gid:n.gid,is_community_chat:1}).then(t=>{var r=w(t,1)[0].peer_id;if(!r)throw new Error("No peer_id");return e?Nt(r,e,n):n}).then(e=>(e.creating=!1,e)).catch(e=>{throw n.creating=!1,e})});function Ht(e){var t;e.resync_in_process=new Promise(e=>{t=e});var n=Object.keys(e.tabs).length,i=e.active_tab;return Object(r.post)(k,{act:"a_resync",sel:e.peer,gid:e.gid,loaded:n,tab:i,add_peers:e.tabbedPeers.map(e=>e.peer).join(",")}).then(n=>{var r=w(n,5),a=r[0],o=r[1],s=r[2],u=r[3],_=r[4];o.forEach(t=>Object(g.oCacheAdd)(e,t)),Object(d.normalizeTabsGotFromServer)(e,a),s.user_unread&&handlePageCount("msg",s.user_unread),Object(c.lplog)("Resync success","success");var h,f=e.peer;if(Object(d.isReservedPeer)(f))h=Promise.resolve(!1);else{var m={tabs:{[f]:e.tabs[f]},oCache:{}};h=fe({[f]:a[f]},m)}return h.then(n=>{e.tabs=a,e.admins=extend(e.admins,u),n&&(e.tabs[f]=n.tabs[f],e.tabs[f].history=Object(d.restoreQueue)(f,e,x(e.tabs[f].history))),e.loadingDialogs=!1,e.mutedPeers=s.mutedPeers,e.lastDialogsOptions={has_more:s.has_more},e.dialog_tab_cts=Object.assign({},s.folder_cts,{[l.FOLDER_MESSAGE_REQUEST]:e.dialog_tab_cts[l.FOLDER_MESSAGE_REQUEST]}),e.dialog_tabs[i]=_.map(intval);var r=e.dialog_tabs[i].map(t=>e.tabs[t]);return Object.keys(e.dialog_tabs).filter(e=>e!=i).forEach(t=>{i==l.FOLDER_ALL?e.dialog_tabs[t]=r.filter(Yt(t)).map(e=>e.peerId):e.dialog_tabs[t]=[]}),delete e.resync_in_process,setTimeout(t.bind(null,!0),0),zt(intval(s.unread),e)})}).catch(t=>(Object(c.lplog)("Resync error: "+t.message+" "+t.stack,"error"),Object(o.pause)(2).then(Ht.bind(null,e))))}function Gt(e,t){return t.lockedSending=e,Promise.resolve(t)}function Ut(e,t,n){return e&&!n.delayed_message?(n.delayed_message=e,n.delayed_ts=t):e||(n.delayed_message=e,n.delayed_ts=t),Promise.resolve(n)}function qt(e){return!!e.textMediaSelector.urlAttachmentLoading||!!(window.Upload&&Upload.options&&Upload.isSomethingUploading)&&Object.keys(Upload.options).filter(e=>Upload.isSomethingUploading(e)).length>0}function zt(e,t){return t.unread_cnt=e,t.dialog_tab_cts[l.FOLDER_UNREAD]=e,Promise.resolve(t)}function $t(e,t){return t.ctrl_submit=!!e,Object(r.post)(k,{act:"a_save_ctrl_submit",to:t.peer,hash:t.tabs[t.peer].hash,value:e?1:0}).then(e=>t)}function Vt(e,t,n){n.cur_unread_cnt||(n.cur_unread_cnt={}),t&&!inArray(e,n.mutedPeers)&&(n.cur_unread_cnt[e]=!0);var r=document.title,i=window.devicePixelRatio>=2?"_2x":"";if(t&&!n.update_title_to){var a=function(e,t,n){return function(){n.update_old_title=e;var r=Object.keys(n.cur_unread_cnt).length;if(0===r)return Object(v.setDocumentTitle)(e||document.title),setFavIcon("/images/icons/favicons/fav_im"+t+".ico"),clearInterval(n.update_title_to),void(n.update_title_to=!1);e?(Object(v.setDocumentTitle)(e),setFavIcon("/images/icons/favicons/fav_im"+t+".ico"),e=!1):(e=document.title,setFavIcon("/images/icons/favicons/fav_im"+(r>9?10:r)+t+".ico"),Object(v.setDocumentTitle)(winToUtf(getLang("mail_im_new_messages",r))))}}(r,i,n);n.update_title_to=setInterval(a,1e3),a()}else!t&&n.update_old_title&&(Object(v.setDocumentTitle)(n.update_old_title),n.cur_unread_cnt={},r=!1,n.update_old_title=!1,setFavIcon("/images/icons/favicons/fav_im"+i+".ico"),clearInterval(n.update_title_to),n.update_title_to=!1);return Promise.resolve(n)}function Wt(e,t,n,r,i){return Object(d.isFullyLoadedTab)(i,e)&&(i.tabs[e].scrollTop=intval(t),i.tabs[e].scrollBottom=intval(n),i.tabs[e].contHeight=intval(r)),Promise.resolve(i)}function Yt(e){return e===l.FOLDER_ALL?e=>!Object(d.tabIsMessageRequest)(e):e===l.FOLDER_UNREAD?e=>!Object(d.tabIsMessageRequest)(e)&&e.unread>0:e===l.FOLDER_MESSAGE_REQUEST?e=>Object(d.tabIsMessageRequest)(e):t=>t.folders&l.FOLDER_MASKS[e]}function Kt(e,t){t.active_tab=e,Object(i.updateLocation)({tab:e===l.FOLDER_ALL?null:e});var n=[];if(e!==l.FOLDER_ALL&&!Object(d.isReversedDialogs)(t)){var r=t.dialog_tabs[e];n=t.dialog_tabs[l.FOLDER_ALL].map(e=>t.tabs[e]).filter(Yt(e)).map(e=>e.peerId),t.dialog_tabs[e]=r.length>=n.length?r:n}return Promise.resolve(t)}function Qt(e,t,n,r){var i=e.dialog_tabs_all;return!(!i[l.FOLDER_ALL]&&!i[t])||(n.filter(e=>e===r.peerId).length>0||("r"===r.lastmsg[0]||n.map(t=>e.tabs[t.toString()]).filter(t=>Object(d.isReversedDialogs)(e)?t.lastmsg>r.lastmsg:t.lastmsg<r.lastmsg).length>0))}function Xt(e,t,n,r,i){if(Object(d.isTabLoaded)(i,e)){var o=i.tabs[e];return n===a.REPLACE_DIRECTORIES&&(t^=o.folders),function(e,t,n){return!(e===a.SET_DIRECTORIES&&n.folders&t)&&(!!(e!==a.RESET_DIRECTORIES||n.folders&t)&&!Object(d.tabIsMessageRequest)(n))}(n,t,o)&&Object.keys(l.FOLDER_MASKS).filter(e=>l.FOLDER_MASKS[e]&t).forEach(e=>{i.dialog_tab_cts[e]+=function(e,t,n){return t!==a.RESET_DIRECTORIES||e.folders&l.FOLDER_MASKS[n]?t===a.REPLACE_DIRECTORIES?e.folders&l.FOLDER_MASKS[n]?-1:1:t===a.SET_DIRECTORIES?1:-1:0}(o,n,e)}),n===a.SET_DIRECTORIES?i.tabs[e].folders|=t:n===a.RESET_DIRECTORIES?i.tabs[e].folders&=~t:i.tabs[e].folders=t^=o.folders,re(i,i.tabs[e],!0,(t,n)=>t.concat([e]).map(e=>i.tabs[e]).filter(Yt(n)).map(e=>e.peerId),Qt.bind(null,i)),Promise.resolve(i)}return F(e,0,0,0,i).then(Xt.bind(null,e,t,n,i))}var Jt=L(function(e,t){var n=l.FOLDER_MASKS[l.FOLDER_IMPORTANT],i=t.tabs[e].folders&n,o=i?a.resetDirectoriesEvent:a.setDirectoriesEvent;return t.longpoll.push([o([0,e,n,!0])]),Object(r.post)(k,{act:"a_dialog_star",val:i?0:1,peer:e,hash:t.tabs[e].hash,gid:t.gid}).then(()=>t)}),Zt=L(function(e,t,n){var i=l.FOLDER_MASKS[l.FOLDER_UNRESPOND];return n.longpoll.push([a.resetDirectoriesEvent([0,e,i,!0]),a.readInboundEvent([6,e,t])]),Object(r.post)(k,{act:"a_mark_answered",peer:e,lastmsg:t,hash:n.tabs[e].hash,gid:n.gid}).then(()=>n)});function en(e){return Object(r.post)(k,{act:"a_get_mutex_key",gid:e})}function tn(e,t){return N({[e]:{free:!0}},t),Object(r.post)(k,{act:"a_block_release",peer:e,gid:t.gid}).then(()=>t)}function nn(e,t){var n=ls.get("comm_mute_"+t.gid)?1:0;return e&&(n^=1),ls.set("comm_mute_"+t.gid,n),t.mute=n,Promise.resolve(t)}var rn=L(function(e,t){return re(t,t.tabs[e],!0,t=>t.filter(t=>t!==e)),t.tabs[e].deletedDialog=!0,Object(r.post)(k,{act:"a_delete_dialog",peer:e,gid:t.gid,hash:t.tabs[e].hash}).then(n=>(n[0]?(sn(t.tabbedPeers.filter(t=>t.peer!==e),!0,t),t.tabs[e].unread=0,t.tabs[e].lastmsg=!1,t.tabs[e].lastmsg_meta=null):(t.tabs[e].deletedDialog=!1,re(t,t.tabs[e],!1,oe.bind(null,e),Qt.bind(null,t))),n))});function an(e,t,n,i){return Object(r.post)(k,{act:"a_restore_dialog",hash:t,gid:i.gid,spam:n?1:0,peer:e}).then(t=>(i.tabs[e].deletedDialog=!1,re(i,i.tabs[e],!1,t=>[e].concat(t)),i.tabs[e].unread=t,i))}function on(e,t,n){return Object(r.post)(k,{act:"a_spam_dialog",peer:e,gid:n.gid,hash:t})}function sn(e,t,n){return n.tabbedPeers=e,Object(d.isClassicInterface)(n)&&(A({peers:n.tabbedPeers.filter(e=>{var t=e.peer,r=e.type;return t!==n.peer&&"perm"===r}).map(e=>Object(d.getBareTab)(e.peer,n)).filter(e=>!e.deletedDialog).map(e=>e.peerId).map(d.convertPeerToUrl).join("_"),to:""}),t&&C()),Promise.resolve(n)}function cn(e){return!e.peer||(Ve(e.peer,e)?$e(e.peer,e):!!Object(d.isFullyLoadedTab)(e,e.peer)&&e.tabs[e.peer].allShown)}function un(e,t){var n=t.tabs[e];return Object(d.isFullyLoadedTab)(t,e)&&(n.skipped=null,n.msgs=null,n.offset=null,n.allShown=null,n.history=null),Promise.resolve(t)}function dn(e,t){var n=t.tabs[e];return Object(d.isFullyLoadedTab)(t,e)&&(n.history=R(n.history)),Promise.resolve(t)}function ln(e,t){return t.go_to_end_visible=e,Promise.resolve(t)}function _n(e,t,n){if(!Object(d.isCommunityPeer)(t))return Promise.resolve(n);var i=Object(_.getTab)(n,t);return i.blocked_community=!e,!1===e&&(i.can_send_notify=!1),Object(r.post)(k,{act:"a_toggle_community",peer_id:t,hash:i.hash,state:e?1:0}).then(()=>W(n))}function hn(e,t){if(0!==t.peer&&Object(d.isFullyLoadedTab)(t,t.peer)){var n=Object(_.getTab)(t,t.peer);n.history=x(n.history),e(n.history)}return Promise.resolve(t)}function gn(e,t){if(0!==t.peer&&Object(d.isFullyLoadedTab)(t,t.peer)){var n=Object(_.getTab)(t,t.peer),r=geByClass1("_im_peer_history");r&&(n.history=x(r.innerHTML)),e(n.history)}return Promise.resolve(t)}function fn(e){return e.audio_msg.isRecording?Promise.reject():(e.audio_msg.isRecording=!0,Promise.resolve(e))}function mn(e){return e.audio_msg.isRecording=!1,Promise.resolve(e)}function pn(e,t){return t.voice_message_available=e,Promise.resolve(t)}function bn(e){A({act:e?"create":null}),C()}function vn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;A({q:e}),C()}function yn(e){return void 0===e.chatResizeInitialized&&(e.chatResizeInitialized=!0,Object(d.getClassicChatHeight)()>window.clientHeight()&&Object(d.setClassicChatHeight)(0)),Promise.resolve(e)}var On=L(function(e,t,n){return Object(r.post)(k,{act:"a_join_chat",chat_id:e,hash:t,write_hash:n.writeHash}).then(e=>{var t=w(e,4),r=t[0],i=t[1],a=t[2],o=t[3];return a.forEach(e=>Object(g.oCacheAdd)(n,e)),n.tabs[r]=i,re(n,i,!1,oe.bind(null,r),Qt.bind(null,n)),n.admins=extend(n.admins,o),[r]})});function wn(e,t){return Object(r.post)(k,{act:"a_get_link",gid:t.gid,chat_id:e})}var kn=L(function(e,t){var n=t.tabs[e];return Object(r.post)(k,{act:"a_reset_link",chat_id:e-2e9,write_hash:t.writeHash}).then(e=>(n.inviteLink=e[0],e))});function jn(e){return S({invite_chat_id:null,invite_hash:null,mr:null}),e.invitation=void 0,Promise.resolve(e)}function En(e,t){var n=Object(c.arrayUnique)([e].concat(t.select(u.RECENT_SEARCH_OP))).slice(0,500);t.update(u.RECENT_SEARCH_OP,n)}function In(e){e.update(u.RECENT_SEARCH_OP,[])}function Tn(e,t){var n=t.select(u.RECENT_SEARCH_OP).filter(t=>t!==e);return t.update(u.RECENT_SEARCH_OP,n),n}function An(e,t,n){var r=n.tabs[t],i=Object(_.getMessage)(n,t,e);return r.data.kicked||r.data.closed||i.kludges.source_act||(r.pinned=i),Promise.resolve(n)}function Cn(e,t){return t.tabs[e].pinned=null,Promise.resolve(t)}var Sn=L(function(e,t,n){var i=n.tabs[t];return i.data.kicked||i.data.closed?Promise.resolve(n):Object(r.post)(k,{act:"a_pin_message",msgid:e,chat:t,gid:n.gid,hash:n.tabs[t].hash}).then(e=>{var r=w(e,1)[0];return n.tabs[t]=Object.assign({},i,r),n})}),Pn=L(function(e,t){var n=t.tabs[e];return n.data.kicked||n.data.closed?Promise.resolve(t):Object(r.post)(k,{act:"a_unpin_message",chat:e,gid:t.gid,hash:t.tabs[e].hash}).then(r=>{var i=w(r,1)[0];return t.tabs[e]=Object.assign({},n,i),t})}),Mn=L(function(e,t){var n=t.tabs[e];return Object(r.post)(k,{act:"a_get_pinned_message",chat:e,gid:t.gid,hash:t.tabs[e].hash}).then(e=>{var r=w(e,1)[0];return n.pinned=r||null,t})}),Dn=L(function(e,t,n){var i=n.tabs[e];return Object(r.post)(k,{act:"a_get_message_local_id",chat:e,chat_local_id:t,hash:i.hash})}),Ln=L(function(e,t){var n=t.tabs[e];return n.membersLoaded?Promise.resolve(t):Object(r.post)(k,{act:"a_get_chat_members",chat:e,gid:t.gid,hash:n.hash}).then(e=>{var r=w(e,1),i=w(r[0],3),a=i[0],o=i[1],s=i[2];return n.memberIds=a,n.adminIds=o,s.forEach(e=>Object(g.oCacheAdd)(t,e)),n.membersLoaded=!0,t})}),xn=L(function(e,t){return Promise.all([Ln(e,t),function(e,t){var n=t.tabs[e];return Object(r.post)(k,{act:"a_get_chat_details",chat:e,gid:t.gid,hash:n.hash}).then(e=>{var r=w(e,1)[0];return n.photoGrid=r.grid,n.photoLarge=r.photo,n.membersLastSeen=r.lastSeen||null,n.inviters=r.inviters,n.caccess=r.caccess,n.invitedByMe=r.invitedByMe||[],n.inviteLink=r.link||null,n.invitedByMessageRequest=r.invitedByMessageRequest,n.serverSettings=r.serverSettings||null,n.isDefaultPhotoOwner=r.isDefaultPhotoOwner||null,n.owner=r.owner||null,n.allowedUpdateFlags=r.allowedUpdateFlags,n.canInvite=r.canInvite||null,t})}(e,t)]).then(()=>t)}),Rn=L(function(e,t,n){var i=n.tabs[e];return Object(r.post)(k,{act:"a_update_flags",chat:e,gid:n.gid,hash:i.hash,flags:t}).then(e=>(n.onUpdate&&n.onUpdate(),e))}),Nn=L(function(e,t){var n=t.tabs[e];return Object(r.post)("al_page.php",{act:"owner_photo_remove",oid:e,gid:t.gid,hash:n.photoHash}).then(()=>(n.photo=null,n.photoLarge=null,t.onUpdate&&t.onUpdate(),t))});function Fn(e,t,n){var r=n.tabs[e];return r.memberIds=r.memberIds.filter(e=>e!==t),r.adminIds=r.adminIds.filter(e=>e!==t),r.membersCount=r.memberIds.length,Promise.resolve(n)}var Bn=L(function(e,t,n){var i=n.tabs[e];return Object(r.post)(k,{act:"a_kick_user",chat:e,hash:i.hash,mid:t,gid:n.gid}).then(()=>(i.memberIds=i.memberIds.filter(e=>e!==t),i.adminIds=i.adminIds.filter(e=>e!==t),i.membersCount=i.memberIds.length,n))});function Hn(e,t,n,r){var i=r.tabs[e];return i.adminIds=n?[].concat(i.adminIds,t).filter((e,t,n)=>n.indexOf(e)===t):i.adminIds.filter(e=>e!==t),Promise.resolve(r)}var Gn=L(function(e,t,n,i){var a=i.tabs[e];return Object(r.post)(k,{act:"a_toggle_admin",chat:e,hash:a.hash,mid:t,is_admin:+n}).then(()=>Hn(e,t,n,i))});function Un(e,t,n,r){var i=Object(_.getMessage)(e,n,t).userId;return Object(g.oCacheGet)(r,i)?Promise.resolve(r):vt({[n]:[i]},r)}function qn(){ajax.post("al_im.php",{act:"a_hide_promo_tooltip"})}function zn(){cur.videoAutoplayScrollHandler&&cur.videoAutoplayScrollHandler()}var $n=L(function(e,t){return t.tabs[e].top_banner=void 0,Object(r.post)(k,{act:"a_hide_banner",peer_id:e,gid:t.gid,hash:t.tabs[e].hash}).then(()=>t)}),Vn=L(function(e,t,n){n.tabs[e].top_banner=void 0;var i=n.tabs[e];return Object(r.post)(k,{act:"a_callback_banner",peer_id:e,callback_data:t,hash:i.hash}).then(()=>n)});function Wn(e,t){return Object(r.post)(k,{act:"a_load_banner",peer_id:e,gid:t.gid}).then(n=>{var r=w(n,1)[0];return t.tabs[e].top_banner=r,t})}function Yn(e,t,n){return n.tabs[e].keyboard=t&&t.buttons?t:null,Qn(e,!1,!0,n)}function Kn(e,t){return Yn(e,null,t)}function Qn(e,t,n,r){return((r.tabs||{})[e]||{}).keyboard&&(r.tabs[e].keyboard.hide=t,n&&ls.set("is_keyboards_hide",Object.assign(ls.get("is_keyboards_hide")||{},{[e]:t}))),Promise.resolve(r)}var Xn=L(function(e,t){var n=t.tabs[e];return Object(r.post)(k,{act:"a_get_keyboard",peer_id:e,hash:n.hash}).then(n=>{var r=w(n,1)[0];return Yn(e,r,t)})});function Jn(e,t,n,i){var a=i.tabs[e];return a.caccess[t]=n,Object(r.post)(k,{act:"a_change_caccess",peer_id:e,member_id:t,hash:a.hash,access:n?1:0}).then(()=>i).catch(e=>{throw a.caccess[t]=!n,e})}var Zn=L(function(e,t){var n=t.tabs[t.peer];return Object(r.post)(k,{act:"a_delete_template",template_id:e,hash:n.hash,gid:t.gid,peer_id:t.peer}).then(()=>{var n=t.templates.find(t=>t.id===e);return n&&(n.deleted=!0),t})});function er(e,t,n){var i=n.tabs[n.peer];return Object(r.post)(k,{act:"a_create_template",hash:i.hash,gid:n.gid,peer_id:n.peer,name:e,text:t}).then(e=>(n.templates.unshift(e[0]),n))}function tr(e,t,n,i){var a=i.tabs[i.peer];return Object(r.post)(k,{act:"a_update_template",template_id:e,hash:a.hash,gid:i.gid,peer_id:i.peer,group_id:i.gid,name:t,text:n}).then(t=>{var n=i.templates.find(t=>t.id===e);return n&&Object.assign(n,t[0]),i})}function nr(e,t){if(Object(d.isFullyLoadedTab)(t,e)){var n=Object(_.getTab)(t,e);n.allShown=!1,n.lastReset=Date.now()}return t}function rr(e,t){var n=e.updateType,r=e.updateArg,i=0;return n===a.MAIL_CHAT_UPDATE_TYPE_MESSAGE_REQUEST_CHANGED&&(i=r===a.MESSAGE_REQUEST_STATUS_NEW?1:-1),n===a.MAIL_CHAT_UPDATE_TYPE_CONTACT_CONVERTED&&(i=-1),t.dialog_tab_cts[l.FOLDER_MESSAGE_REQUEST]+=i,Promise.resolve(t)}},wJJB:function(e,t,n){"use strict";n.r(t);n("KKXr");var r=n("q1tI"),i=n("zxIV"),a=n("v+DW"),o=n("CQka"),s=n("XzvV"),c=n("X3vJ"),u=n("12ku"),d=n("gVOz"),l=n("4+be");var _=n("lcT2"),h=(n("rGqo"),n("Btvt"),n("17x9"),n("T/g7")),g=n("6raB"),f=n("Hx9h"),m=n("TBLV"),p=n("MV/q"),b=n("dV62");class v extends r.Component{constructor(e){super(e),this.selectReason=e=>{this.state.submitLoading||this.setState({selectedReasonId:e})},this.updateComment=e=>{this.state.submitLoading||this.setState({comment:e})},this.submit=()=>{if(!this.state.submitLoading){this.setState({error:""});var e=v.controller,t={act:v.acts.report,group_id:this.props.groupId,reason_id:this.state.selectedReasonId,comment:this.state.comment,hash:this.props.hash};ajax.post(e,t,{onDone:()=>{v.destroy(),showDoneBox(Object(h.getLang)("reports_community_report_added_with_markup"))},onFail:e=>(this.setState({error:e}),!0),showProgress:()=>this.setState({submitLoading:!0}),hideProgress:()=>this.setState({submitLoading:!1})})}},this.state={submitLoading:!1,selectedReasonId:null,comment:"",error:""}}static destroy(){Object(b.destroyComponentInBox)()}renderHeader(){return r.createElement("div",{className:"ReportCommunityForm__header box_title_wrap"},r.createElement("div",{className:"box_x_button",role:"button",onClick:()=>v.destroy()}),r.createElement("div",{className:"box_title"},Object(h.getLang)("reports_community_form_box_header")))}renderFormInputs(){return r.createElement("div",{className:"ReportCommunityForm__inputs"},r.createElement("div",{className:"ReportCommunityForm__reasonsBlock"},r.createElement("h4",{className:"ReportCommunityForm__reasonsDescription subheader"},Object(h.getLang)("reports_community_form_box_reports_input_description")),r.createElement("div",{className:"ReportCommunityForm__reasons"},Object.keys(this.props.reasons).map(e=>{var t=this.props.reasons[e],n=this.state.selectedReasonId===t.id;return r.createElement(m.default,{key:t.id,checked:n,onChange:()=>this.selectReason(t.id),className:"ReportCommunityForm__reason"},t.label)}))),r.createElement("div",{className:"ReportCommunityForm__moderCommentBlock"},r.createElement("h4",{className:"ReportCommunityForm__moderCommentDescription subheader"},Object(h.getLang)("reports_community_form_box_moder_comment_input_description")),r.createElement("div",{className:"ReportCommunityForm__moderComment"},r.createElement(p.default,{placeholder:Object(h.getLang)("reports_community_comment_placeholder"),value:this.state.comment,onChange:e=>this.updateComment(e.target.value),grow:!1}))))}renderFormButtons(){var e=null===this.state.selectedReasonId;return r.createElement("div",{className:"ReportCommunityForm__boxControls box_controls"},r.createElement(g.default,{appearance:"primary",disabled:e,className:"ReportCommunityForm__submitButton flat_button",loading:this.state.submitLoading,onClick:this.submit},Object(h.getLang)("reports_community_form_box_report")),r.createElement(f.default,{appearance:"tertiary",className:"ReportCommunityForm__cancelButton flat_button",onClick:v.destroy},Object(h.getLang)("global_cancel")))}renderError(){return r.createElement("div",{className:"ReportCommunityForm__error"},r.createElement("b",{className:"ReportCommunityForm_errorSummary"},Object(h.getLang)("reports_report_is_not_accepted")),r.createElement("div",{className:"ReportCommunityForm__errorText"},this.state.error))}render(){return r.createElement("div",{className:"ReportCommunityForm"},this.renderHeader(),r.createElement("div",{className:"ReportCommunityForm__content"},r.createElement("div",{className:"ReportCommunityForm__boxBody box_body clear_fix"},this.state.error?this.renderError():"",this.renderFormInputs()),this.renderFormButtons()))}}v.controller="/al_groups.php",v.acts={report:"a_report"};var y=n("EasH");class O{static create(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=window,i=r.stManager,a=r.jsc,o=r.curBox,s=r.cur,c=r.nav;i.add([a("web/groups_create.js"),"groups_create.css"],()=>{window.GroupsCreate.showInfoBox("event",{parentId:e,parentHash:t,onSave:()=>{n?(s.reloadAfterClose=!1,o()&&o().hide(),s.reloadAfterClose=!0,this.show(e)):c.reload()}})})}static delete(e,t,n){var r=window,i=r.cur,a=r.tooltips,o=r.curBox;i.reloadAfterClose=!0,ajax.post("al_public.php",{act:"a_delete_event",pid:e,eid:t,hash:n},{onDone:t=>{a&&a.destroyAll(ge("public_event_cell"+e)),o().content(t)}})}static show(e){var t=window,n=t.cur,r=t.nav;Object(y.showBox)("al_public.php",{act:"a_get_events",pid:e}).setOptions({onHideAttempt:()=>(n.reloadAfterClose&&(r.reload({noscroll:!0}),n.reloadAfterClose=!1),!0)})}}var w={init:function(e){extend(cur,{module:"groups",hideOther:w.hideOther,otherActs:w.otherActs,options:e,oid:-e.group_id,postTo:-e.group_id,_back:{loc:e.loc,show:[],hide:[],text:e.back}}),ge("group_wall")&&wall.init(extend(e,{automore:1})),cur.nav.push(function(e){e[0]&&clearTimeout(w.keyTO)}),e.cntKey&&w.subscribe(e.cntKey),e.age_disclaimer&&w.showDisclaimer(e,"group"),e.enableLinkTracking&&Object(o.initGroupLinksTracking)(),e.gwn&&!Array.isArray(e.gwn)&&Object(d.default)(e.gwn),Object(c.initGroupsMenu)(e.group_id)},inviteToChat:function(e,t){stManager.add([jsc("web/group_invite_chat.js"),"group_invite_chat.css",jsc("web/indexer.js")],function(){window.showGroupChatInviteBox(e)}),t&&t.preventDefault()},inviteToChatPreload:function(){stManager.add([jsc("web/group_invite_chat.js"),"group_invite_chat.css",jsc("web/indexer.js")],function(){})},showDisclaimer:function(e,t){var n=!1,r=showFastBox({title:getLang("groups_age_warning"),width:470,hideOnBGClick:!1,onHide:function(){n||(e.age_disclaimer_back?history.back():location.href="/")},forceNoBtn:1},'<div class="group_age_disclaimer">'+getLang("groups_age_disclaimer")+'<br><div class="checkbox group_age_checkbox" onclick="checkbox(this); disableButton(curBox().proceedButton, !isChecked(this))"><div></div>'+getLang("groups_age_accepted")+"</div></div>");r.removeButtons();var i=r.addButton(getLang("global_cancel"),r.hide,"no",!0);addClass(i,"group_age_disclaimer_close"),r.proceedButton=r.addButton(getLang("groups_age_approve"),function(){n=!0,removeClass(ge(t),"hidden"),r.hide(),e.age_disclaimer_hash?ajax.post("al_groups.php",{act:"a_set_user_age",hash:e.age_disclaimer_hash}):setCookie("remixage18",1),cur.zNavInfo&&zNav(cur.zNavInfo.info,cur.zNavInfo.opts)},"yes",!0);var a=geByClass1("box_controls",domPN(r.bodyNode));addClass(a,"group_age_disclaimer_box"),replaceClass(domFC(a),"fl_r","fl_l"),disableButton(r.proceedButton,1)},switchTab:function(e,t,n){return!!checkEvent(n)||("wiki"==t&&hasClass(e,"ui_tab_sel")?nav.go(e,n):(ge("page_info_wrap").className="page_info_wrap "+t,uiTabs.switchTab(e)))},toggleFave:function(e,t,n,r){null!=cur.toggleFaveAct&&(n=cur.toggleFaveAct),ajax.post("fave.php",{act:n?"a_add_group":"a_delete_group",gid:-cur.oid,hash:t},{onDone:function(t){val(e,t),cur.toggleFaveAct=!n,toggleClass(e,"on")},showProgress:window.Page&&Page.actionsDropdownLock.pbind(e),hideProgress:window.Page&&Page.actionsDropdownUnlock.pbind(e)}),cancelEvent(r)},hideHelpStep:function(e,t,n,r){var i=domClosest("page_block",e);return e&&e.tt&&e.tt.hide&&e.tt.hide({fasthide:!0}),i&&slideUp(i,200,re.pbind(i)),ajax.post("/al_public.php",{act:"a_hide_help_step",pid:t,step:"help_step_advice",hash:n}),r.cancelBubble=!0,cancelEvent(r)},showInviteBox:function(e,t){return!showBox("al_page.php",{act:"a_invite_box",gid:t},{params:{bodyStyle:"padding: 0px;",width:560}},e)},subscribe:function(e){window.Notifier&&Notifier.addKey(e,w.updates),w.keyTO=setTimeout(w.subscribe,3e4)},toggleFeedIgnored:function(e,t,n){ajax.post("al_feed.php",{act:cur.options.ignored_news?"a_unignore_owner":"a_ignore_owner",owner_id:cur.oid,hash:t,from:"group"},{onDone:function(t){val(e,t),cur.options.ignored_news=!cur.options.ignored_news},showProgress:window.Page&&Page.actionsDropdownLock.pbind(e),hideProgress:window.Page&&Page.actionsDropdownUnlock.pbind(e)}),cancelEvent(n)},showLinks:function(){showBox("al_groups.php",{act:"show_links",oid:cur.oid}).setOptions({onHideAttempt:function(){return cur.reloadAfterClose&&(nav.reload({noscroll:!0}),cur.reloadAfterClose=!1),!0}})},showMusicians(){showBox("al_groups.php",{act:"show_musicians",oid:cur.oid})},createEvent:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];O.create(e,t,n)},deleteEvent:function(e,t,n){O.delete(e,t,n)},showEvents:function(){O.show(cur.options.public_id||-cur.oid)},updateCnt:function(e){e=parseInt(e);var t=ge("page_menu_group_gim");if(t){var n=geByClass1("ui_rmenu_count",t);n&&(n.textContent=e,toggleClass(n,"unshown",0===e))}},updates:function(e,t){each(t.events,function(e,t){var n=t.split("<!>");switch(n[1]){case"update_cnt":w.updateCnt(n[4]);break;case"update_chat_activity":!function(e){var t=Object(i.ge)("group_section_chats"),n=Object(i.geByClass1)("group_chat_label_activity",t),r="";e&&(r=Object(l.getLang)("groups_chats_activity_status",e));var a=hasClass(t,"no_activity");r?a&&removeClass(t,"no_activity"):a||addClass(t,"no_activity"),Object(i.setInnerText)(n,r)}(n[4])}})},updateActions:function(e,t,n){val("page_actions",e);var r=geByClass1("_page_actions_container");r&&t&&domPN(r).replaceChild(se(t),r),void 0!==n&&val("group_moder_info",n)},enter:function(e,t,n,r,i,a){var o,s;if(e=ge(e),(a=a||{}).showProgress||a.hideProgress)o=a.showProgress,s=a.hideProgress;else if(hasClass(e,"flat_button"))o=lockButton.pbind(e),s=unlockButton.pbind(e);else{if(e.firstChild&&"progress"===e.firstChild.className)return;o=()=>{e.oldhtml=e.innerHTML,e.innerHTML='<span class="progress" style="display: block"></span>'},s=()=>{e.innerHTML=e.oldhtml}}window.Page&&hasClass(e,"page_actions_btn")&&Page.actionsDropdownHide(domPS(e),1),ajax.post("al_groups.php",{act:"enter",gid:t,hash:n,context:r},{onDone:function(e,t){if(i)return i.apply(window,arguments);w.updateActions(e,t),toggle("page_actions",e);var n=geByClass1("_groups_invite_block");n&&slideUp(n,200),nav.reload({noframe:!0,noscroll:!0})},onFail:e=>{if(e){var t=showFastBox({title:getLang("global_error"),bodyStyle:"padding: 20px; line-height: 160%;"},e);return setTimeout(t.hide,3e3),!0}},showProgress:o,hideProgress:s})},confirm:function(e,t,n,r,i){var a=showFastBox({title:getLang("global_warning"),bodyStyle:"padding: 20px; line-height: 160%;"},getLang(e),getLang("group_leave_group"),function(){a.hide(),w.leave(t,n,r,i)},getLang("global_cancel"))},leave:function(e,t,n,r,i){var a,o;if(e=ge(e),hasClass(e,"flat_button"))a=lockButton.pbind(e),o=unlockButton.pbind(e);else{if(e.firstChild&&"progress"==e.firstChild.className)return;a=function(){e.oldhtml=e.innerHTML,e.innerHTML='<span class="progress" style="display: block"></span>'},o=function(){e.innerHTML=e.oldhtml}}window.Page&&hasClass(e,"page_actions_btn")&&Page.actionsDropdownHide(domPS(e),1),ajax.post("al_groups.php",{act:"leave",gid:t,hash:n,context:r},{onDone:function(e,t){if(i)return i();w.updateActions(e,t),toggle("page_actions",e);var n=geByClass1("_groups_invite_block");n&&slideUp(n,200),nav.reload({noframe:!0})},showProgress:a,hideProgress:o})},otherActs:function(e){if(clearTimeout(cur.hideOtherTimer),!e)return!1;e.blur();var t=ge("page_other_acts");return!isVisible(t)&&(t.style.marginLeft="-1px",t.style.marginTop="-21px",show(t),!1)},hideOther:function(e){if(e>0)cur.hideOtherTimer=setTimeout(cur.hideOther,e);else{var t=ge("page_other_acts");-1==e?hide(t):fadeOut(t,200)}},toggleTop:function(e,t,n,r,i){ajax.post("al_groups.php",{act:"a_toggle_top",gid:t,hash:n,nocis:i},{onDone:function(t){e.innerHTML=t},showProgress:window.Page&&Page.actionsDropdownLock.pbind(e),hideProgress:window.Page&&Page.actionsDropdownUnlock.pbind(e)})},toggleStickers:function(e,t,n,r){ajax.post("al_groups.php",{act:"a_toggle_stickers",gid:t,hash:n},{onDone:function(t){e.innerHTML=t},showProgress:window.Page&&Page.actionsDropdownLock.pbind(e),hideProgress:window.Page&&Page.actionsDropdownUnlock.pbind(e)})},toggleFastAccess:function(e,t,n){function r(n){var r=n?getLang("groups_fast_menu_access_invert"):getLang("groups_fast_menu_access");val(e,r),e.setAttribute("data-value",n),"groups_list"==cur.module&&window.GroupsList&&GroupsList.updateGroupField(t,11,n)}var i=1^intval(e.getAttribute("data-value")),a=hasClass(e,"page_actions_item")||hasClass(e,"ui_actions_menu_item"),o=window.GroupsAdminTips&&window.GroupsAdminTips.isShownSection()&&window.GroupsAdminTips.isShownItem(window.GroupsAdminTips.ITEM_LEFT_LINK)?1:0;return ajax.post("al_settings.php",{act:"a_toggle_admin_fast",gid:t,hash:n,update_menu:1,update_admin_tips:o},{onDone:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;a&&r(e),geByTag1("ol",ge("side_bar")).innerHTML=t,window.Notifier&&Notifier.resetCommConnection(),o&&window.GroupsAdminTips&&null!==n&&window.GroupsAdminTips.refreshSection(n)},onFail:function(e){return a||r(0),"too_much_groups"===e&&(showFastBox(getLang("global_error"),getLang("groups_left_menu_full",5)),!0)}.bind(),showProgress:a&&function(){hasClass(e,"page_actions_item")?window.Page&&Page.actionsDropdownLock(e):lockActionsMenuItem(e)},hideProgress:a&&function(){hasClass(e,"page_actions_item")?window.Page&&Page.actionsDropdownUnlock(e):unlockActionsMenuItem(e)}}),a||r(i),!1},showMapBox:function(e,t,n){window.showZeroZoneBox&&showZeroZoneBox("places",function(){events.showMapBox(e,t,n)})||showTabbedBox("/al_places.php",{act:"show_photo_place",place_id:e},{stat:["places.css","map.css","maps.js","ui_controls.css","ui_controls.js"]})},uploadPhotos:function(e,t){if(!((window.XMLHttpRequest||window.XDomainRequest)&&(window.FormData||window.FileReader&&(window.XMLHttpRequest&&XMLHttpRequest.sendAsBinary||window.ArrayBuffer&&window.Uint8Array&&(window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder))))||!t)return nav.go(e,t);if(checkEvent(t))return!0;cur.onPhotoInputChange=function(n){return window.filesToUpload=n,nav.go(e,t)};var n=ge("page_upload_photos_input");return n||(n=se('<input id="page_upload_photos_input" class="file page_upload_photos_input" type="file" onchange="cur.onPhotoInputChange(this.files);" multiple="true" accept="image/jpeg,image/png,image/gif" name="photo" />')),n.click(t),!1},getFlattenedCategories:function(e,t){var n=t[0][e],r=t[1];if(void 0===r)return n;for(var i=[],a=0;a<n.length;a++){var o=n[a];o[3]="section",i=i.concat([o]),r[o[0]]&&(o[5]="1",i=i.concat(r[o[0]]))}for(a=0;a<i.length;a++)i[a][3]=i[a][3]?i[a][3]+" sectioned":"sectioned";return i},initCategories:function(e){e.prefix=e.prefix||"group_category_",e.groupClass=e.groupClass||0,cur.groupCategoriesDD=cur.groupCategoriesDD||{},cur.groupCategoriesDD[e.prefix]=cur.groupCategoriesDD[e.prefix]||{};for(var t=e.categories[e.groupClass],n=0;n<2;++n){var r=[],i=cur.groupCategoriesDD[e.prefix],a=i[n];if(0==n)r=t[n][0];else if(n>0){var o=i[n-1].val();""!=o&&t[n]&&(r=this.getFlattenedCategories(o,t.slice(1))||[])}a&&a.container&&a.container.compareDocumentPosition&&a.container.compareDocumentPosition(bodyNode)&Node.DOCUMENT_POSITION_DISCONNECTED&&(a.destroy(),a=null),a?(a.setData(r),a.currenDataItems=r,a.setOptions({defaultItems:r}),a.clear()):a=new Dropdown(ge(e.prefix+n),r,{width:300,dark:!0,multiselect:!1,autocomplete:!0,introText:getLang("groups_start_typing_subject"),zeroPlaceholder:!0,indexkeys:[1,4],includeSectionsOnMatch:!0,preventDuplicates:!0,noResult:"",placeholder:getLang("groups_choose_subject"),onChange:function(n,r){if(0==n&&r){var a=w.getFlattenedCategories(r,t.slice(1))||[];i[n+1].setData(a),i[n+1].currenDataItems=a,i[n+1].setOptions({defaultItems:a});for(var o=n+1;o<2;++o)i[o].clear(),i[o].disable(o>n+1||!a.length),toggle(ge(e.prefix+"wrap_"+o),!(o>n+1||!a.length))}}.pbind(n)}),e.selected[n]&&-1!=e.selected[n]?1==n&&e.selected[2]?a.val(e.selected[2]):a.val(e.selected[n]):n>0&&(-1==e.selected[n-1]||!r.length)&&(a.disable(!0),hide(ge(e.prefix+"wrap_"+n))),cur.groupCategoriesDD[e.prefix][n]=a}},categoriesGetDropdown:function(e,t){return t=t||"group_category_",cur.groupCategoriesDD&&cur.groupCategoriesDD[t]&&cur.groupCategoriesDD[t][e]},getDetailedCategories:function(e,t){for(var n=-1,r=0;r<e.length;r++)if(e[r][0]==t){n=r;break}var i=-1;for(r=n;r>=0;r--)if(Number(e[r][0])<3e3){i=r;break}return-1==n||-1==i?[0,0]:i==n?[e[n][0],0]:[e[i][0],e[n][0]]},categoriesValue:function(e){for(var t=[],n=0;n<2;++n){var r=this.categoriesGetDropdown(n,e);if(0==n)t.push(r?intval(r.val()):0);else{var i=r?intval(r.val()):0;t=t.concat(this.getDetailedCategories(r.dataItems,i))}}return t},deinitCategories:function(e){for(var t=0;t<3;++t){var n=this.categoriesGetDropdown(t,e);n&&n.destroy()}cur.groupCategoriesDD&&delete cur.groupCategoriesDD[e]},saveNewCategories:function(e,t){var n={act:"set_new_categories",gid:e,hash:t};if(w.categoriesGetDropdown(0)){var r=w.categoriesValue();extend(n,{category_0:r[0],category_1:r[1],category_2:r[2]})}var i=ge("group_set_categories_submit");hide("group_set_categories_error_wrap"),hide("group_set_categories_success_wrap"),ajax.post("al_groups.php",n,{onDone:function(e){val("group_set_categories_success",e),show("group_set_categories_success_wrap")},onFail:function(e){return val("group_set_categories_error",e),show("group_set_categories_error_wrap"),!0},showProgress:lockButton.pbind(i),hideProgress:unlockButton.pbind(i)})},hideTopNotice:function(e,t,n){var r="gtop_"+e,i={act:"hide_top_notice",notice:e,group_id:t,hash:n};return ajax.post("al_groups.php",i),slideUp(ge(r),150,re.pbind(r)),!1},goToTopNoticeMoreLink:function(e,t,n,r,i){return Object(s.statlogsValueEvent)("groups_top_notice",1,t,"accept",i),!(!checkEvent(e)&&!r)||nav.go(n)},processActionButton:function(e,t,n,r,i,a){return!!isButtonLocked(e)||(ajax.post("al_groups.php",{act:"proxy_cta_button",action:t,resource:n,group_id:r,hash:i},{onDone:function(){unlockButton(e)}}),!a||a(e))},setMainAddressId:function(e){Object(i.geByClass)("address_its_main").forEach(t=>{Object(a.checkbox)(t,t===e)})},hightlightTipModule:function(e){var t=ge(e.module);if(t&&hasClass(t,"module")){cur.__narrowBarForceNotFixed=!0,scrollToY(getXY(t)[1]-100,200);var n=()=>{cur.hightlighedModule.hideTT(),enableBodyScroll(),delete cur.__narrowBarForceNotFixed,updateNarrow(),e.onClose&&e.onClose()};cur.hightlighedModule=new u.default(t,e.text,{highlight:!0,width:250,offset:[0,-17],side:"bottom",withCloseButton:!0,onBGClick:n,onCloseButtonClick:n}),cur.hightlighedModule.show(),disableBodyScroll()}},hightlightPodcasts:function(e){setTimeout(()=>{w.hightlightTipModule({module:"podcast",text:getLang("groups_onboarding_podcast"),onClose:()=>{ajax.post("al_index.php",{act:"hide_feature_tt",hash:e,type:"podcasts_onboarding"})}}),setTimeout(()=>{cur.hightlighedModule&&window.onboardingBG&&triggerEvent(window.onboardingBG,"click")},1e4)},1500)},joinChat:function(e,t,n,r){Object(_.joinChatBox)(e,t,n,r)},showReportGroupForm:e=>{Object(b.showComponentInBox)(r.createElement(v,{groupId:-cur.oid,reasons:cur.communityReportReasons,hash:e}))},hideEvergreenNotice(e,t,n){e.closest(".page_block").style.display="none",ajax.post("al_groups.php",{act:"evergreen_notice_hide",group_id:t,hash:n},{onFail:e=>console.log(e)})},openEvergreenLongread(){nav.go("/@adminsclub-evergreen")}};window.Groups=w;try{stManager.done(jsc("web/groups.js"))}catch(e){}},"wSs/":function(e,t,n){"use strict";n.r(t),n.d(t,"canMessageBeEdited",function(){return c}),n.d(t,"convertEmojiHtmlToRegularText",function(){return u}),n.d(t,"findLastMessageToEdit",function(){return d}),n.d(t,"wasMessageReallyModified",function(){return l}),n.d(t,"replaceMsgAfterEdit",function(){return _});n("Vd3H"),n("rGqo"),n("Btvt"),n("pIFo");var r=n("rHUl"),i=n("MhhX"),a=n("P13b"),o=n("rudk"),s=n("aong");function c(e,t){t=Object(r.parserMessage)(t);var n=vk.id==t.peerId&&!Object(s.unpackStore)(e).gid;return 333!=t.peerId&&(!(!n&&!Object(i.isOut)(t))&&(!Object(i.isServiceMsg)(t)&&(!(Date.now()/1e3-t.date>86400)&&(!(Object(i.isGift)(t)||Object(i.isSticker)(t)||Object(i.isAudioMsg)(t)||Object(i.isGraffiti)(t)||Object(i.isMoney)(t)||Object(i.isVKPay)(t)||Object(i.isCallMessage)(t))&&!Object(a.isAlreadyDeleted)(e,t.peerId,t.messageId)))))}function u(e){var t=document.createElement("div");return e=e.replace(/\[((id|club)\d+)\|(.+?)]/g,function(){var e=arguments.length<=1?void 0:arguments[1],t=arguments.length<=3?void 0:arguments[3];return/^\@/.test(t)?t:`@${e} (${t})`}),t.innerHTML=e,Emoji.val(t)}function d(e,t){return+(t&&t.msgs?Object.keys(t.msgs):[]).filter(e=>e>0).sort((e,t)=>t-e).find(n=>c(e,t.msgs[n]))||null}function l(e,t,n){var r=Object(o.convertKludgesToAttaches)(t.kludges,t.messageId),i=n.dData.attaches;if(u(t.text)!==n.dData.txt||r.length!==i.length)return!0;for(var a=r.length;a--;){var s=r[a],c=i[a];if(s.id!=c.id||s.type!=c.type||"poll"==s.type&&c.object&&c.object.poll_is_edited)return!0}return!1}function _(e,t,n,r,i,o){t.origText=n,t.text=Object(a.replaceSpecialSymbols)(clean(n)).replace(/\n/gi,"<br>"),t.attaches=r,t.kludges.emoji=1,t.local=1,t.share_url=i,t.cancelled_shares=o,t.update_time=Math.floor(Date.now()/1e3),e.get().tabs[t.peerId].msgs[t.messageId]=t}}});